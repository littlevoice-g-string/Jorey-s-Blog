[{"title":"ç°¡æ˜“ãªå½¢æ…‹ç´ è§£æå™¨ã‚’æ§‹ç¯‰","url":"/Jorey-s-Blog/2021/03/28/build-a-word-segumentation/","content":"\n### 1.èª¬æ˜\n### 2.new word discovery\n### 3.word segmentation\n\n ","tags":["è‡ªç„¶è¨€èªå‡¦ç†","nlp"],"categories":["è‡ªç„¶è¨€èªå‡¦ç†"]},{"title":"ã‚¨ãƒ©ãƒ¼é›†","url":"/Jorey-s-Blog/2021/03/28/others_ã‚¨ãƒ©ãƒ¼é›†/","content":"others\n\n1. you-get https://www.bilibili.com/video/BV1yK4y1E7n4?p=95\n\terror:  \n\t\tyou-get: [error] oops, something went wrong.\n\t\tyou-get: don't panic, c'est la vie. please try the following steps:\n\t\tyou-get:   (1) Rule out any network problem.\n\t\tyou-get:   (2) Make sure you-get is up-to-date.\n\t\tyou-get:   (3) Check if the issue is already known, on\n\t\tyou-get:         https://github.com/soimort/you-get/wiki/Known-Bugs\n\t\tyou-get:         https://github.com/soimort/you-get/issues\n\t\tyou-get:   (4) Run the command with '--debug' option,\n\t\tyou-get:       and report this issue with the full output.\n\n\tstep1:\n\t\tyou-get -i https://www.bilibili.com/video/BV1yK4y1E7n4?p=95\n\t\t\ttitle:               è´ªå¿ƒ NLP è‡ªç„¶è¯­è¨€å¤„ç† (P95. ä»»åŠ¡095ï¼šè®¿é—®é¦–é¡µåˆ—è¡¨ä¸­çš„url)\n\t\tstreams:             # Available quality and codecs\n\t\t    [ DASH ] ____________________________________\n\t\t    - format:        dash-flv480\n\t\t      container:     mp4\n\t\t      quality:       æ¸…æ™° 480P\n\t\t      size:          32.0 MiB (33512282 bytes)\n\t\t    # download-with: you-get --format=dash-flv480 [URL]\n\t\t    ...\n\tsolved by:\n\t\tyou-get --format=dash-flv https://www.bilibili.com/video/BV1yK4y1E7n4?p=95\n\t\t\t- èª¬æ˜:éŸ³å£°ã¨ç”»åƒãŒåˆ‡ã‚Šåˆ†ã‘ã‚‰ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹\n<!-- more -->\n","tags":["ã‚¨ãƒ©ãƒ¼"],"categories":["others"]},{"title":"NeuralNetworkå®Ÿè·µ_MNIST","url":"/Jorey-s-Blog/2021/03/16/neuralnetwork_MINIT/","content":"### èª¬æ˜\nãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç†è§£ã™ã‚‹ãŸã‚ã€Numpyã€kerasã€Pytorchã‚’ä½¿ã£ã¦MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ‰‹æ›¸ãæ•°å­—ã‚’è­˜åˆ¥ã—ã¦ã¿ã¾ã—ãŸã€‚\n- ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿\n\t- [Kaggle Digit Recognizer](https://www.kaggle.com/c/digit-recognizer)\n\t- MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€æ©Ÿæ¢°å­¦ç¿’ã§ã¨ã¦ã‚‚æœ‰åãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚Šã€0ã‹ã‚‰9ã¾ã§ã®æ‰‹æ›¸ãæ•°å­—ã®ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ç”»åƒãŒå…¥ã£ã¦ã„ã¾ã™ã€‚å„ç”»åƒã¯ã€ç¸¦28Xæ¨ª28åˆè¨ˆ784ãƒ”ã‚¯ã‚»ãƒ«ã¨ãªã£ã¦ãŠã‚Šã€å„ãƒ”ã‚¯ã‚»ãƒ«ã«ã¯ä¸€ã¤0ã‹ã‚‰255ã®ãƒ”ã‚¯ã‚»ãƒ«å€¤ã‚’ã¤ã„ã¦ã„ã¾ã™ã€‚ãã®ãƒ”ã‚¯ã‚»ãƒ«å€¤ãŒå¤§ãã„ã‘ã‚Œã°å¤§ãã„ã»ã©æš—ã„ã“ã¨ã‚’æ„å‘³ã—ã¦ã„ã¾ã™ã€‚\n\t- Trainãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ã¯ã€å…ˆé ­ã®labelåˆ—ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæã„ãŸæ•°å­—ã‚’è¡¨ã—ã¦ãŠã‚Šã€æ®‹ã‚Šã®åˆ—ã¯è©²å½“ç”»åƒã®ãƒ”ã‚¯ã‚»ãƒ«å€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚\n\t- testãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ã¯Trainãƒ‡ãƒ¼ã‚¿ã¨åŒæ§˜ã«ã€ç”»åƒã®ãƒ”ã‚¯ã‚»ãƒ«å€¤ãŒæ ¼ç´ã—ã¦ã„ã¾ã™ãŒã€labelåˆ—ãŒã¤ã„ã¦ã„ãªã„ã®ã§ã€ãã‚Œã‚’è­˜åˆ¥ã™ã‚‹ã®ã¯ä»Šå›ã®ã‚¿ã‚¹ã‚¯ã§ã™ã€‚\n- training data,validate dataã‚’ç”¨æ„ã—ã¾ã™ã€‚\n<!-- more -->\n```\ndata = np.array(train)\nm,n = data.shape\nnp.random.shuffle(data)\n\ndata_val=data[0:1000].T\nY_val = data_val[0]\nX_val = data_val[1:n]\nX_val = X_val/255.\nprint(data_val.shape,Y_val.shape,X_val.shape)\n\ndata_train = data[1000:m].T\nY_train = data_train[0]\nX_train = data_train[1:n]\nX_train = X_train/255.\n_,m_train = X_train.shape\nprint(data_train.shape,Y_train.shape,X_train.shape)\n\n#(785, 1000) (1000,) (784, 1000)\n(785, 41000) (41000,) (784, 41000)\n```\n\n### 1.EDA\nã¾ãškaggleã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸtrain.csvã¨test.csvã‚’èª­ã¿è¾¼ã‚“ã§ã€ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’ã„ã‚ã„ã‚ç¢ºèªã—ã¦ã¿ã¾ã—ãŸã€‚\n\n0. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚\n```\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.cm as cm\nfrom collections import Counter\nfrom pyg2plot import Plot\nfrom pyecharts.charts import Bar,Line\nfrom pyecharts import options as opts\n``` \n1. ãƒ‡ãƒ¼ã‚¿ä»¶æ•°\ntrain:42000ä»¶è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã€785åˆ—ã€testãƒ‡ãƒ¼ã‚¿ã¨é•ã£ã¦ã€labelåˆ—ãŒã¤ã„ã¦ã„ã¾ã™ã€‚\ntest:28000ä»¶ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã€784åˆ—\n```\ntrain.shape,test.shape\n\t#((42000, 785), (28000, 784))\n\n\tfor i in train.columns:\n\t    if i not in test.columns:\n\t        print(i)\n\t#label\n```\n\n2. å®Ÿéš›ã«ã©ã†ã„ã†æ•°å­—ãªã®ã‹ã€ç”»åƒã§è¦‹ã¦ã¿ã¾ã™ã€‚\n```\nnum=train.iloc[10]\npic=np.array(num)\npic=pic[1:785]\npic=pic.reshape(28,28)\nplt.imshow(pic,cmap=\"magma\")\nplt.show()\n```\n<div style=\"width:50%;margin:left\">{% asset_img show_num.png show_num%}</div>\n3. å…¨ä½“ã®valueå€¤ã®å¹…ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚\n- valueå€¤ã¯0ã‹ã‚‰255ã®é–“ã«è½ã¡ã¦ã„ã‚‹ã®ã§ã€å¾Œã»ã©ã®å‰å‡¦ç†ã§ã¯valueå€¤ã‚’æ¨™æº–åŒ–å‡¦ç†ã«ã—ã¾ã™ã€‚\n```\nscatter = Plot(\"Scatter\")\ndf_scatter = pd.DataFrame(pic.reshape(392,2))\ndf_scatter_dict = df_scatter.to_dict(orient = 'dict')\nscatter.set_options(\n{\n    'appendPadding': 30,\n    'data': df_scatter.to_dict(orient='records'),\n    'xField': 0,\n    'yField': 1,\n    'size': [4, 30],\n    'shape': 'circle',\n    'pointStyle':{'fillOpacity': 0.8,'stroke': '#bbb'},\n    'xAxis':{'line':{'style':{'stroke': '#aaa'}},},\n    'yAxis':{'line':{'style':{'stroke': '#aaa'}},},\n    'quadrant':{\n        'xBaseline': 0,\n        'yBaseline': 0,\n    },\n})\nscatter.render()\n```\n<div style=\"width:100%;margin:auto\">{% asset_img show_values.png show_values%}</div>\n4. ãƒ©ãƒ™ãƒ«ã”ã¨ãƒ‡ãƒ¼ã‚¿ã®ä»¶æ•°ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚\n- å„ãƒ©ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ãŒå¤§ãã„ãªå·®ãŒãªãã€å‡ç­‰çš„ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚\n```\nbar = (\n    Bar(init_opts=opts.InitOpts(width=\"620px\", height=\"420px\"))\n    .add_xaxis(list(train_count.keys()))\n    .add_yaxis('count', list(train_count.values()))\n    .set_global_opts(title_opts=opts.TitleOpts(title=\"count\", subtitle=None))\n    .set_global_opts(title_opts={\"text\": \"count\", \"subtext\": None})\n)\n\nbar.render_notebook()\n```\n<div style=\"width:80%;margin:auto\">{% asset_img show_labels.png show_labels%}</div>\n\n### 2.Numpyã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸ\n1. ä»Šå›2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚\n\t- æ´»æ€§åŒ–é–¢æ•°:sigmoidé–¢æ•°(h1)ã¨softmaxé–¢æ•°(h2)\n\t- æå¤±é–¢æ•°:äº¤å·®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼èª¤å·®\n<div style=\"width:80%;margin:left\">{% asset_img 2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯.png 2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯%}</div>\n2. äº‹å‰ã«æ´»æ€§åŒ–é–¢æ•°ã€æå¤±é–¢æ•°ã€labelã®one-hotå‡¦ç†ã®é–¢æ•°ã‚’ç”¨æ„ã—ã¾ã™ã€‚\n```\n#h1 sigmoidé–¢æ•°\ndef sigmoid(x):\n    return 1/(1+np.exp(-x))\n\n#back propagationç”¨sigmoidé–¢æ•°ã®å¾®åˆ†é–¢æ•°\ndef sigmoid_(x):\n    return sigmoid(x)*(1-sigmoid(x))\n\n#h2 softmaxé–¢æ•°\ndef softmax(z):\n    A = np.exp(z)/sum(np.exp(z))\n    return A\n\n#one-hot å‡¦ç†é–¢æ•°\ndef one_hot(Y):\n    one_hot_Y = np.zeros((Y.size, Y.max() + 1))\n    one_hot_Y[np.arange(Y.size), Y] = 1\n    one_hot_Y = one_hot_Y.T\n    return one_hot_Y\n\n#æå¤±é–¢æ•°\ndef cross_entropy(a, y):\n    return np.sum(np.nan_to_num(-y*np.log(a)-(1-y)*np.log(1-a)))\n```\n3. w1,b1,w2,b2ã®åˆæœŸåŒ–\n```\ninput_, hidden, output = 784, 100, 10\n\nw1 = np.random.randn(hidden,input_)\nb1 = np.random.randn(hidden,1)\nw2 = np.random.randn(output,hidden)\nb2 = np.random.randn(output,1)\nprint(w1.shape,b1.shape,w2.shape,b2.shape)\n#(100, 784) (100, 1) (10, 100) (10, 1)\n```\n4. forwardã®å®Ÿç¾\n```\ndef forward(x,w1,w2,b1,b2):\n    a1 = np.dot(w1,x)+b1\n    z1 = sigmoid(a1)\n    a2 = np.dot(w2,z1)+b2\n    z2 = softmax(a2)\n    y_pred = z2\n    return a1,a2,z1,y_pred\na1,a2,z1,y_pred = forward(X_train,w1,w2,b1,b2)\nprint(a1.shape,a2.shape,z1.shape,y_pred.shape)\n#(100, 41000) (10, 41000) (100, 41000) (10, 41000)\n```\n5. back propagatationã®å®Ÿç¾\n```\ndef backward(z1,a1,y_pred,a2,x,y,w1,w2):\n    dz2 = y_pred - one_hot(y)\n    dw2 = (np.dot(dz2,z1.T))/m\n    db2 = (1/m)*np.sum(dz2,axis=1,keepdims=True)\n    da1 = np.dot(w2.T,dz2)\n    dz1 = da1*sigmoid_(a1)\n\n    dw1 =(1/m)*np.dot(dz1,x.T)\n    db1 = (1/m)*np.sum(dz1,axis=1,keepdims=True)\n    return dw1,db1,dw2,db2\n\ndef update(w1,b1,w2,b2,dw1,db1,dw2,db2,lr):  \n    w2 -= lr*dw2\n    b2 -= lr*db2\n    w1 -= lr*dw1\n    b1 -= lr*db1\n    return w1,w2,b1,b2\n```\n6. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–\n```\n# accuracyå€¤ã®é–¢æ•°\ndef get_accuracy(predictions,y):\n    return np.sum(predictions == y)/y.size\ndef gradient_descent(x,y,w1,w2,b1,b2,iterations,lr):\n    accuracy_ = list()\n    for i in range(iterations):\n        a1,a2,z1,y_pred = forward(x,w1,w2,b1,b2)\n        dw1,db1,dw2,db2 = backward(z1,a1,y_pred,a2,x,y,w1,w2)\n        w1,w2,b1,b2=update(w1,b1,w2,b2,dw1,db1,dw2,db2,lr)\n        if i % 10 == 0:\n            print(f'ç¬¬{(i/10)}å›',i)\n            predictions = np.argmax(a2,0)\n            accuracy = round(get_accuracy(predictions,y),3)\n            accuracy_.append(accuracy)\n            print(accuracy)\n    return w2,b2,w1,b1,accuracy,accuracy_\nw2,b2,w1,b1,accuracy,accuracy_ = gradient_descent(X_train,Y_train,w1,w2,b1,b2,5000,0.01)\n\n#ç¬¬0.0å› 0\n0.09409756097560976\nç¬¬1.0å› 10\n0.1038780487804878\nç¬¬2.0å› 20\n0.11382926829268293\nç¬¬3.0å› 30\n0.1218780487804878\n....\n```\n7. accuracyã®æ¨ç§»å€¤\n```\nx_axis = [i for i in range(len(accuracy_))]\ny_axis = accuracy_\nline1=(\n    Line()\n    .add_xaxis(x_axis)  \n    .add_yaxis('accuracy',y_axis)\n    .set_global_opts(title_opts=opts.TitleOpts(title='accuracy'),\n                     xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(font_size=20)))\n)\nline1.render_notebook()\n```\n<div style=\"width:80%;margin:auto\">{% asset_img numpy_acc_line.png numpy_acc_line%}</div>\n\n### 3.Kerasã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã¦ã¿ã¾ã—ãŸ\n1. è€ƒãˆæ–¹ã¯åŸºæœ¬Numpyã§ã®æ§‹ç¯‰ã¨åŒæ§˜ã§ã™ãŒã€Sequentialãƒ¢ãƒ‡ãƒ«ã‚’ã‚‚ã¨ã«ã€.add()ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç©ã¿é‡ã­ã¦ã€.compile()ã§è¨“ç·´ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¨­å®šã—ã¾ã™ã€‚\n```\nmodel=Sequential() #\nmodel.add(Dense(100,activation = 'relu'))\nmodel.add(Dense(10,activation = 'softmax'))\n\nmodel.compile(optimizer='adam',\n             loss ='sparse_categorical_crossentropy',\n             metrics ='acc')\nmodel.fit(X_train.T,Y_train,epochs=60,batch_size=512)\n```\n<div style=\"width:100%;margin:auto\">{% asset_img keras_result.png keras_result%}</div>\n2. testãƒ‡ãƒ¼ã‚¿ã®äºˆæ¸¬ã—ã€Kaggleã«æå‡ºã—ã¾ã™ã€‚\n```\nresult = model.predict(np.array(test))\nresult_=pd.DataFrame(results,index=list(range(1,len(results)+1))).reset_index().rename(columns = {'index':'ImageId',0:'Label'})\nresult_.to_csv('Digit Recognizer_version3(keras).csv',index=False)\n```\n<div style=\"width:100%;margin:auto\">{% asset_img keras_kaggle.png keras_kaggle%}</div>\n\n### 4.Pytorchã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ãŸ\n1. ãƒ‡ãƒ¼ã‚¿é›†ã‚’Pytorchå°‚ç”¨ã®Tensorã«å¤‰æ›ã™ã‚‹\n```\nimport torch\nfrom torch.utils.data import DataLoader\nfrom torch import nn,optim\nimport torch.nn.functional as F\nimport torch.utils.data\nX_train_torch = torch.from_numpy(X_train).float()\nY_train_torch = torch.from_numpy(Y_train).long()\nX_val_torch = torch.from_numpy(X_val).float()\nY_val_torch = torch.from_numpy(Y_val).long()\nX_train_torch.T.size(0),Y_train_torch.T.size(0)\n#(41000, 41000)\n```\n2. Batchã”ã¨ã‚’è¡Œã†ãŸã‚ã€TensorDatasetã«æ ¼ç´ã—ã¾ã™ã€‚\n```\ntrain_dataset=torch.utils.data.TensorDataset(X_train_torch.T, Y_train_torch)\nval_dataset=torch.utils.data.TensorDataset(X_val_torch.T, Y_val_torch)\n\ntrain_loader = torch.utils.data.DataLoader(train_dataset,batch_size=1000,shuffle=True)\nval_loader = torch.utils.data.DataLoader(val_dataset,batch_size=1000,shuffle=True)\n```\n3. Pytorchã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æ²¿ã£ã¦ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ§‹ç¯‰ã‚’è¡Œã„ã¾ã™ã€‚éå­¦ç¿’ã‚’é˜²ããŸã‚ã€Dropoutã‚’åˆ©ç”¨ã—ã¾ã™ã€‚\n```\nclass NN(nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.layer1 = nn.Linear(784,100)\n        self.layer2 = nn.Linear(100,10)\n        \n        self.dropout = nn.Dropout(p=0.2)\n        \n    def forward(self,x):\n        x = x.view(x.shape[0],-1)\n        \n        x = self.dropout(F.relu(self.layer1(x)))\n        x = F.softmax(self.layer2(x),dim=1)\n        \n        return x\n```\n4.ã€€æå¤±é–¢æ•°ã¨æœ€é©åŒ–æ‰‹æ³•ã‚’è¨­å®šã—ã€è¨“ç·´ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¨­å®šã—ã¾ã™ã€‚\n```\nmodel = NN()\n\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(),lr=0.001)\n\nepochs = 100\ntrain_losses = []\ntest_losses = []\naccuracy_list = []\nprint('start')\nmodel = model.float()\nfor e in range(epochs):\n    running_loss = 0\n    for images,labels in train_loader:\n        optimizer.zero_grad()\n        \n        log_ps = model(images)\n        loss = criterion(log_ps,labels)\n        loss.backward()\n        optimizer.step()\n        running_loss += loss.item()\n    else:\n        test_loss = 0\n        accuracy = 0\n        with torch.no_grad():\n            model.eval()\n            \n            for images,labels in val_loader:\n                log_ps =model(images)\n                test_loss += criterion(log_ps,labels)\n                ps = torch.exp(log_ps)\n                top_p,top_class = ps.max(dim=1, keepdim=True)\n\n                equals = top_class == labels.view(*top_class.shape)\n                \n                accuracy += torch.mean(equals.type(torch.FloatTensor))\n                \n        model.train()\n        \n        train_losses.append(running_loss/len(train_loader))\n        test_losses.append(test_loss/len(val_loader))\n        accuracy_list.append(accuracy)\n                \n        print(\"epoch: {}/{}.. \".format(e+1, epochs),\n              \"train_loss: {:.3f}.. \".format(running_loss/len(train_loader)),\n              \"test_loss: {:.3f}.. \".format(test_loss/len(val_loader)),\n              \"accuracy: {:.3f}\".format(accuracy/len(val_loader)))      \n```\n<div style=\"width:100%;margin:auto\">{% asset_img pytorch_result.png pytorch_result%}</div>\n5.å¯è¦–åŒ–ã«ã‚ˆã£ã¦ã€æå¤±ã¨ç²¾åº¦ã®æ¨ç§»ã‚’ç¢ºèªã—ã¾ã™ã€‚\n```\nplt.plot(train_losses,label='Training loss')\nplt.plot(test_losses,label='Validation loss')\nplt.plot(accuracy_list,label='Accuracy')\nplt.legend()\n```\n<div style=\"width:100%;margin:auto\">{% asset_img pytorch_graph.png pytorch_graph%}</div>\n\n### 5.Next\n- Pytorchã§ãƒ†ã‚­ã‚¹ãƒˆã®åˆ†é¡ã‚’è¡Œã£ã¦ã¿ã‚‹\n\n### 6.å‚è€ƒæ–‡çŒ®\n\n1. [keras documents](https://keras.io/ja/)\n2. [pytorch documents](https://pytorch.org/docs/stable/index.html)\n3. [ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹DeepLearning](https://www.amazon.co.jp/%E3%82%BC%E3%83%AD%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8BDeep-Learning-%E2%80%95Python%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%82%A3%E3%83%BC%E3%83%97%E3%83%A9%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E7%90%86%E8%AB%96%E3%81%A8%E5%AE%9F%E8%A3%85-%E6%96%8E%E8%97%A4-%E5%BA%B7%E6%AF%85/dp/4873117585/ref=sr_1_1?adgrpid=103020866343&dchild=1&gclid=Cj0KCQjw0oCDBhCPARIsAII3C_EwbmbxiFhXpRe6SPmoc7pFv4BMTFtbL0VNqLMla0wervsh-BHtO-UaAkmaEALw_wcB&hvadid=448651961923&hvdev=c&hvlocphy=1009333&hvnetw=g&hvqmt=e&hvrand=13330263149548873495&hvtargid=kwd-335457286238&hydadcr=27294_11561544&jp-ad-ap=0&keywords=%E3%82%BC%E3%83%AD%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8Bdeep+learning&qid=1616920581&sr=8-1)\n","tags":["æ©Ÿæ¢°å­¦ç¿’","ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯","Pytorch","Keras","Numpy"],"categories":["æ©Ÿæ¢°å­¦ç¿’"]},{"title":"ãƒ‘ãƒ¯ãƒã‚’è‡ªå‹•ç¿»è¨³ã™ã‚‹","url":"/Jorey-s-Blog/2021/02/10/ãƒ‘ãƒ¯ãƒã‚’è‡ªå‹•é€šè¨³ã™ã‚‹/","content":"<!-- toc -->\n### èª²é¡Œç´¹ä»‹\næ¥­å‹™ã§ã‚ˆãå ±å‘Šæ›¸ã‚’ç¿»è¨³ã™ã‚‹ã®ã§ã€ã„ã¤ã‚‚DeepLã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€DeepLã¯æœ€è¿‘ç¿»è¨³ã—ãŸãƒ‘ãƒ¯ãƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚‰ã€ä¿®å¾©ã‚¨ãƒ©ãƒ¼å‡ºã¦ã—ã¾ã†ã®ã§ã€Google translate apiã‚’å‘¼ã³å‡ºã—ã¦ã€ãƒ‘ãƒ¯ãƒã®è‡ªå‹•ç¿»è¨³ã‚’å®Ÿç¾ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n### å‚è€ƒæ–‡çŒ®\n1. [Pythonã§ãƒ‘ãƒ¯ãƒã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ç¿»è¨³ã™ã‚‹](https://qiita.com/code_440/items/9998d97b480db82ef738)\n2. [3 åˆ†ã§ä½œã‚‹ç„¡æ–™ã®ç¿»è¨³ API with Google Apps Script](https://qiita.com/tanabee/items/c79c5c28ba0537112922)\n3. [deep-translator_github](https://github.com/nidhaloff/deep-translator)\n4. [python-pptx](https://python-pptx.readthedocs.io/en/latest/)\n\n### â‘  Google Apps Scriptã«ã‚ˆã‚‹ç¿»è¨³APIã®åˆ©ç”¨\n1. ç°¡å˜ã«apiã‚’ä½œæˆ\n\n>ã“ã¡ã‚‰ã®è¨˜äº‹[`3 åˆ†ã§ä½œã‚‹ç„¡æ–™ã®ç¿»è¨³ API with Google Apps Script`](https://qiita.com/tanabee/items/c79c5c28ba0537112922)ã‚’å‚è€ƒã—ã€ç„¡æ–™ã®ç¿»è¨³apiã‚’ä½œæˆã—ã¾ã—ãŸã€‚\n>ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’Google Apps Scriptã«ã¦å…¥åŠ›ã—ã€`ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å°å…¥`ã‚’é¸æŠã—ãŸã‚‰\n`https://script.google.com/macros/s/[api_key]/exec`ã®ã‚ˆã†ãªURLãŒç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚ã“ã¡ã‚‰ã‚’ä½¿ã£ã¦ç¿»è¨³ã‚’è¡Œã„ã¾ã™ã€‚\n>`https://script.google.com/macros/s/[api_key]/exec?text=ã“ã‚“ã«ã¡ã¯&source=ja&target=en`ã§çµæœãŒã‚ã£ãŸã‚‰ã€apiã®ä½œæˆãŒæˆåŠŸã§ããŸã¨ã„ãˆã¾ã™ã€‚\n\n<!-- more -->\n\n<div style=\"width:70%;margin:auto\">{% asset_img api_result.png api_result%}</div>\n\n```\nfunction doGet(e) {\n  var p = e.parameter;\n  var translatedText = LanguageApp.translate(p.text, p.source, p.target);\n  return ContentService.createTextOutput(translatedText);\n}\n```\n\n2. Pythonã‹ã‚‰APIã«ã‚¢ã‚¯ã‚»ã‚¹\n`requests`ã‚’ä½¿ã£ã¦APIã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€è‹±è¨³ã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚\n```\ndef translate(str_in, source='ja', target= 'en'):\n    url=\"https://script.google.com/macros/s/\"\n    url += \"[api_key]\"\n    url += \"/exec?text=\" + str_in\n    url += \"&source=\" + source\n    url += \"&target=\" + target\n    rr = requests.get(url)\n\n    return rr.text\n```\n<div style=\"width:70%;margin:auto\">{% asset_img api_test.png api_test%}</div>\n\n### â‘¡ deep-translatorã‚’ä½¿ã£ã¦è¤‡æ•°ã®ç¿»è¨³ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹\n1. deep-translatorã¯google_translator,Linguee translator,DeepLç­‰è¤‡æ•°ç¿»è¨³ãƒ„ãƒ¼ãƒ«ã‚’å¯¾å¿œã—ã¦ãã‚Œã‚‹è¤‡åˆå‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚ã„ãã¤ã‹ã®ç¿»è¨³ãƒ„ãƒ¼ãƒ«ã‚’æ¯”è¼ƒã—ãŸã„å ´åˆã€ã‹ãªã‚Šä¾¿åˆ©ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã­ã€‚æœ¬è¨˜äº‹ã§ã¯ã€google translateã€Linguee translatorã€DeepLã‚’ä½¿ã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n* DeepL apiã¯ç¾åœ¨ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ãŸã‚ã€ã¨ã‚Šã‚ãˆãšã‚„ã‚ã¾ã—ãŸã€‚\n* google_translatorã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€5000æ–‡å­—ã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚\n\t- text must be a valid text with maximum 5000 character,otherwise it cannot be translated\n<div style=\"width:70%;margin:auto\">{% asset_img deep_translator.png deep_translator%}</div>\n```\n#google translate\ndef Google_Translator(str_in):\n    from_language = json_inputs['source_Google']\n    to_language = json_inputs['target_Google']\n    translated = GoogleTranslator(source = from_language,target = to_language).translate(text=str_in)\n    return translated\n#Linguee translator\ndef Linguee_Translator(str_in):\n    from_language = json_inputs['source_Linguee']\n    to_language = json_inputs['target_Linguee']\n    translated = LingueeTranslator(source = from_language,target = to_language).translate(str_in)\n    return translated\n#DeepL\n#DeepLã¯ä»Šæœ‰æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã—ã‹apiã‚’æä¾›ã—ãªã„ãŸã‚ã€auth_keyã¯å¿…è¦ã§ã™ã€‚\nwith open(os.getcwd() + '/config.json') as j:\n    config = json.load(j)\ndef DeepL_Translator(str_in):\n    from_language = json_inputs['source_deepl']\n    to_language = json_inputs['target_deepl']\n    translated = DeepL(config['auth_token']).translate(source=from_language,target=to_language,text=str_in)\n    return translated\n```\n2. å„ç¿»è¨³ãƒ„ãƒ¼ãƒ«å¯¾å¿œã—ã¦ã„ã‚‹è¨€èªã€åŠã³è¨€èªã®çœç•¥ã‚’deep-translatorã§ãã®ã¾ã¾èª¿ã¹ã¾ã™ã€‚\n```\nlangs_list = GoogleTranslator.get_supported_languages(as_dict=True) \ngoogle_lang = pd.DataFrame(langs_list.keys(),langs_list.values()\n            ).reset_index().rename(columns= {'index':'è¨€èªçœç•¥',0:'è¨€èª'})\nprint(google_lang[google_lang['è¨€èª']=='english'])\nprint(google_lang[google_lang['è¨€èª']=='japanese'])\nprint(google_lang[google_lang['è¨€èª']=='chinese (simplified)'])\nprint(google_lang[google_lang['è¨€èª']=='chinese (traditional)'])\n#   è¨€èªçœç•¥       è¨€èª\n21   en  english\n   è¨€èªçœç•¥        è¨€èª\n45   ja  japanese\n     è¨€èªçœç•¥                    è¨€èª\n14  zh-cn  chinese (simplified)\n     è¨€èªçœç•¥                     è¨€èª\n15  zh-tw  chinese (traditional)\n```\n<div style=\"width:60%;margin:auto\">{% asset_img google_support.png google_support%}</div>\n\n### â‘¢ ãƒ‘ãƒ¯ãƒã‚’ç¿»è¨³\n1. ãƒ‘ãƒ¯ãƒã®è§£æã¯slideâ†’shapeâ†’paragraphâ†’runã«åŸºã¥ã„ã¦è¡Œã„ã¾ã—ãŸã€‚\n- æœ¬è¨˜äº‹ã§ã¯æœ€å°å˜ä½ã§ã‚ã‚‹run.textã”ã¨ã®ãƒ†ã‚­ã‚¹ãƒˆç¿»è¨³ã¨runä¸€å€‹ä¸Šã®paragraph.textã”ã¨ã®ãƒ†ã‚­ã‚¹ãƒˆç¿»è¨³ã‚’è¡Œã„ã¾ã—ãŸã€‚\n<div style=\"width:100%;margin:auto\">{% asset_img ppt.png ppt%}</div>\n- notesã®éƒ¨åˆ†ã¯`slide.notes_slide.notes_text_frame.text`ã§ãƒ†ã‚­ã‚¹ãƒˆæœ¬æ–‡ã‚’æŒ‡å®šã§ãã¾ã™ã€‚\n- ãƒ†ãƒ¼ãƒ–ãƒ«ã®éƒ¨åˆ†ã¯`shape.shape_type == MSO_SHAPE_TYPE.TABLE`ã‚’ä½¿ã£ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµã£ã¦ã€rowâ†’cellã¨ã„ã†æ§‹é€ ã«åŸºã¥ã„ã¦`cell.text_frame.text`ã‚’ç”¨ã„ã¦æœ¬æ–‡ã‚’æŒ‡å®šã§ãã¾ã™ã€‚\n- Google_Translatorã¯ç©ºç™½ã¨NoneTypeã«å¯¾å¿œã—ãªã„ãŸã‚ã€`if paragraph.text.isspace() != True and paragraph.text != ''`ã‚’ä½¿ã£ã¦ãã‚Œã‚‰ã‚’é™¤å¤–ã—ã¾ã—ãŸã€‚\n- `#`ãŒå…¥ã£ã¦ã—ã¾ã†ã¨ã€é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç”Ÿã˜ã¦ã—ã¾ã†ã‚‰ã—ã„ã®ã§ã€`str_in = title.text.replace('#','')`ã‚’ä½¿ã£ã¦ç¿»è¨³ã«æŠ•ã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã«å…¥ã£ã¦ã„ã‚‹`#`ã‚’é™¤å¤–ã—ã¾ã—ãŸã€‚\n```\njson_inputs = {\n    'file_path':ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’ã“ã“ã«è¨˜å…¥,\n    'Google': False, #deep-translator\n    'translate': True, #api with Google Apps Script\n    'Linguee':False, #deep-translator\n    'DeepL':False, #deep-translator\n    'notes':True,\n    'source_Google':'ja',\n    'target_Google':'en',\n    'source_translate':'ja',\n    'target_translate':'en',\n    'source_Linguee':'ja',\n    'target_Linguee':'en',    \n    'source_deepl':'JA',\n    'target_deepl':'EN'\n}\n\npath_to_presentation = json_inputs['file_path']\nprs = Presentation(path_to_presentation)\n\ndef ppt_translate(prs):\n    for ns,slide in enumerate(prs.slides): #slide\n        title = slide.shapes.title\n        if title:\n            if json_inputs['Google']:\n                str_in = title.text.replace('#','')\n                title_out = Google_Translator(str_in)\n                sleep(1.5)\n                title.text = title_out\n            elif json_inputs['translate']:\n                str_in = title.text.replace('#','')\n                title_out = translate(str_in)\n                sleep(1.5)\n                title.text = title_out\n            elif json_inputs['deepL']:\n                str_in = title.text.replace('#','')\n                title_out = deepl_translate(str_in)\n                sleep(1.5)\n                title.text = title_out\n        if json_inputs['notes']: #notes\n            if slide.has_notes_slide: \n                if json_inputs['Google']:\n                    str_in = slide.notes_slide.notes_text_frame.text.replace('#','')\n                    notes_out = Google_Translator(str_in)\n                    sleep(1.5)\n                    slide.notes_slide.notes_text_frame.text = notes_out\n                elif json_inputs['translate']:\n                    str_in = slide.notes_slide.notes_text_frame.text.replace('#','')\n                    notes_out = translate(str_in)\n                    sleep(1.5)\n                    slide.notes_slide.notes_text_frame.text = notes_out \n                elif json_inputs['deepL']:\n                    str_in = slide.notes_slide.notes_text_frame.text.replace('#','')\n                    notes_out = deepl_translate(str_in)\n                    sleep(1.5)\n                    slide.notes_slide.notes_text_frame.text = notes_out\n        for nsh,shape in enumerate(slide.shapes):\n            if shape.shape_type == MSO_SHAPE_TYPE.TABLE: #table\n                for row in shape.table.rows:\n                    for cell in row.cells:\n                        if json_inputs['Google']:\n                            str_in = cell.text_frame.text.replace('#','')\n                            cell_out = Google_Translator(str_in)\n                            sleep(1.5)\n                            cell.text_frame.text = cell_out\n                        elif json_inputs['translate']:\n                            str_in = cell.text_frame.text.replace('#','')\n                            cell_out = translate(str_in)\n                            sleep(1.5)\n                            cell.text_frame.text = cell_out\n                        elif json_inputs['deepL']:\n                            str_in = cell.text_frame.text.replace('#','')\n                            cell_out = deepl_translate(str_in)\n                            sleep(1.5)\n                            cell.text_frame.text = cell_out\n#paragraph.textã”ã¨ã®ãƒ†ã‚­ã‚¹ãƒˆç¿»è¨³\n            if shape.has_text_frame:\n                for np,paragraph in enumerate(shape.text_frame.paragraphs):\n                    if json_inputs['Google']:\n                    # Google_Translatorã¯ç©ºç™½ã¨NoneTypeã«å¯¾å¿œã—ãªã„ãŸã‚ã€ãã‚Œã‚‰ã‚’é™¤å¤–ã™ã‚‹\n                        if paragraph.text.isspace() != True and paragraph.text != '':\n                            str_in = paragraph.text.replace('#','')\n                            str_out = Google_Translator(str_in)\n                            paragraph.text = str_out\n                    elif json_inputs['translate']:\n                        str_in = paragraph.text.replace('#','')\n                        str_out = translate(str_in)\n                        paragraph.text = str_out\n                    elif json_inputs['deepL']:\n                        str_in = paragraph.text.replace('#','')\n                        str_out = deepl_translate(str_in)\n                        paragraph.text = str_out\n#run.textã”ã¨ã®ãƒ†ã‚­ã‚¹ãƒˆç¿»è¨³\n#                     for rs,run in enumerate(paragraph.runs):\n#                         if json_inputs['Google']:\n#                             str_in = run.text.replace('#','')\n#                             str_out = Google_Translator(str_in)\n#                             run.text = str_out\n#                         elif json_inputs['translate']:\n#                             str_in = run.text.replace('#','')\n#                             str_out = translate(str_in)\n#                             sleep(1.5)\n#                             run.text = str_out\n#                         elif json_inputs['deepL']:\n#                             str_in = run.text.replace('#','')\n#                             str_out = deepl_translate(str_in)\n#                             sleep(1.5)\n#                             run.text = str_out\n        prs.save(os.path.split(path_to_presentation)[1].split('.pptx')[0]+'_en.pptx')\n        print(f'ç¬¬{ns}ã‚¹ãƒ©ã‚¤ãƒ‰ã¯å®Œäº†')\n```\n- run.textã‚’å˜ä½ã¨paragraph.textã‚’å˜ä½ã«ç¿»è¨³ã—ãŸçµæœã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\n- paragraph.textã®ã»ã†ãŒè‹¥å¹²ãƒŠãƒãƒ¥ãƒ©ãƒ«ã¨æ°—ãŒã—ã¾ã™ãŒã€run.textã®å ´åˆã¯ã¡ã‚ƒã‚“ã¨ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ãƒˆã‚„ã€å¤ªå­—ç­‰ã‚’åŸæœ¬ã®ã¾ã¾ã§ä¿æŒã§ãã‚‹ã®ã§ã€å ´åˆã«ã‚ˆã£ã¦å–æ¨é¸æŠã§ããŸã‚‰ã¨æ€ã„ã¾ã™ã€‚\n\n|run.text|paragraph.text|\n|-|-|\n|<div style=\"width:80%;margin:auto\">{% asset_img run_text.png run_text%}</div>|<div style=\"width:100%;margin:auto\">{% asset_img paragraph_text.png paragraph_text%}</div>|\n\n### â‘£ Excel,csv,txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¿»è¨³\n- Excel,csv,txtã®å ´åˆã ã¨ãšã£ã¨ç°¡å˜ã§ã™ãŒã€ä¸€å¿œç·´ç¿’ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®é–¢æ•°ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚\n```\ndef excel_excel_txt(path):\n    if os.path.splitext(path)[1] == '.csv':\n        df = pd.read_csv(path,index_col=0)\n    elif os.path.splitext(path)[1] == '.xlsx':\n        df = pd.read_excel(path,header=None,index_col=0)\n    elif os.path.splitext(path)[1] == '.txt':\n        df = pd.read_table(path,header=None)\n    for i in df.columns:\n        if json_inputs['Google']:\n            i_en = [Google_Translator(str(m)) for m in df[i]]\n            sleep(1.5)\n            df[f'{i}_en'] = i_en\n        elif json_inputs['translate']:\n            i_en = [translate(str(m)) for m in df[i]]\n            sleep(1.5)\n            df[f'{i}_en'] = i_en\n        elif json_inputs['DeepL']:\n            i_en = [DeepL_Translator(str(m)) for m in df[i]]\n            sleep(1.5)\n            df[f'{i}_en'] = i_en\n    df.to_csv(os.path.splitext(json_inputs['file_path'])[0]+'.csv',encoding='utf-8-sig')\n    return df\n```\n\n### â‘¤ Next Action\n- ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã§å®Ÿç¾ã§ããŸã“ã¨ã‚’Web ãƒ„ãƒ¼ãƒ«ã«ã¦å®Ÿç¾ã§ããŸã‚‰è‰¯ã„ã‹ã¨æ€ã„ã¾ã™ã€‚\n- ç¾çŠ¶ãƒ‘ãƒ¯ãƒå†…ã®ç”»åƒãƒ†ã‚­ã‚¹ãƒˆã®ç¿»è¨³ã¯ã¾ã ã§ãã¦ã„ãªã„ã®ã§ã€ä»Šå¾Œç”»åƒã®éƒ¨åˆ†ã‚‚ã‚¯ãƒªã‚¢ã—ãŸã„ã§ã™ã€‚\n- wordã€pdfç³»ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã“ã¡ã‚‰ã«å–ã‚Šå…¥ã‚ŒãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n### Appendix\n1. ä¸­å›½ç¹é«”èªâ‡”ç°¡ä½“èª\n- deep-translatorã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ\n```\ntext = 'ç»Ÿè®¡å­¦å…¥é—¨'\n\nresult = GoogleTranslator(source = 'auto',target = 'zh-tw').translate(text=text)\nresult\n#'çµ±è¨ˆå­¸å…¥é–€'\n```\n- openccã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ\n```\npip install opencc-python-reimplemented\nfrom opencc import OpenCC\ncc = OpenCC('S2t')\nto_convert = 'ç»Ÿè®¡å­¦å…¥é—¨'\nconverted = cc.convert(to_convert)\nconverted\n#'çµ±è¨ˆå­¸å…¥é–€'\n```\n2. å˜èªã®åŒç¾©èªã‚’å–å¾—\n- deep-translatorã®LingueeTranslatorã‚’ä½¿ã£ã¦ã€å˜èªã®åŒç¾©èªã‚’å–å¾—ã§ãã‚‹\n- LingueeTranslatorå†…ã®`return_all = True`ã«ã™ã‚‹ã¨ã€è©²å½“å˜èªã®ç¿»è¨³ã—ãŸè¨€èªã®åŒç¾©èªãŒã„ãã¤ã‹å‡ºã¦ãã‚‹\n```\nword='é¢ç™½ã„'\ntranslated_linguee = LingueeTranslator(source = 'ja',target = 'en').translate(word,return_all = True)\ntranslated_linguee \n#['interesting', 'interesting', 'amusing']\n```\n\n\n\n\n\n\n\n","tags":["è‡ªå‹•åŒ–","ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ","ç¿»è¨³","ãƒ‘ãƒ¯ãƒ"],"categories":["pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–"]},{"title":"find the different files between 2 folders","url":"/Jorey-s-Blog/2021/02/07/find-the-different-files-between-2-files-md/","content":"<!-- toc -->\n---------------\n### 1.èª²é¡Œ\n- ä¸€ã¤ã®åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã¦ã€2ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’å¾—ãŸã€‚\n\t- A_fullãƒ•ã‚©ãƒ«ãƒ€:ã‚¨ãƒ©ãƒ¼ãªãè§£å‡ã§ãã€ãƒ•ã‚¡ã‚¤ãƒ«ç´›å¤±ã®ãªã„ãƒ•ã‚©ãƒ«ãƒ€\n\t- B_errorãƒ•ã‚©ãƒ«ãƒ€:é€”ä¸­ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã—ã¾ã„ã€ä¸€éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒç´›å¤±ã—ã¦ã—ã¾ã£ãŸãƒ•ã‚©ãƒ«ãƒ€\n- ã“ã®2ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ãã‚Œãã‚Œï¼˜ã¤ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã€ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€åã¯ä»¥ä¸‹ã®å¯¾å¿œé–¢ä¿‚ã§ã‚ã‚‹ã€‚\n\t- A_full:20210201 ~ B_error:a1\n\t- A_full:20210202 ~ B_error:a10\n\t- A_full:20210203 ~ B_error:a11\n\t- A_full:20210204 ~ B_error:a2\n\t- A_full:20210205 ~ B_error:a\n\t- A_full:20210206 ~ B_error:A1\n\t- A_full:20210207 ~ B_error:A19\n\t- A_full:20210208 ~ B_error:S\n\t|A_full|B_error|\n\t|-|-|\n\t|<div style=\"width:70%;margin:auto\">{% asset_img A_full.png A_full%}</div>|<div style=\"width:70%;margin:auto\">{% asset_img B_error.png B_error%}</div>|\n<!-- more -->\n- ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯ãã‚Œãã‚Œä¸€è‡´ã—ã¦ã„ã‚‹ã€‚\n\t- 20210201\n\t<div style=\"width:50%;margin:auto\">{% asset_img 20210201.png 20210201%}</div>\n\t- a1\n\t<div style=\"width:70%;margin:auto\">{% asset_img a1.png a1%}</div>\n- æ¢ã—ã ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã«æ ¼ç´ã™ã‚‹ã€ä»¥ä¸‹ã®é€šã‚Šã«ãªã£ã¦ã»ã—ã„ã€‚\n\t|ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ |20210201-a1å¾Œã®çµæœ|\n\t|-|-|\n\t|<div style=\"width:70%;margin:auto\">{% asset_img new.png new%}</div>|<div style=\"width:100%;margin:auto\">{% asset_img new_20210201.png new_20210201%}</div>|\n\n### 2.A_fullã¨B_errorå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ãƒãƒƒãƒã™ã‚‹\n<div id=\"kk_full\">\n\n>ã¾ãšA_fullã¨B_errorã®ãƒ‘ã‚¹ã‚’ç”¨æ„ã™ã‚‹\n\n</div>\n\n~~~\nkk_full=[k for k,w,t in os.walk('./A_full')]\nww_full=[w for k,w,t in os.walk('./A_full')]\ntt_full=[t for k,w,t in os.walk('./A_full')]\n\nkk_error=[k for k,w,t in os.walk('./B_error')]\nww_error=[w for k,w,t in os.walk('./B_error')]\ntt_error=[t for k,w,t in os.walk('./B_error')]\n\nkk_full\n#['./A_full',\n './A_full\\\\20210201',\n './A_full\\\\20210202',\n './A_full\\\\20210203',\n './A_full\\\\20210204',\n './A_full\\\\20210205',\n './A_full\\\\20210206',\n './A_full\\\\20210207',\n './A_full\\\\20210208']\n\nfile_name_full = [kk_full[i].split('/')[-1].split('\\\\')[-1] for i in range(1,len(kk_full))]\nfile_name_error = [kk_error[i].split('/')[-1].split('\\\\')[-1] for i in range(1,len(kk_error))]\n\nfile_name_error\n#['a', 'A1', 'a1', 'a10', 'a11', 'A19', 'a2', 'S']\n~~~\n>ä¸¦ã³æ›¿ãˆãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹(`ï¼ ãªãŒãŸ`ã•ã‚“ã«æ„Ÿè¬ï¼)\n>è€ƒãˆæ–¹ã¨ã—ã¦ã¯ã€A,a,Sã‚’ã™ã¹ã¦Unicodeå€¤ã«å¤‰æ›ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€é †ä½ã‚’äººç‚ºçš„ã«ä»˜ã‘ã•ã›ã‚‹ã€‚\n~~~\ndef rank_filename(value):\n    if len(value) <= 1:\n        for i in count():\n            try:\n                _ = chr(i)\n            except ValueError:\n                max_char_number = i-1\n                break\n        left,right = value.lower(),chr(max_char_number)    \n    else:\n        left,right = value[0],''.join(list(value)[1:])\n        #A-Zã®ã»ã†ãŒa-zã‚ˆã‚Šå°ã•ã„ã®ã§ã€ãã‚Œã‚’å…¥ã‚Œæ›¿ãˆã‚‹\n        left_after = ''\n        for c in left:\n            if 'a' <= c <= 'z':\n                left_after += chr(ord('A')+(ord(c)-(ord('a')))+5)\n            elif 'A' <= c <= 'Z':\n                left_after += chr(ord('a')+(ord(c)-(ord('A')))+5)\n            else:\n                left_after += c\n        left = left_after      \n    return left,right\n~~~\n>å®šç¾©ã—ãŸrank_filenameé–¢æ•°ã‚’sortã®keyã«å¿œç”¨ã™ã‚‹ã€‚\n~~~\nfile_name_sort = sorted(file_name_error,key=rank_filename)\nfile_name_sort\n#['a1', 'a10', 'a11', 'a2', 'a', 'A1', 'A19', 'S']\n~~~\n>å‚è€ƒâ‘ A,a,S,-ãªã©ã®Unicodeå€¤ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚\n```\nord('A'),ord('S'),ord('a'),ord('s'),ord('-')\n#(65, 83, 97, 115, 45)\n```\n### 3.ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—ã™ã‚‹\n```\nfolder_path_sorted = ['./B_error/'+i for i in file_name_sort]\nfolder_path_full = ['./A_full/'+i for i in file_name_full]\n\ndef make_full_path(list_):\n    full_path = []\n    for i in list_:\n        for v,k,m in os.walk(i):\n            path_tmp = [os.path.join(v,x) for x in m]\n            full_path.append(path_tmp)\n    return full_path\n\nfull_path_sorted = make_full_path(folder_path_sorted)\nfull_path_all = make_full_path(folder_path_full)\n\nfull_path_sorted[7][0]\n#'./B_error/S\\\\å…¨å“¡ã«ï¼‘ãƒ¬ãƒƒã‚¹ãƒ³ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆï¼ä»™å°æ ¡ç§»è»¢è¨˜å¿µâ™ªãƒˆãƒ©ã‚¤ã‚¢ãƒ«ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å‚¬ï¼ï¼.eml'\n```\n>å¿µã®ç‚ºã€Bãƒ•ã‚©ãƒ«ãƒ€ã¨Aãƒ•ã‚©ãƒ«ãƒ€ã®å¯¾å¿œé–¢ä¿‚ã‚’ä¸€ã¤ã®è¾æ›¸ã«æ ¼ç´ã—ãŸã€‚\n```\nfile_path_dict=dict(zip(folder_path_sorted,folder_path_full))\nfile_path_dict\n#{'./B_error/a1': './A_full/20210201',\n './B_error/a10': './A_full/20210202',\n './B_error/a11': './A_full/20210203',\n './B_error/a2': './A_full/20210204',\n './B_error/a': './A_full/20210205',\n './B_error/A1': './A_full/20210206',\n './B_error/A19': './A_full/20210207',\n './B_error/S': './A_full/20210208'}\n```\n### 4-1.ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ã‚‚ã¨ã«æ¯”è¼ƒã™ã‚‹\n>ä¸€åº¦ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã®é †åºã‚’å¤‰ãˆãŸã®ã§ã€Bãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹æƒ…å ±ã‚’æ–°ãŸã«æ ¼ç´ã™ã‚‹\n```\nkk_error_sorted=[k for i in folder_path_sorted for k,w,t in os.walk(i)]\n# ww_sorted=[w for i in folder_path_sorted for k,w,t in os.walk(i)]\ntt_error_sorted=[t for i in folder_path_sorted for k,w,t in os.walk(i)]\n```\n[ã™ã§ã«å‡¦ç†æ¸ˆã¿ğŸ‘‡](#kk_full)\n```\nkk_full=[k for k,w,t in os.walk('./A_full')]\nww_full=[w for k,w,t in os.walk('./A_full')]\ntt_full=[t for k,w,t in os.walk('./A_full')]\n\n#ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã®å·®åˆ†ã‚’å–ã‚Šå‡ºã™\nlist_ = [[]]*8\nfor i in range(len(tt_error_sorted)):\n    list_.append(list(set(tt_full[i+1])-set(tt_error_sorted[i])))\nlist_\n[[],\n [],\n [],\n [],\n [],\n [],\n [],\n [],\n ['Nintendo Switchã€ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒãƒ³ã‚¿ãƒ¼ãƒ©ã‚¤ã‚ºã€ã®æœ€æ–°æ˜ åƒãŒå…¬é–‹ã€‚ _ ãƒˆãƒ”ãƒƒã‚¯ã‚¹ _ Nintendo.html',\n  'The savings are clear.eml',\n  'ã€Nintendo Switchã€‘æœŸé–“é™å®šã‚»ãƒ¼ãƒ«ãƒ»æ–°ä½œã»ã‹ã€ã‚½ãƒ•ãƒˆã®ã”ç´¹ä»‹.eml'],\n ['Your question of the week from Vocabulary.com.eml',\n  'æ±äº¬2020å¤§ä¼šï¼šã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯ï¼†ãƒ‘ãƒ©ãƒªãƒ³ãƒ”ãƒƒã‚¯ã®ä¸–ç•Œã¸.eml'],\n ['æ–°å¹´ã®ã”æŒ¨æ‹¶.eml', 'ã‚‚ã£ã¡ã‚‚ã£ã¡ã®å¼¾åŠ›ã«ã€è„ˆæ‰“ã¤ç†Ÿæˆé¦™ã€‚é­…æƒ‘ã®ãƒ–ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚ã‚“ã±ã‚“.eml'],\n ['ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’å®‰å…¨ã«ä¿è­·ã™ã‚‹ãŸã‚ã®ã‚ˆã‚Šè‰¯ã„æ–¹æ³•.eml',\n  'ã‚´ãƒ¼ã‚¹ãƒˆãƒ©ã‚¤ã‚¿ãƒ¼é¨’å‹•ã‹ã‚‰7å¹´ æ–°å£éš†ã®ã€Œè¦šæ‚Ÿã€.eml',\n  'Communication trends of 2020.eml'],\n ['æ±äº¬2020å¤§ä¼šï¼šã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯ï¼†ãƒ‘ãƒ©ãƒªãƒ³ãƒ”ãƒƒã‚¯ã®ä¸–ç•Œã‚’çŸ¥ã‚Šå°½ããã†.eml', 'å®‡è³€ãªã¤ã¿ã€æ€ã‚ãšæ¯ã‚’ã®ã‚€.eml'],\n ['æ·±åº¦å­¦ä¹ ä¹‹è·¯ï¼ˆä¸€ï¼‰ï¼šç”¨LSTMç½‘ç»œåšæ—¶é—´åºåˆ—æ•°æ®é¢„æµ‹ - ç®€ä¹¦.html'],\n ['Our cool-productivity-killer newsletter.eml'],\n ['æ˜æ™ºå…‰ç§€ã€æœ€å¾Œã®å¤œã¯â€¦â€¦.eml']]\n\n dict_path = dict(zip(kk_full[1:],list_[8:]))\n```\n### 4-2.å·®åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°ã—ããƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã«ä¿å­˜ã™ã‚‹\n```\nsave_dir='./new/'\nif not os.path.isdir(save_dir):\n    os.makedirs(save_dir)\n\nfor i in kk_full[1:]:\n#     print(i.split('/')[1].split('\\\\')[1])\n    for m in dict_path[i]:\n        from_path = os.path.join(i,m)\n#         print(from_path)\n        to_path = os.path.join(save_dir,i.split('/')[1].split('\\\\')[1])\n        if not os.path.isdir(to_path):\n            os.makedirs(to_path)\n        copy(from_path,to_path)\n```\n### 5-1.å†…å®¹ã¨ã‚‚ã¨ã«æ¯”è¼ƒã™ã‚‹\n>ä»Šå›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯eml,html(ã‚µãƒ³ãƒ—ãƒ«ã«ã¯ãªã„ã‘ã©ã€ã»ã‚“ã¨ã¯msgãƒ•ã‚¡ã‚¤ãƒ«ã‚‚)ãŒå…¥ã£ã¦ã„ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®å†…å®¹æŠ½å‡ºã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’ä½œæˆã—ãŸã€‚\n~~~\ndef extract_text(list_):\n    text = []\n    file_id = []\n    for i in list_:\n        if i.split('.')[-1] == 'eml':\n            file_id.append(i)\n            with open(i,'r',encoding = 'utf-8-sig') as f:\n                text_ = f.read()\n                text.append(text_)\n#                 print('extracted',i)\n        elif i.split('.')[-1] == 'msg':\n            file_id.append(i)\n            subject = extract_msg.Message(i).subject\n            date = extract_msg.Message(i).date\n            body = extract_msg.Message(i).body\n            text_ = subject+date+body\n            text.append(text_)\n#             print('extracted',i)\n        elif i.split('.')[-1] == 'html':\n            file_id.append(i)\n            htmlfile = open(i, 'r', encoding='utf-8-sig')\n            htmlhandle = htmlfile.read()\n            soup = BeautifulSoup(htmlhandle, 'html.parser')\n            text.append(soup.text)\n#             print('extracted',i)\n            \n#         dict_ = dict(zip(file_id,text))\n    return file_id,text         \n~~~\n>ä¸Šè¨˜é–¢æ•°ã‚’ä½¿ã£ã¦ã€ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã®å†…å®¹ã‚’æ¯”è¼ƒã—ã€ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—ã™ã‚‹\n~~~\ndiffer_ids=[]\nfor i in range(len(full_path_all)):\n    file_id,text_sorted =extract_text(full_path_all[i])\n    file_id_error,text_error =extract_text(full_path_sorted[i])\n    dict_ = dict(zip(text_sorted,file_id))\n    differ_id = []\n    for m in text_sorted:\n        if m not in text_error:\n            differ_id.append(dict_[m])\n    differ_ids.append(differ_id)\n\ndiffer_ids[1]\n#['./A_full/20210202\\\\Your question of the week from Vocabulary.com.eml',\n './A_full/20210202\\\\æ±äº¬2020å¤§ä¼šï¼šã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯ï¼†ãƒ‘ãƒ©ãƒªãƒ³ãƒ”ãƒƒã‚¯ã®ä¸–ç•Œã¸.eml']\n~~~\n### 5-2.å·®åˆ†ã‚’ä¿å­˜ã™ã‚‹\n~~~\nsave_dir='./new'\nif not os.path.isdir(save_dir):\n    os.makedirs(save_dir)\nfor i in differ_ids:\n    for m in i:\n#         print(m.split('/')[2].split('\\\\')[0])\n        to_path = os.path.join(save_dir,m.split('/')[2].split('\\\\')[0])\n        if not os.path.isdir(to_path):\n            os.makedirs(to_path)\n        copy(m,to_path)\n~~~\n### appendix ãƒ•ã‚©ãƒ«ãƒ€åã‚’å¤‰æ›´ã™ã‚‹\n>æŠ•ã’ãŸãƒ•ã‚©ãƒ«ãƒ€(pathã§æŒ‡å®š)å†…ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€åã‚’name_listã®é †åºé€šã‚Šã«åå‰ã‚’å¤‰æ›´ã•ã›ã‚‹ã€‚\n~~~\ndef rename(path):\n    i=0\n    name_list=['kaggle','tableau','pytorch'] #è‡ªç”±è¨­å®šã§ãã‚‹\n    FileList = os.listdir(path)\n    for files in FileList:\n        oldDirPath = os.path.join(path, files)\n        if os.path.isdir(oldDirPath):\n            rename(oldDirPath)            \n            newDirPath=os.path.join(path,name_list[i])\n            os.rename(oldDirPath, newDirPath)\n            print(files +' has changed as '+newDirPath)\n            i += 1\n~~~\n### Next\n- ã™ã§ã«åŒã˜æ©Ÿèƒ½ã‚’æœãŸã—ã¦ã„ã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚‹ã‚‰ã—ã„ã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½¿ã„ã‚„ã™ã„ãŸã‚ã€webãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚Œã‚‹ã¨ã„ã„ãªã¨æ€ã„ã¾ã™ã€‚\n- ä»Šå›ã¯å˜ã«eml,msg,htmlã‚’èª­ã¿è¾¼ã‚“ã ã ã‘ãªã®ã§ã€ä»Šåº¦ç´°ã‹ããƒ†ã‚­ã‚¹ãƒˆæ–‡æ›¸ã‚’æŠ½å‡ºã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n21","tags":["è‡ªå‹•åŒ–","ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ"],"categories":["pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–"]},{"title":"markdownè¨˜æ³•","url":"/Jorey-s-Blog/2021/02/03/markdownè¨˜æ³•/","content":"<!-- toc -->\n---------------\n<div id=\"title1\">\n\n### 1.ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹\n</div>\n\n\nã“ã®ã‚ˆã†ã«`code`ã‚’ãƒãƒƒã‚¯ã‚¯ã‚ªãƒ¼ãƒˆã‚’è¡¨ç¾ã—ãŸã„ã‚³ãƒ¼ãƒ‰ã®é–“ã«å…¥ã‚Œã‚‹ã¨ã§ãã‚‹\n~~~\nã“ã®ã‚ˆã†ã«`code`ã‚’ãƒãƒƒã‚¯ã‚¯ã‚ªãƒ¼ãƒˆã‚’è¡¨ç¾ã—ãŸã„ã‚³ãƒ¼ãƒ‰ã®é–“ã«å…¥ã‚Œã‚‹ã¨ã§ãã‚‹\n~~~\n\n### 2.ãƒšãƒ¼ã‚¸å†…ãƒªãƒ³ã‚¯\n- æ–¹æ³•1:id ã‚’æŒ‡å®šã—ã¦ç§»å‹•ã•ã›ã‚‹(Markdown/htmlä¸¡æ–¹ã¨ã‚‚OK\n<font size=2.5>**idåã¯è‹±èªã§ã¯ãªã„ã¨ã€ä½ç½®ãšã‚Œã¦ã—ã¾ã†æã‚ŒãŒã‚ã‚‹ã®ã§ã€è¦æ³¨æ„**</font>\n\n~~~\n#å‡ºç™ºç®‡æ‰€ï¼š\n[contents](#idå)\n\n#ç›®çš„ç®‡æ‰€ï¼š\n<div id=\"idå(ä»»æ„)\"></div>\n~~~\n- æ–¹æ³•2:ãƒ˜ãƒƒãƒ€ãƒ¼ã®åå‰ã‚’æŒ‡å®šã—ã¦ç§»å‹•ã™ã‚‹(Markdownè¨˜æ³•ã®ã¿)\n<font size=2.5>**ã“ã®æ–¹æ³•ã¯æœ¬è¨˜äº‹ã§å®Ÿç¾ã§ããªã‹ã£ãŸ**</font>\n\n~~~\n#å‡ºç™ºç®‡æ‰€\n[contents](#1.ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹)\n#ç›®çš„ç®‡æ‰€\næŒ‡å®šã•ã‚ŒãŸãƒ˜ãƒƒãƒ€ãƒ¼\n~~~\n[Sample:æ–¹æ³•1ã‚’ä½¿ã£ã¦**1.ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹**ã¸ç§»å‹•](#title1)\n\n","tags":["markdown","è¨˜æ³•","æ—¥ã€…ã®ç©ã¿ä¸Šã’"],"categories":["æ—¥ã€…ã®ç©ã¿ä¸Šã’"]},{"title":"Pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–","url":"/Jorey-s-Blog/2021/01/25/Pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–/","content":"<!-- toc -->\n---------------\n## ä¸€ã€è¤‡æ•°ã®csvã‚’Excelã®Sheetã«ä¿å­˜ã™ã‚‹\n### 1.ç›®çš„\n<font size=3>\n\n>åŒã˜ãƒ•ã‚©ãƒ«ãƒ€å†…ã®csvãƒ•ã‚¡ã‚¤ãƒ«ã«æƒ…å ±ã‚’è¿½åŠ ã—ã€åˆä½µã™ã‚‹\n>ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã®æƒ…å ±ã‚’ä¸€æšã®Excelè¡¨ã«ã‚·ãƒ¼ãƒˆã”ã¨ã«ã¾ã¨ã‚ã‚‹\n\n</font>\n\n### 2.äº‹å‰èª¬æ˜\n>â‘ ä½¿ã£ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«\n~~~\n\timport os\n\timport pandas as pd\n\timport datetime\n\timport py7zr\n\timport openpyxl\n~~~\n>â‘¡ãƒ‡ãƒ¼ã‚¿æ§‹é€ \n>>1_æ¯æ—¥åŒã˜æ§‹é€ ã®ãƒ‡ãƒ¼ã‚¿ãŒç”Ÿæˆã™ã‚‹ã¨æƒ³å®šã™ã‚‹\n~~~\n20200701.7z\nâ–²ãƒ•ã‚©ãƒ«ãƒ€1\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«1\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«2\nâ–²ãƒ•ã‚©ãƒ«ãƒ€2\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«1\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«2\nâ–²ãƒ•ã‚©ãƒ«ãƒ€3\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«1\n\tâ– csvãƒ•ã‚¡ã‚¤ãƒ«2\n~~~\n>>2_å…ƒãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«\n\n<!-- more -->\n---------------\n\n<table>\n<tr><th>20200701.csv</th><th>log_20200701.csv</th></tr>\n<tr><td>\n\n|é–‹å§‹æ™‚é–“|ã‚µã‚¤ã‚º(Byte)|\n|-|-|\n|2020/7/1  0:02:00|0|\n|2020/7/1  0:06:00|32567889| ã€€ã€€\n|2020/7/1  0:08:00|17869027|\n|2020/7/1  0:10:00|3170165999|\n...\n\n</td><td>\n\n|é–‹å§‹|å‡¦ç†æ™‚é–“|ä»¶æ•°\n|-|-|-|\n|2020/7/1  0:02:00|0:00:00|0|\n|2020/7/1  0:06:00|02:27.1|32|\n|2020/7/1  0:08:00|02:04.0|0|\n|2020/7/1  0:10:00|0:00:00|-20|\n\n</td></tr> </table>\n\n>>3_å¸Œæœ›çµæœ\n\n<div style=\"width:70%;margin:auto\">{% asset_img result.png result%}</div>\n\n### 3.è§£å‡\n\n<font size=3>\n\n>â‘ åœ§ç¸®ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’è§£å‡ã™ã‚‹\n\n</font>\n\n~~~\nzipfilename = './20200701.7z'\nfiles = py7zr.SevenZipFile(zipfilename,'r')\nfiles.extractall(path = ï½’'') #ã“ã“è§£å‡å¾Œãƒ•ã‚©ãƒ«ãƒ€ã®pathã‚’ç©ºç™½ã«ã™ã‚Œã°ã€ä½™è¨ˆãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç”Ÿæˆã—ãªãã¦ã‚‚æ¸ˆã‚€\nfiles.close()\n~~~\n<font size=3>\n\n>â‘¡è§£å‡å¾Œãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ‘ã‚¹ã‚’ãƒªã‚¹ãƒˆã«æ ¼ç´ã™ã‚‹\n\n</font>\n\n~~~\npath = zipfilename[2:10]\ndef read_file(path):\n    mm = [m for m,k,w in os.walk(path)]\n    kk = [k for m,k,w in os.walk(path)]\n    ww = [w for m,k,w in os.walk(path)]\n    file_path_1 = []\n    file_path_2 = []\n    for i in range(1,len(mm)):\n        path_1 = mm[i] + '/' + ww[i][0]\n        path_2 = mm[i] + '/' + ww[i][1]\n        file_path_1.append(path_1)\n        file_path_2.append(path_2)\n    return file_path_1,file_path_2\n~~~\n\n### 4.csvã®æ“ä½œ\n<font size=3>\n\n>â‘ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ã€Œä»¶æ•°ã€åˆ—ã¯-20ã«ç­‰ã—ã„è¡Œã‚’å‰Šé™¤\n\n</font>\n\n~~~\ndef make_dataframe(file_path_1,file_path_2):\n    df_1 = [pd.read_csv(file_path_1[k],encoding='cp932') for k in range(len(file_path_1))]\n    df_2 = [pd.read_csv(file_path_2[k],encoding='cp932') for k in range(len(file_path_2))]\n    df_2 = [k[k['ä»¶æ•°'] != -20].reset_index() for k in df_2]\n    df_2 = [k.loc[:,['é–‹å§‹','å‡¦ç†æ™‚é–“','ä»¶æ•°']] for k in df_2]\n    return df_1,df_2\n~~~\n<font size=3>\n\n>â‘¡èª­ã¿è¾¼ã‚“ã ï¼’ã¤ã®dataframeã‚’åˆä½µã™ã‚‹\n>â‘¢ã‚µã‚¤ã‚º(Byte)åˆ—ã®å€¤ã‚’ã‚µã‚¤ã‚º(MB)ã«æ›ç®—ã™ã‚‹\n>â‘£æ–‡å­—åˆ—ã§ã‚ã‚‹ã€Œå‡¦ç†æ™‚é–“ã€åˆ—ã‚’datetime.timeå‹(hour,minute,second)ã®ãƒ‡ãƒ¼ã‚¿ã«å¤‰ãˆã‚‹\n>â‘¤secondå˜ä½ã«çµ±ä¸€ã—ã€sumã‚’æ±‚ã‚ãŸã‚‰ã€datetimeå‹ã«æˆ»ã‚‰ã›ã‚‹\n>â‘¥è«¸ã€…ã®é›†è¨ˆçµæœã‚’æœ€å¾Œã®ä¸€è¡Œã«è¿½åŠ ã—ã¦ãŠã\n\n</font>\n\n~~~\ndef make_file(df_1,df_2):\n    df = pd.concat([df_2,df_1],axis=1)\n    df['ã‚µã‚¤ã‚º(MB)'] = df['ã‚µã‚¤ã‚º(Byte)']/(1024**2)\n    \n    ii = [pd.to_datetime(i).time() for i in df_2['å‡¦ç†æ™‚é–“']]\n    time_to_second = []\n    for i in ii:\n        if i.microsecond: #i.microsecond:intå‹\n            s = '%06d' % i.microsecondã€€#intå‹ã‚’æ–‡å­—åˆ—ã«å¤‰æ›´ã™ã‚‹éš›ã€é ­ã®0ã‚’ãªãã•ãªã„ã‚ˆã†ã«ã™ã‚‹\n            if int(s[0]) >= 5:\n                seconds = i.hour*3600 + i.minute*60+ i.second +1\n                time_to_second.append(seconds)\n            else:\n                seconds = i.hour*3600 + i.minute*60+ i.second\n                time_to_second.append(seconds)\n        else:\n            seconds = i.hour*3600 + i.minute*60+ i.second\n            time_to_second.append(seconds)\n    m,s = divmod(sum(time_to_second),60)\n    h,m = divmod(m,60)\n    sum_time='{0}:{1:02d}:{2:02d}'.format(h,m,s)\n    \n    sum_num = sum(df['ä»¶æ•°'])\n    sum_size = sum(df['ã‚µã‚¤ã‚º(Byte)'])\n    sum_size_MB = sum_size/(1024**2)\n    \n    df.loc['sum'] = ['',sum_time,sum_num,sum_size/1024**3,sum_size,sum_size_MB]\n    \n    return df\n~~~\n### 5.excelã«æ›¸ãè¾¼ã‚€\n~~~\ndef combine_to_excel(list_file_1,list_file_2,list_file_3):\n    list_name = ['list_file_1','list_file_2','list_file_3']\n    writer = pd.ExcelWriter('20200701.xlsx')\n    for i in list_name:\n        eval(i).to_excel(excel_writer = writer,sheet_name = i,index=False)\n    writer.save()\n    writer.close()\n~~~\n\n### 6.æ®‹ã‚Šèª²é¡Œ\n>pyãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰ãˆã¦ãŠããŸã„ã€‚\n\n## äºŒã€2ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã«å·®ã«ãªã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹\n### 1.å·®ã«ãªã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã—å‡ºã™\n~~~\nimport os\nfrom shutil import copy\n\nll=[l for l,m,n in os.walk('./')]\nnn = [n for l,m,n in os.walk('./')]\n\n#å¤šã‚ã«ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’åˆ¤å®š\nlen(nn[2]) > len(nn[3])\n#å·®ã«ãªã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¤å®š\nfile = [i for i in nn[2] if i not in nn[3]]\n#å·®ã«ãªã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’ã¤ã‘ã‚‹\npath=[ll[2]+'/'+i for i in file]\n~~~\n### 2.æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼\n~~~\nsave_dir = './data_new'\nif not os.path.isdir(save_dir):\n    os.makedirs(save_dir)\nfor i in range(len(path)):\n    copy(path[i],save_dir) \n~~~\n## ä¸‰ã€ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã«èª­ã¿è¾¼ã¿ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿çµåˆã™ã‚‹\n### 1.ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã«èª­ã¿è¾¼ã¿\n~~~\nimport pandas as pd\nimport os\nimport numpy as np\n\ndatas = []\nfor info in os.listdir(\"ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹\"):\n    domain = os.path.abspath(r\"ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹\")\n    info = os.path.join(domain,info)\n    data = pd.read_csv(info,encoding ='cp932')\n    datas.append(data)\n~~~\n### 2.ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿çµåˆ\n>indexã§æŒ‡å®šã™ã‚‹\n~~~\ndatas_tmp = []\nfor i in range(len(datas)):\n    datas_tmp.append(datas[:i] + datas[i+1:])\n~~~\n\n<div style=\"width:80%;margin:auto\">{% asset_img datas_tmp.png datas_tmp%}</div>\n\n## å››ã€ãƒ•ãƒ©ã‚°ã¤ã‘\n>ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ç¾¤ã«å¯¾ã—ã¦ãƒ©ãƒ³ãƒ€ãƒ ã«10ä»¶HOTãƒ•ãƒ©ã‚°ã«ä»˜ã‘ã€æ®‹ã‚Šã¯å…¨éƒ¨NOTãƒ•ãƒ©ã‚°ã«ã¤ã‘ã‚‹\n>ä¸Šè¨˜ã®datas_tmpã‚’ã‚‚ã¨ã«å®Ÿè¡Œã™ã‚‹\n~~~\ndf=pd.concat(datas_tmp[2])\ndata2=np.random.randint(3,100,(100,3))\ndf_data2=pd.DataFrame(data2,columns=['æŒ¿å…¥','å…¬å¼','ãƒ‡ãƒ¼ã‚¿'])\ndf_data2\nddf=pd.concat([df.reset_index()[['æŒ¿å…¥','å…¬å¼','ãƒ‡ãƒ¼ã‚¿']],df_data2],axis=0)\n~~~\n>ddfã‚’ä»Šå›ãƒ•ãƒ©ã‚°ã¤ã‘ã¦ã‚ã’ãŸã„ãƒ‡ãƒ¼ã‚¿ã¨ã™ã‚‹\n\n<div style=\"width:80%;margin:auto\">{% asset_img å››-1.png å››-1%}</div>\n\n~~~\nimport random\nnum=92\nlist_not=[0]*num\nnum_hot=10\nlist_hot=[1]*num_hot\n\nlist_all=list_not+list_hot\nrandom.shuffle(list_all)\n\nddf['HOT']=list_all\nddf.loc[ddf['HOT']==1,'NOT']=0\nddf.loc[ddf['HOT']==0,'NOT']=1\n~~~\n<div style=\"width:80%;margin:auto\">{% asset_img å››-2.png å››-2%}</div>\n\n## äº”ã€è¾æ›¸ã«ã‚ˆã‚‹ãƒªã‚¹ãƒˆè¦ç´ ã®é‡è¤‡å‰Šé™¤\n<div style=\"width:80%;margin:auto\">{% asset_img äº”_1.png äº”_1%}</div>\nsetã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€hashableã®å¯¾è±¡ã§ã¯ãªã„ã¨åŠ¹ã‹ãªã„ã®ã§ã€ãã®ã¾ã¾setã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã—ã¾ã„ã¾ã™ã€‚\n\n1. å›ç­”â‘ \n    - dictå†…ã™ã¹ã¦ã®è¦ç´ ã‚’ä¸€åº¦é‡è¤‡ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¦ãƒªã‚¹ãƒˆã«æ ¼ç´ã™ã‚‹æ–¹æ³•ã§ã™ã€‚\n\n```\nresult = []\ndef unduplicate(result,data):\n    if data not in result:\n        result = result+[data]\n    return result\nfor i in test:\n    result = unduplicate(result,i)\nresult\n#[{'a': 1}, {'a': 3}, {'b': 2}]\n```\n2. å›ç­”â‘¡\n    - å›ç­”â‘ ã¨æœ¬è³ªçš„ã«å¤‰ã‚ã‚‰ãªã„ã®ã§ã™ãŒã€reduceã‚’ä½¿ã†ã“ã¨ã§ã€ã‚„ã‚„åŠ¹ç‡ã‚ˆããªã‚‹æ–¹æ³•ã§ã™ã€‚\n    -[reduceã®åŸºæœ¬æ§‹æ–‡](https://techacademy.jp/magazine/18844)\n        - reduce(function, iterable, initializer)\n        - ç¬¬1å¼•æ•°ã«ã¯2ã¤ã®å¼•æ•°ã‚’å–ã‚‹functionã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚(å¿…é ˆ)\n        - ç¬¬2å¼•æ•°ã«ã¯iterableã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚(å¿…é ˆ)\n        - ç¬¬3å¼•æ•°ã«ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ãŒã€æŒ‡å®šã•ã‚ŒãŸå ´åˆã€iterableã®å…ˆé ­ã«ç½®ã‹ã‚Œã€iterableãŒç©ºã®å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸç¬¬1å¼•æ•°ã«ã¯functionã®ä»£ã‚ã‚Šã«ãƒ©ãƒ ãƒ€å¼ã‚’ä½¿ç”¨ã™ã‚‹äº‹ã‚‚ã§ãã¾ã™ã€‚\n\n```\nfrom functools import reduce \ndef delete_duplicate(data):\n    func = lambda x,y :x +[y] if y not in x else x\n    data = reduce(func,[[],] +data)\n    return data\ndelete_duplicate(test)\n#[{'a': 1}, {'a': 3}, {'b': 2}]\n```\n3. å›ç­”â‘¢\n    - dictã‚’ç„¡ç†çŸ¢ç†ã«æ–‡å­—åˆ—ã«å¤‰æ›´ã—ã€seté–¢æ•°ã‚’ä½¿ã£ã¦é‡è¤‡å‰Šé™¤ã‚’è¡Œã£ãŸã‚‰ã€evalé–¢æ•°ã‚’ä½¿ã£ã¦dictã«æˆ»ã•ã›ã‚‹æ–¹æ³•ã§ã™ã€‚\n    - [evalé–¢æ•°ã®åŸºæœ¬æ§‹æ–‡](https://techacademy.jp/magazine/40662#1)\n        - eval(\"å¼\", globals=None, locals=None)\n        - ç¬¬1å¼•æ•°ã®â€å¼â€ã«ã¯ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã£ãŸå¼ã‚’ä»£å…¥ã—ã¾ã™ã€‚\n        - ç¬¬2å¼•æ•°ã¨ç¬¬3å¼•æ•°ã«ã¯ã€ä»»æ„ã§ãã‚Œãã‚Œã‚°ãƒ­ãƒ¼ãƒãƒ«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ã€Œåå‰ç©ºé–“ã€ã‚’æŒ‡å®šã—ã¾ã™ãŒã€ã“ã‚Œã‚‰ã¯evalé–¢æ•°ã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ç†è§£ã™ã‚‹ã«ã¯ãã‚Œã»ã©é‡è¦ã§ã¯ãªã„ã®ã§ã€è©³ã—ã„èª¬æ˜ã¯ã“ã“ã§ã¯çœç•¥ã—ã¾ã™ã€‚\n        - evalé–¢æ•°ã®è¿”ã‚Šå€¤ã¨ã—ã¦ã¯ã€ç¬¬1å¼•æ•°ã§æŒ‡å®šã—ãŸå¼ã®å€¤ãŒè¿”ã•ã‚Œã¾ã™ã€‚\n\n```\ndef delete_duplicate(data):\n    dict_ed = set([str(i) for i in data])\n    data = [eval(i) for i in dict_ed]\n    return data\ndelete_duplicate(test)\n#[{'b': 2}, {'a': 3}, {'a': 1}]\n```\n4. å›ç­”â‘£ â˜…â˜…â˜…â˜†â˜†\n    - è¦ç´ ã§ã‚ã‚‹dictã‚’tupleå½¢å¼ã«å¤‰æ›´ã—ã€setã‚’ä½¿ã£ã¦é‡è¤‡å‰Šé™¤ã—ã€dicté–¢æ•°ã‚’ä½¿ã£ã¦tupleå½¢å¼ã‚’dictå½¢å¼ã«æˆ»ã•ã›ã‚‹æ–¹æ³•ã§ã™ã€‚\n    - ã“ã®æ–¹æ³•ã¯2é‡dictã®è¦ç´ ãŒå…¥ã£ã¦ã‚ã‚Œã°é©ç”¨ã—ãªã„ã®ã§ã€ãã®å ´åˆå›ç­”â‘¢ã‚’ä½¿ãˆã‚Œã°ã¨æ€ã„ã¾ã™ã€‚\n\n```\ndata = [dict(t) for t in set([tuple(i.items()) for i in test])]\ndata\n#[{'b': 2}, {'a': 1}, {'a': 3}]\n```\n\n","tags":["Excel","è‡ªå‹•åŒ–","ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ"],"categories":["pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–"]},{"title":"Windowsç’°å¢ƒä¸Šã®Anacondaã«Mecabã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã¨NEologdè¾æ›¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«","url":"/Jorey-s-Blog/2021/01/22/Mecab in Windows/","content":"<font size=2>**æœ¬è¨˜äº‹ã§ã¯ã€MeCabã¨ã¯ã€å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ããŸMeCabã®ã“ã¨ã‚’è¨€ã†ã€Anacondaä¸Šã®MeCabã¯Anacondaä¸Šã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ããŸMeCabã‚’æŒ‡ã—ã¾ã™ã€‚**</font>\n\n<font size=3>\n\n>1)ãƒãƒƒãƒˆä¸Šè‰²ã€…è¨˜äº‹ã‚’å‚è€ƒã—ã¦ã¾ã—ãŸãŒã€ã»ã¼BoWç’°å¢ƒã‚’ã‚‚ã¨ã«ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚\n>2)Windowsç’°å¢ƒ+Anaconda(Python3.7)ä¸Šã§ã¯ã€ä¸‹è¨˜è¨˜äº‹ã®è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹é€šã‚Šå®Ÿè¡Œã—ãŸã‚‰ã†ã¾ãè¡Œã‘ã¾ã—ãŸã®ã§ã€ãƒ¡ãƒ¢ã¨ã—ã¦æ®‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n</font>\n<font size=4.5>\n\n[**Windowsã§MeCab+NEologdã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹**](http://qd-suriken.com/2020/04/22/widows%E3%81%A7mecabneologd/)\n\n</font>\n\n<!-- more -->\n---------------\n<!-- toc -->\n---------------\n\n### 1.MeCabã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹\n>1)Jupyterä¸Šã§pip install mecab-python3ã§ã¯ãªãã€å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰MeCabã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§ã™ã€‚\n>2)å…¬å¼ã‚µã‚¤ãƒˆï¼š[Mecab/download](http://taku910.github.io/mecab/#download)\n>3)è‡ªåˆ†ã¯Binary package for MS-Windowsã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãŠã‚Šã¾ã™ã€‚\n\n<div style=\"width:70%;margin:auto\">{% asset_img mecab_download.png mecab_download%}</div>\n\n>4)ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã®æ¡ˆå†…é€šã‚Šã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œãˆã°ã„ã„ã§ã™ãŒã€è¾æ›¸ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®é¸ã³(è‡ªåˆ†ã¯**utf-8**)ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©å…ˆã®æŒ‡å®š(è‡ªåˆ†ã¯**C:\\Program Files (x86)\\MeCab**)ã¯å¾Œã»ã©å‚è€ƒã«ãªã‚‹ã®ã§ã€ä¸€æ—¦è¦šãˆã¨ã„ãŸã»ã†ãŒã„ã„ã¨æ€ã„ã¾ã™ã€‚\n>5)ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚‰ã€C:\\Program Files (x86)\\MeCab\\dic\\ipadicã«char.binã€dicrcã€matrix.binã€sys.dicã€unk.dicã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒæœ‰ã‚Œã°å•é¡ŒãŒãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚\n\n### 2.ç’°å¢ƒå¤‰æ•°ã®PATHã«è¿½åŠ \n>C:\\Program Files (x86)\\MeCab\\binã‚’ç’°å¢ƒå¤‰æ•°ã®PATHã«è¿½åŠ ã—ã¾ã™ã€‚\n\n### 3.Anaconda jupyterä¸Šã®mecabã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹\nä»¥ä¸‹ã„ãã¤ã‹ã®æ–¹æ³•ã©ã‚Œã§ã‚‚è¡Œã‘ã‚‹ã¨æ€ã„ã¾ã™ã€‚\n>pip install mecab\n>pip install mecab-python-windows(python3.7&ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³)\n>pip install mecab-python3(python3.8ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³)\n\n### 4.libmecab.dllï¼ˆå¿…é ˆã§ã¯ãªã„ã‹ã‚‚ï¼‰\n>1)MeCabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®libmecab.dll(è‡ªåˆ†ã¯**C:\\Program Files (x86)\\MeCab\\bin\\libmecab.dll**)ã‚’(Anacondaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆ)/Lib/site-packages(è‡ªåˆ†ã®ã¯**D:\\anaconda\\envs\\mecab\\Lib\\site-packages**)ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹\n>2)ãŸã å¶ç„¶ã«site-packageså†…ã®libmecab.dllã‚’å‰Šé™¤ã—ãŸã¨ã—ã¦ã‚‚ã€ç‰¹ã«ã‚¨ãƒ©ãƒ¼ç”Ÿã˜ã¦ãªã‹ã£ãŸã®ã§ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã„ã‚‰ãªã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­ã€‚\n\n### 5.NEologdè¾æ›¸ã®ç™»éŒ²\n#### A.NEologdã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n>1)[NEologd](https://github.com/neologd/mecab-ipadic-neologd)\n>2)ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããŸNEologdã«(\\mecab-ipadic-neologd\\seed)ã„ãã¤ã‹ã®csvåœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚\n>3)csvã®åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã¾ã™ã€‚\n\n<div style=\"width:70%;margin:auto\">{% asset_img NEologd_xz.png NEologd_xz%}</div>\n\n>csvãƒ•ã‚¡ã‚¤ãƒ«ã®è§£å‡ã¯è‰²ã€…æ–¹æ³•ãŒã‚ã‚Šã¾ã™ãŒã€è‡ªåˆ†ã¯ä»¥ä¸‹ã®æ–¹æ³•ã§è¡Œã„ã¾ã—ãŸã€‚\n\n\timport lzma\n\timport shutil\n\timport os\n\n\tfiles = []\n\tfor root,dirs,file in os.walk(r'ã€‡ã€‡\\MeCab\\mecab-ipadic-neologd\\seed'): #csv.xzæ‰€åœ¨ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\n\t    files.append(file)\n\tfor i in files[0]:\n    input_file = './mecab-ipadic-neologd/seed/'+i\n    destination_dir = 'C:/Users/jorey/python/'\n    with lzma.open(input_file,'rb') as readfile:\n        with open(destination_dir+i.split('.xz')[0],'wb') as writefile:\n            data = readfile.read()\n            while data:\n                writefile.write(data)\n                data = readfile.read()\n\n<div style=\"width:40%;margin:auto\">{% asset_img NEologd_xz_csv.png NEologd_xz_csv%}</div>\n\n#### B.NEologdè¾æ›¸ã®ç™»éŒ²\n>1)Anaconda Promptã‚’é–‹ãã€ï¼activate mecabï¼ˆmecabã¯Anacondaä¸Šã§ä½¿ç”¨ã—ã¦ã„ã‚‹ç’°å¢ƒã®åå‰ã§ã™ã€‚ï¼‰ã‚’æ‰“ã£ã¦ã€Anacondaç’°å¢ƒã«å…¥ã‚‹\n>2)csvãƒ•ã‚¡ã‚¤ãƒ«æ‰€åœ¨ã—ã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ï¼ˆè‡ªåˆ†ã®ã¯**C:\\Users\\ã€‡ã€‡Desktop\\MeCab\\dic\\mecab-ipadic-neologd\\seed**ã§ã™ï¼‰\n>3)ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’æ‰“ã¤ã¨ã€csvãƒ•ã‚¡ã‚¤ãƒ«ã‚’dicè¾æ›¸ã«ä½œæˆã™ã‚‹\n>>1_:C:\\Program Files (x86)\\MeCab\\bin\\mecab-dict-index.exeã¯dicè¾æ›¸ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®tool\n>>2_:C:\\Program Files (x86)\\MeCab\\dic\\ipadicã¯Mecabä¸Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ã‚‹ãƒ•ã‚¡ãƒ«ãƒ€\n>>3_:ã€‡ã€‡.dic ã€‡ã€‡.csvã¯ã©ã†ã„ã†csvãƒ•ã‚¡ã‚¤ãƒ«ã‚’dicè¾æ›¸ã«ä½œæˆã™ã‚‹ã‹ã‚’æŒ‡å®šã™ã‚‹\n>>4_:-f utf-8 ã¯csvãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã€€(NEologdè¾æ›¸ã®csvã‚’è§£å‡ã—ãŸã‚‰utf-8ã«ãªã‚‹ã®ã§ã€ã“ã“ã‚‚utf-8ã«æŒ‡å®šã—ã¾ã—ãŸ)\n>>5_:-t utf-8 ã¯è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼ˆMecabã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ãè‡ªåˆ†ã¯utf-8ã‚’é¸ã‚“ã ã®ã§ã€ã“ã“utf-8ã«æŒ‡å®šã—ã¾ã—ãŸï¼‰\n>>6_:ç°¡å˜ã«ã¾ã¨ã‚ã¦ã„ã†ã¨ã€ã€mecab-dict-index -f <csvãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰> -t <è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰>ã€‘ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã­\n\n\t\"C:\\Program Files (x86)\\MeCab\\bin\\mecab-dict-index.exe\" -d â€œC:\\Program Files (x86)\\MeCab\\dic\\ipadicâ€ -u ã€‡ã€‡.dic -f utf-8 -t utf-8 ã€‡ã€‡.csv\n>4)C:\\Program Files (x86)\\MeCab\\dicã®ä¸‹ã«NEologdã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã™ã‚‹ã€‚\n>ä¸Šè¨˜ä½œæˆã§ããŸã€‡ã€‡.dicè¾æ›¸(ä¾‹ï¼šmecab-user-dict-seed.20200910.dic)ã‚’C:\\Program Files (x86)\\MeCab\\dic\\NEologdã«å…¥ã‚Œã‚‹ã€‚\n\n<div style=\"width:70%;margin:auto\">{% asset_img NEologd_dic.png NEologd_dic%}</div>\n\n####ã€€C.mecabrcã‚’ä¿®æ­£\n>1)C:\\Program Files (x86)\\MeCab\\etcå†…ã®mecabrcã‚’é–‹ãã€ä»¥ä¸‹2è¡Œã‚’è¿½åŠ ã—ã¾ã™ã€‚(;ã¨ç©ºç™½ãªã—)\n>2)ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚ã‚‹dicdirã¨userdicã®2è¡Œã‚’æ¶ˆã™ã‹ã€è¡Œé ­ã«;ã‚’æ¶ˆã›ã‚Œã°ã„ã„ã¨æ€ã„ã¾ã™ã€‚\n>3)userdicè¤‡æ•°è¿½åŠ ã—ãŸã„å ´åˆã€','ã‚’ä½¿ã£ã¦è¤‡æ•°è¿½åŠ ã™ã‚Œã°å¤§ä¸ˆå¤«ã§ã™ã€‚\t\n\n\t; dicdir =  $(rcpath)\\..\\dic\\ipadic\n\t; userdic = /home/foo/bar/user.dic\n\tdicdir = C:\\Program Files (x86)\\MeCab\\dic\\ipadicã€€\n\tuserdic = C:\\Program Files (x86)\\MeCab\\dic\\NEologd\\mecab-user-dict-seed.20200910.dic #ç”Ÿæˆã—ãŸdicãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\n\t#è¤‡æ•°è¿½åŠ ã—ãŸã„å ´åˆ\n\tuserdic = C:\\Program Files (x86)\\MeCab\\dic\\NEologd\\mecab-user-dict-seed.20200910.dic,C:\\Program Files (x86)\\MeCab\\dic\\NEologd\\neologd-adjective-exp-dict-seed.20151126.dic\n\n####ã€€D.Anacondaã§Jupyter Notebookã‚’é–‹ãã€ç¢ºèª\n>MeCab.Tagger()ã«\"-r C:\\Program Files (x86)\\MeCab\\etc\\mecabrc\"ãã®ã¾ã¾å…¥åŠ›ã—ãŸã‚‰æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚\n>>â‘ \\ã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—æ–‡å­—ã«èªè­˜ã•ã‚Œã¦ã—ã¾ã†ã‚‰ã—ã„ã®ã§ã€\\ã‚’/ã¾ãŸã¯\\\\\\ã«å¤‰æ›´ã™ã‚‹å¿…è¦ã‚ã‚Šã¾ã™ã€‚\n>>â‘¡MeCabã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ç©ºç™½ãŒå…¥ã£ã¦ã—ã¾ã†ã¨èªè­˜ã—ã¾ã›ã‚“.Program Files (x86)Niç©ºç™½å…¥ã£ã¦ã—ã¾ã£ã¦ã‚‹ã®ã§ã€ã“ã“mecabrcã‚’desktopã«ç§»å‹•ã—ãŸã‚‰ã€æ©Ÿèƒ½ã—ã¾ã—ãŸã€‚\n\n\timport MeCab\n\ttagger = MeCab.Tagger('-r C:/Users/jorey/Desktop/mecabrc')\n\tprint(tagger.parse('ä¸­å³¶è£•ç¿”'))\n\t##ä¸­å³¶è£•ç¿”\tåè©,å›ºæœ‰åè©,äººå,ä¸€èˆ¬,*,*,ä¸­å³¶è£•ç¿”,ãƒŠã‚«ã‚¸ãƒãƒ¦ã‚¦ãƒˆ,ãƒŠã‚«ã‚¸ãƒãƒ¦ã‚¦ãƒˆ\n\tEOS\n\n### 6.ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã®ç™»éŒ²\n#### A.ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã®ä½œæˆ\n>ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã®ä½œæˆã«é–¢ã—ã¦ã¯ã€ã“ã¡ã‚‰ã®è¨˜äº‹ã§ã¯ç´°ã‹ãè¨˜è¼‰ã—ã¾ã—ãŸã®ã§ã€çµæ§‹å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚\n>>[ã‚¨ãƒ³ãƒˆãƒªã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ (æ´»ç”¨ã—ãªã„èª)](http://taku910.github.io/mecab/dic.html)\n>>[Windowsç’°å¢ƒã§MeCabã®ãƒ¦ãƒ¼ã‚¶è¾æ›¸ã«å˜èªã‚’è¿½åŠ ã™ã‚‹](https://ameblo.jp/lucifep2525/entry-12406376509.html)\n\n\tè¡¨å±¤å½¢,å·¦æ–‡è„ˆID,å³æ–‡è„ˆID,ã‚³ã‚¹ãƒˆ,å“è©,å“è©ç´°åˆ†é¡1,å“è©ç´°åˆ†é¡2,å“è©ç´°åˆ†é¡3,æ´»ç”¨å‹,æ´»ç”¨å½¢,åŸå½¢,èª­ã¿,ç™ºéŸ³\n\t#è‡ªåˆ†ã®:\n\tä½•åº¦ã‚‚,*,*,20,åè©,å›ºæœ‰åè©,åè©,*,*,*,ä½•åº¦ã‚‚,ãƒŠãƒ³ãƒ‰ãƒ¢,ãƒŠãƒ³ãƒ‰ãƒ¢\n\té¢¨æ¯,*,*,20,åè©,å›ºæœ‰åè©,äººå,ä¸€èˆ¬,*,*,é¢¨æ¯,ãƒ•ãƒ¼ã‚·ãƒ¼,ãƒ•ãƒ¼ã‚·ãƒ¼\n>ä¿å­˜ã™ã‚‹ã¨ãã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®é¸ã³ã¯å¾Œã»ã©dictä½œæˆã™ã‚‹ã¨ãå¿…è¦ãŒã‚ã‚‹ã®ã§ã€ãƒ¡ãƒ¢ã—ã¨ã„ãŸã»ã†ãŒã„ã„ã¨æ€ã„ã¾ã™ã€‚\n\n<div style=\"width:50%;margin:auto\">{% asset_img user_foo.png user_foo%}</div>\n\n#### B.ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸csvã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸dicã«ä½œæˆã™ã‚‹\n>ã‚„ã‚Šæ–¹ã¯**5.NEologdè¾æ›¸ã®ç™»éŒ²>B.NEologdè¾æ›¸ã®ç™»éŒ²**ã¨ä¸€ç·’ã§ã™ã€‚\n\n\t\"C:\\Program Files (x86)\\MeCab\\bin\\mecab-dict-index.exe\" -d â€œC:\\Program Files (x86)\\MeCab\\dic\\ipadicâ€ -u foo.dic -f utf-8 -t utf-8 foo.csv\n<div style=\"width:50%;margin:auto\">{% asset_img foo_dic.png foo_dic%}</div>\n\n#### C.mecabrcã«ãƒ‘ã‚¹è¿½åŠ \n>ã‚„ã‚Šæ–¹ã¯**5.NEologdè¾æ›¸ã®ç™»éŒ²>C.mecabrcã‚’ä¿®æ­£**ã¨ä¸€ç·’ã§ã™ã€‚\n\n\t; dicdir =  $(rcpath)\\..\\dic\\ipadic\n\t; userdic = /home/foo/bar/user.dic\n\n\tdicdir = C:\\Program Files (x86)\\MeCab\\dic\\ipadic-utf8\n\tuserdic = C:\\Program Files (x86)\\MeCab\\dic\\NEologd\\mecab-user-dict-seed.20200910.dic,C:\\Program Files (x86)\\MeCab\\dic\\userdic\\foo.dic\n\n### 7.Anacondaã§ç¢ºèª\n>ã“ã†ã—ã¦Anacondaä¸Šã§ã‚‚ç™»éŒ²ã—ãŸNEologdè¾æ›¸ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãŒåæ˜ ã•ã‚ŒãŸã¨ç¢ºèªã§ãã¾ã—ãŸã€‚\n>ã“ã¡ã‚‰ã‚’ç”¨ã„ã¦ã€è‰²ã€…ã®è‡ªç„¶è¨€èªå‡¦ç†ã«ã¦æ´»ç”¨ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n<div style=\"width:60%;margin:auto\">{% asset_img jupyter_end.png jupyter_end%}</div>\n\n\n\n\n\n\n\n\n","tags":["è‡ªç„¶è¨€èªå‡¦ç†","MeCab","ä»–äººè¨˜äº‹å‚ç…§"],"categories":["æ—¥ã€…ã®ç©ã¿ä¸Šã’"]},{"title":"paddlepaddleã‚’ä½¿ã£ã¦å†™çœŸã®èƒŒæ™¯ã‚’åˆ‡ã‚Šæ¨ã¦ã‚‹","url":"/Jorey-s-Blog/2021/01/16/05_paddlehub/","content":"\n\n<!-- toc -->\n---------------\n## 1.deeplabv3p_xception65_humanseg\n<font size=3>\n\n>å†™çœŸã®ä¸»ä½“ã ã‘ã‚’åˆ‡ã‚ŠæŠœãã€ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã®èƒŒæ™¯ã«ã—ãŸã„ã¨æ€ã„ã€Baiduã®ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ã¦ã¿ã¾ã—ãŸã€‚\n>ä»Šå›ã¯deeplabv3p_xception65_humansegã¨ã„ã†ãƒ¢ãƒ‡ãƒ«ã®ã¿ä½¿ã£ã¦ã¿ã¾ã—ãŸãŒã€paddlepaddleã«ã¯NLPãƒ¢ãƒ‡ãƒ«ã€ç”»åƒå‡¦ç†ãƒ¢ãƒ‡ãƒ«ã€éŸ³å£°èªè­˜ãƒ¢ãƒ‡ãƒ«ç­‰æ§˜ã€…å…¥ã£ã¦ã„ã‚‹ã®ã§ã€ä»Šå¾Œè‰²ã€…è©¦ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n>ä»Šå›ã®å‡¦ç†å¯¾è±¡å†™çœŸã¯ä»¥ä¸‹ã®5æšã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚\n>>å‹•ç‰©ç³»ã®é»’çŒ«ã§ã‚ã‚‹ç¾…å°é»’ã€äººé–“å§¿ã«ãªã£ãŸç¾…å°é»’ã€äººé–“ã§ã¯ã‚ã‚‹ãŒã€ãƒã‚¤ãƒã‚¤ã—ã¦ã„ã‚‹å¾Œã‚å§¿ã—ã‹è¦‹ã›ã¦ã„ãªã„ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ã®å¸«åŒ ã§ã‚ã‚‹ãƒ ã‚²ãƒ³ã€éŒ¦æˆ¸äº®ã®é€²åŒ–ã—ãŸæˆäººçŠ¶æ…‹ã¨ç‹é“ã®ã¡ã³äº®æ™‚æœŸ\n\n</font>\n\n<div style=\"width:100%;margin:auto\">{% asset_img object.png object%}</div>\n<!-- more -->\n<!-- --------------- -->\n<font size=3>ã¾ãšå¿…è¦ãªã‚‚ã®ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹</font>\n\n\tpython -m pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple\n\t#paddlepaddle 1.8.5 requires opencv-python<=4.2.0.32\n\n\tpip install -i https://mirror.baidu.com/pypi/simple paddlehub\n\n<font size=3>ä»¥ä¸Šç„¡äº‹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‚‰ã€paddlepaddleã®paddlehubãƒ„ãƒ¼ãƒ«ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹</font>\n\t\n\timport os, paddlehub as hub\n\n\t#ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹\n\thuseg = hub.Module(name = 'deeplabv3p_xception65_humanseg')\n\n\t#ç”¨æ„ã—ãŸå†™çœŸã‚’imgã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã«æ ¼ç´ã—ã¦ã„ã‚‹\n\tpath = r'./img/'\n\tfiles = [path +i for i in os.listdir(path)]\n\n\t#visualization=Falseã«ãªã‚‹å ´åˆã€ç”»åƒãŒç”Ÿæˆã—ã¦ãã‚Œãªã„ã®ã§ã€è¦æ³¨æ„\n\tresult = huseg.segmentation(data = {'image':files},visualization=True,output_dir=path)\n\n<font size=3>\n\n>çµæœã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\n>äººé–“ã®é¡”ãŒã‚ã‚‹ã¨ã€ç²¾åº¦ãŒã¾ã‚ã¾ã‚è‰¯ã„ã§ã™ãŒã€çŒ«ã®é¡”ãŒå…¨ç„¶ç„¡ç†ã§ã—ãŸã­ã€‚\n\n</font>\n<div style=\"width:100%;margin:auto\">{% asset_img result_array.png result_array%}</div>\n<div style=\"width:100%;margin:auto\">{% asset_img object_ed.png object_ed%}</div>\n\n## github\n[paddlepaddle model github](https://github.com/PaddlePaddle/models)\n[paddlepaddle github](https://github.com/PaddlePaddle/Paddle)\n\n\n","tags":["ç”»åƒå‡¦ç†"],"categories":["ç”»åƒå‡¦ç†"]},{"title":"2021å¹´1æœˆSQLç·´ç¿’èª²é¡Œå›ç­”","url":"/Jorey-s-Blog/2021/01/12/2021å¹´1æœˆSQLç·´ç¿’èª²é¡Œå›ç­”/","content":"\nèª¬æ˜ï¼šSQLã®æ“ä½œã¯psycopg2ã‚’ä½¿ã£ã¦ã€Pythonä¸Šã§ã®æ“ä½œã‚’è¡Œã„ã¾ã—ãŸã€‚\n\n<!-- toc -->\n---------------\n### 1.2021å¹´1æœˆ12æ—¥\n>å‹‰å¼·ã—ãŸSQLæ§‹æ–‡:\n>>OVER(PARTITION BY column1 ORDER BY column2)\n\n<font size=3>â‘ ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥</font>\n\n\t%%sql\n\tCREATE TABLE T0104(\n\t\tID INT,\n\t\tNAME VARCHAR(10),\n\t\tNUM INT)\n\tINSERT INTO T0104 VALUES(1,'A',1);\n\tINSERT INTO T0104 VALUES(2,'A',2);\n\tINSERT INTO T0104 VALUES(3,'A',6);\n\tINSERT INTO T0104 VALUES(4,'A',4);\n\tINSERT INTO T0104 VALUES(5,'A',3);\n\tINSERT INTO T0104 VALUES(6,'B',2);\n\tINSERT INTO T0104 VALUES(7,'B',8);\n\tINSERT INTO T0104 VALUES(8,'B',2);\n<div style=\"width:70%;margin:auto\">{% asset_img 20200104_1.png 20200104_1%}</div>\n<!-- more -->\n<font size=3>â‘¡æ¡ä»¶ã‚’è¨­å®šã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’çµã‚Šè¾¼ã‚€</font>\n\n\t%%sql\n\n\tselect A.id,A.name,A.num from(\n    select T.ID,T.NAME,T.NUM,\n    sum(NUM) OVER(PARTITION BY NAME ORDER BY ID)*1.0 a,\n    sum(NUM) OVER(PARTITION BY NAME ORDER BY ID) *1.0 b,\n    sum(NUM) OVER(PARTITION BY NAME)*1.0 c from T0104 as T\n    ) A\n    where A.a/A.c > 0.6;\n<div style=\"width:70%;margin:auto\">{% asset_img 20200104_2.png 20200104_2%}</div>\n\n### 2.2021å¹´1æœˆ13æ—¥\n>å‹‰å¼·ã—ãŸSQLæ§‹æ–‡:\n>>1.column1ã‚’ã‚‚ã¨ã«åˆ†å‰²ã—ã€column2ã‚’ã‚‚ã¨ã«ãã‚Œãã‚Œé †ç•ªãã‚ãˆã¦ã€é †ä½ã‚’æ–°ã—ã„åˆ—ã«ã¤ã‘ã¦è¡Œã\n>>>row_number() over(partion column1 order by column2)\n\n>>2.coalesceé–¢æ•°\n>>>coalesce(A,B,C...):()ã®ä¸­ã«ä¸€ã¤ã®éNULLã®å€¤ãŒå‡ºåŠ›ã•ã‚Œã‚‹\n>>>å‚è€ƒè¨˜äº‹:[CASEå¼ã§æ¡ä»¶åˆ†å²ã‚’SQLæ–‡ã«ä»»ã›ã‚‹](https://qiita.com/sfp_waterwalker/items/acc7f95f6ab5aa5412f3)\n\n>>3.æ¡ä»¶åˆ†å²æ§‹æ–‡:æ¤œç´¢caseå¼\n\n\tcase \n\t\twhen column1 = '' then çµæœ1\n\t\twhen column1 = '' then çµæœ2\n\t\telse â—â—\n\tEND\n\n<font size=3>â‘ ã¾ãšæ¡ä»¶åˆ†å²ã§æ­£è² ã®æ¤œç´¢çµæœã‚’ã¤ã‘ã¦ã„ãã€ã‚³ãƒ¼ãƒ‰ã”ã¨ã«é †ç•ªä¸¦ã¶</font>\n\n\t%%sql\n\tSELECT *,\n\tcase when é‡‘é¡ç›¸é•å€¤ >= 0 then 'æ­£'\n\t    when é‡‘é¡ç›¸é•å€¤ < 0 then 'è² '\n\t        else '' end as å¢—é•·æ–¹å‘,\n\t        row_number() over(partition by ã‚³ãƒ¼ãƒ‰ order by æ—¥ä»˜) rn from T0113\n<div style=\"width:70%;margin:auto\">{% asset_img 20210113_1.png 20210113_1%}</div>\nã€€\n<font size=3>â‘¡ä¸Šè¨˜çµæœã‚’ã¾ã‚‹ã”ã¨uã«ã—ã€a,bã¨ã„ã†åã‚’ã¤ã‘ã¦ã€åŒã˜ã‚³ãƒ¼ãƒ‰ & bã®rnåˆ—ã¯aã®rnã‚ˆã‚Šå€¤ãŒä½ã„ & å¢—é•·æ–¹å‘ãŒå¤‰æ›´ã—ãŸç¯€ç‚¹ã¨ã„ã†ä¸‰ã¤æ¡ä»¶ãŒæº€è¶³ã—ãŸè¡Œã‚’çµã‚Šè¾¼ã¿ã€é™é †ã—ãŸç¬¬ä¸€è¡Œç›®ã‚’æŠ½å‡ºã™ã‚‹</font>\n\n\t%%sql\n\tselect b.rn from u b\n\twhere b.ã‚³ãƒ¼ãƒ‰ = a.ã‚³ãƒ¼ãƒ‰\n\tand b.rn<a.rn\n\tand b.å¢—é•·æ–¹å‘ != a.å¢—é•·æ–¹å‘\n\torder by b.rn desc limit 1\n\n<font size=3>â‘¢ä¸Šè¨˜æ¡ä»¶ã‚’æº€è¶³ã•ã‚Œãªã„è¡Œã«é–¢ã—ã¦ã¯ã€nullå€¤ã«ãªã‚‹ã®ã§ã€coalesceé–¢æ•°ã§nullå€¤ã‚’0ã«å¤‰æ›´ã—ã€aã®rnè¡Œã¨å¼•ãç®—ã‚’è¡Œã„ã€é€£ç¶šå¢—é•·æ—¥æ•°ã¨ã„ã†æ–°ã—ã„ä¸€åˆ—ã«ã™ã‚‹ã€‚</font>\n\n\tselect æ—¥ä»˜,ã‚³ãƒ¼ãƒ‰,é‡‘é¡,é‡‘é¡ç›¸é•å€¤,å¢—é•·æ–¹å‘,\n    a.rn - coalesce((select b.rn from u b\n                    where b.ã‚³ãƒ¼ãƒ‰ = a.ã‚³ãƒ¼ãƒ‰\n                    and b.rn<a.rn\n                    and b.å¢—é•·æ–¹å‘ != a.å¢—é•·æ–¹å‘\n                    order by b.rn desc limit 1),0) \"é€£ç¶šå¢—é•·æ—¥æ•°\" from u a                   \n\n<font size=3>â‘£å®Œæˆç‰ˆã¨çµæœã¯ä»¥ä¸‹ã®é€šã‚Š</font>           \n\n\t%%sql\n\twith u as\n\t(SELECT *,\n\tcase when é‡‘é¡ç›¸é•å€¤ >= 0 then 'æ­£'\n\t    when é‡‘é¡ç›¸é•å€¤ < 0 then 'è² '\n\t        else '' end as å¢—é•·æ–¹å‘,\n\t        row_number() over(partition by ã‚³ãƒ¼ãƒ‰ order by æ—¥ä»˜) rn \n\t from T0113)\n\tselect æ—¥ä»˜,ã‚³ãƒ¼ãƒ‰,é‡‘é¡,é‡‘é¡ç›¸é•å€¤,å¢—é•·æ–¹å‘,\n\t    a.rn - coalesce((select b.rn from u b\n\t                    where b.ã‚³ãƒ¼ãƒ‰ = a.ã‚³ãƒ¼ãƒ‰\n\t                    and b.rn<a.rn\n\t                    and b.å¢—é•·æ–¹å‘ != a.å¢—é•·æ–¹å‘\n\t                    order by b.rn desc limit 1),0) \"é€£ç¶šå¢—é•·æ—¥æ•°\" from u a\n\n<div style=\"width:70%;margin:auto\">{% asset_img 20210113_2.png 20210113_2%}</div>\t\n\n### 3.2021å¹´1æœˆ16æ—¥\n\n\tselect å•†å“,æ—¥ä»˜,sum(å˜ä¾¡*å€‹æ•°)/sum(å€‹æ•°) as å¹³å‡å˜ä¾¡ \n\tfrom (select *, \n\tdense_rank() OVER(PARTITION BY å•†å“ ORDER BY æ—¥ä»˜) from T0116)as a\n\twhere dense_rank = 1\n\tgroup by å•†å“,æ—¥ä»˜;\n\n<div style=\"width:70%;margin:auto\">{% asset_img 20210116.png 20210116%}</div>\n\n### 4.2021å¹´1æœˆ17æ—¥\n>å‹‰å¼·ã—ãŸSQLæ§‹æ–‡:\n>>CONCATã‚’ä½¿ã£ã¦ã€æ•°å­—å‹ã¨æ–‡å­—å‹ã®çµåˆç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã‚’çµåˆã—ãŸã„\n>>>å‚è€ƒè¨˜äº‹ï¼š[SQL æ–‡å­—åˆ—çµåˆãƒ¡ãƒ¢](https://qiita.com/Sammy_U/items/5498b93ff77d52c7e8fb)\n\n<font size=3>â‘ ã¾ãšover()é–¢æ•°ã‚’ä½¿ã£ã¦ã‚³ãƒ¼ãƒ‰ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã‚’è¡Œã„ã€é †ä½ã‚’ã¤ã‘ã‚‹</font> \n\n\tselect *,row_number() over(PARTITION by L order by x) as m from T0117\n<div style=\"width:100%;margin:auto\">{% asset_img 20210117_1.png 20210117_1%}</div>\n<font size=3>â‘¡ã¤ã‘ãŸé †ä½ã‚’ã‚‚ã¨ã«ã€ã•ã‚‰ã«ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã‚’è¡Œã†</font>\n\n\tselect *,x-row_number() over(PARTITION by L order by x) as m from T0117 \n<div style=\"width:100%;margin:auto\">{% asset_img 20210117_2.png 20210117_2%}</div>\n<font size=3>â‘¢ãŠé¡Œã®æ±‚ã‚ãŸé€šã‚Šã€ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«æœ€å°å€¤ã€æœ€å¤§å€¤ã®é–“ã«'ãƒ¼'ã‚’ã¤ã‘ã‚‹</font> \n\n\tconcat((min(x),'-',max(x)))\n<font size=3>â‘£ã¾ã¨ã‚ã‚‹</font>\n\n\tselect l,concat(min(x),'-',max(x)) as y from \n\t(select *,x-row_number() over(PARTITION by L order by x) as m from T0117\n\t) as a\n\tgroup by l,m; \n<div style=\"width:100%;margin:auto\">{% asset_img 20210117_3.png 20210117_3%}</div>\n\n### 5.2021å¹´1æœˆ21æ—¥\n>å‹‰å¼·ã—ãŸSQLæ§‹æ–‡:\n>>DATEã‹ã‚‰å¹´æœˆã®ã¿ã‚’å–å¾—\n>>>å‚è€ƒè¨˜äº‹[æ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ã‚’ä»»æ„ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§åˆ‡ã‚Šæ¨ã¦ã‚‹é–¢æ•°(DATE_TRUNCé–¢æ•°)](http://vertica-tech.ashisuto.co.jp/date_trunc/)\n\n<font size=3>â‘ å¾Œã»ã©æ¡ä»¶åˆ¤å®šã‚’è¡Œãˆã‚‹ãŸã‚ã€DATEã‹ã‚‰å¹´æœˆã®ã¿ã‚’å–å¾—</font>\n\t\n\tselect *,to_char(mon,'YYYY-MM') as MONTH from T0121;\n<div style=\"width:80%;margin:auto\">{% asset_img 20210121_1.png 20210121_1%}</div>\n<font size=3>â‘¡åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€åŒã˜æœˆã®è¡Œã‚’é¸ã³å‡ºã—ã€é‡‘é¡/ã‚«ã‚¦ãƒ³ãƒˆã§çµæœå¾—ã‚‹</font>\n\n\twith u as\n\t(select *,to_char(mon,'YYYY-MM') as MONTH from T0121)\n\tselect id,name,month,state,amount/(select count(*) from u as b \n\t                                 where a.month=b.month\n\t                                 and b.name = a.name) as number\n\tfrom u as a;\n<div style=\"width:80%;margin:auto\">{% asset_img 20210121_2.png 20210121_2%}</div>\n\n### 6.2021å¹´1æœˆ25æ—¥\n>â‘ [ãƒ‡ãƒ¼ã‚¿å‹æ›¸å¼è¨­å®šé–¢æ•°](https://www.postgresql.jp/document/9.4/html/functions-formatting.html)\n>>postgresql:to_char([å…ƒåˆ—å], 'YYYY-MM-DD HH24:MI')\n>>mysqlãªã‚‰:date_format([å…ƒåˆ—å], '%Y-%m-%d %H:%i') \n\n>â‘¡join[çµåˆãƒ†ãƒ¼ãƒ–ãƒ«](https://www.postgresql.jp/document/9.1/html/queries-table-expressions.html)\n\n>**â‘¢with asä½¿ã„ã™ãã‚‹ã¨ãƒ¡ãƒ¢ãƒªãŒé£Ÿã‚ã‚Œã‚„ã™ã„ã®ã§ã€è¦æ³¨æ„**\n\n<font size=3>â‘ ãƒ‡ãƒ¼ã‚¿ã®å‹ã‚’ãŠé¡Œé€šã‚Šã«æƒãˆã‚‹</font>\n\n\tselect *,to_char(TransTime,'YYYY-MM-DD HH24:MI') as TransTimed from T0125;\t\n<div style=\"width:80%;margin:auto\">{% asset_img 20210125_1.png 20210125_1%}</div>\n<font size=3>â‘¡å¾Œã»ã©ã®ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã®ãŸã‚opcodeã”ã¨ã«é †ä½ã‚’ä»˜ã‘ã¦ã„ã</font>\n\n\twith u as\n\t(select *,to_char(TransTime,'YYYY-MM-DD HH24:MI') as TransTimed from T0125)\n\tselect *,row_number() over(PARTITION BY opcode order by transtimed) as rn from u;\n<div style=\"width:80%;margin:auto\">{% asset_img 20210125_2.png 20210125_2%}</div>\n<font size=3>â‘¢æ¬¡ã®è¡Œã‚’ä¸€å€‹ä¸Šã«æŒã¡ä¸Šã’ã„ãã€ãã‚Œãã‚Œã®transtimeã‚’starttimeã¨endtimeã«è¨­å®šã™ã‚‹ã€‚transtypeã¯å¾Œã»ã©æ–‡å­—åˆ—ã®çµåˆã‚’ã™ã‚‹ãŸã‚ã€æ–°ã—ã„åˆ—ã‚’ä½œã‚‹ã€‚</font>\n\n\twith uu as\n\t(with u as\n\t(select *,to_char(TransTime,'YYYY-MM-DD HH24:MI') as TransTimed from T0125)\n\tselect *,row_number() over(PARTITION BY opcode order by transtimed) as rn from u)\n\tselect a.transtype as transtype_1,b.transtype as transtype_2,a.oprseq,a.opcode,a.rn,\n\ta.transtimed as starttime,b.transtimed as endtime from uu as a\n\t    left join uu as b\n\t        on b.opcode=a.opcode\n\t            and b.rn = a.rn+1;\n<div style=\"width:80%;margin:auto\">{% asset_img 20210125_3.png 20210125_3%}</div>\n<font size=3>â‘£å¥‡æ•°åˆ—ã®ã¿æ®‹ã‚Š(where a.rn %2!=0)ã€transtypeã®ï¼’åˆ—ã‚’çµåˆã—ã€ãŠé¡ŒãŒæ±‚ã‚ã‚‹åˆ—ã®ã¿ã‚’æŠ½å‡ºã™ã‚‹</font>\n\n\twith result as\n\n\t(with uu as\n\t \n\t(with u as\n\t(select *,to_char(TransTime,'YYYY-MM-DD HH24:MI') as TransTimed from T0125)\n\t \n\tselect *,row_number() over(PARTITION BY opcode order by transtimed) as rn from u)\n\t \n\tselect a.transtype as transtype_1,b.transtype as transtype_2,a.oprseq,a.opcode,a.rn,\n\t a.transtimed as starttime,b.transtimed as endtime from uu as a\n\t     left join uu as b\n\t         on b.opcode=a.opcode\n\t         and b.rn = a.rn+1\n\twhere a.rn %2!=0)\n\n\tselect concat(result.transtype_1,'-',result.transtype_2) as transtype,result.oprseq,result.opcode,result.starttime,result.endtime \n\tfrom result;\n<div style=\"width:80%;margin:auto\">{% asset_img 20210125_4.png 20210125_4%}</div>\n\n### 7.2021å¹´1æœˆ26æ—¥\n<font size=3>â‘ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã™ã‚‹</font>\n~~~\ncreate table T0126A\n(id serial,\nspmc VARCHAR(100),\nåˆ†é…é‡ NUMERIC(18,4));\n\ninsert into T0126A(spmc,åˆ†é…é‡) values\n('A',80),\n('B',100);\n\ncreate table T0126B\n(id serial,\nspmc VARCHAR(100),\nè³¼å…¥é‡ NUMERIC(18,4));\n\ninsert into T0126B(spmc,è³¼å…¥é‡) values\n('A',20),\n('A',50),\n('A',40),\n('A',30),\n('B',120),\n('B',80),\n('B',100);\n~~~\n>ãƒã‚¤ãƒ³ãƒˆ1:**serial**\n- ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ—ã«ä¸€æ„ã®è­˜åˆ¥å­ã‚’è¨­å®šã™ã‚‹ç°¡ä¾¿ãªè¡¨è¨˜æ³•\n- integeråˆ—(æ•´æ•°åˆ—)ãŒä½œæˆã•ã‚Œã€ãã®åˆ—ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒé€£ç•ªæ•´æ•°ã‚’æŒ¯ã‚Šå½“ã¦ã‚‹\n- PostgreSQL7.3åŠã³ä»¥é™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€UNIQUEã¾ãŸã¯PRIMARY KEYã«ã—ãŸã„å ´åˆã€ä»–ã®ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨åŒæ§˜ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹\n- <u>**mysqlãªã‚‰AUTO_INCREMENT,Oracleãªã‚‰SEQUENCE(PostgreSQLã‚‚)**</u>ã§é€£ç•ªã‚’æ¡ç•ªã§ãã‚‹\n- æ›¸ãæ–¹\n\n\n\tCREATE TABLE tablename(\n\t\tcolumnname SERIAL);\n>>å‚è€ƒè¨˜äº‹:[ã‚·ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿å‹](https://www.postgresql.jp/document/7.3/user/datatype.html#DATATYPE-SERIAL)\n\n<font size=3>â‘¡spmcã”ã¨ã«ç´¯è¨ˆè³¼å…¥é‡ã‚’è¨ˆç®—ã™ã‚‹</font>\n~~~\nselect *, (select sum(è³¼å…¥é‡) from T0126B as B\n    where B.spmc=A.spmc\n          and B.id<= A.id) as sum_\n    from T0126B as A\n~~~\n<div style=\"width:80%;margin:auto\">{% asset_img 20210126-1.png 20210126-1%}</div>\n<font size=3>â‘¢T0126Bã®ç´¯è¨ˆè³¼å…¥é‡ãŒT0126Aã®ç·åˆ†é…é‡ã‚ˆã‚Šå°‘ãªã„å ´åˆã€ãã‚Œã¾ã§æ¯å›ã®è³¼å…¥é‡ãŒå…¨éƒ¨åˆ†é…ã•ã‚ŒãŸã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚ãã‚Œã«åã—ãŸå ´åˆã€ç´¯è¨ˆè³¼å…¥é‡ã¨ãã®å›ã®è³¼å…¥é‡ã®å·®ãŒç·åˆ†é…é‡ã‚ˆã‚Šå°‘ãªã„å ´åˆã€ãã®å›ã§ã¯ä¸€éƒ¨ã®è³¼å…¥é‡ãŒåˆ†é…ã•ã‚ŒãŸã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚ãã†ã§ã¯ãªã„å ´åˆã€ä½™ã£ãŸéƒ¨åˆ†ã¯åœ¨åº«é‡ã«ãªã‚‹</font>\n\n~~~\nwith T as(\n    select *, (select sum(è³¼å…¥é‡) from T0126B as B\n    where B.spmc=A.spmc\n          and B.id<= A.id) as sum_\n    from T0126B as A)\nselect t.spmc,t.è³¼å…¥é‡,\n(case when T.sum_ <= U.åˆ†é…é‡ then T.è³¼å…¥é‡ else \n     (case when (T.sum_-T.è³¼å…¥é‡)<U.åˆ†é…é‡ then U.åˆ†é…é‡-(T.sum_-T.è³¼å…¥é‡) else 0 end)\nend) as CW\nfrom T\ninner join T0126A as U\n    on t.spmc=U.spmc\n~~~\n<font size=3>â‘£åˆ—åã‚’ãŠé¡Œé€šã‚Šã«å¤‰æ›´ã™ã‚‹</font>\n~~~\nwith T as\n(select *, (select sum(è³¼å…¥é‡) from T0126B as B\n    where B.spmc=A.spmc\n          and B.id<= A.id) as sum_\n    from T0126B as A),\nV as\n(select t.spmc,t.è³¼å…¥é‡,\n(case when T.sum_ <= U.åˆ†é…é‡ then T.è³¼å…¥é‡ else \n     (case when (T.sum_-T.è³¼å…¥é‡)<U.åˆ†é…é‡ then U.åˆ†é…é‡-(T.sum_-T.è³¼å…¥é‡) else 0 end)\nend) as CW\nfrom T\ninner join T0126A as U\n    on t.spmc=U.spmc)\nselect spmc,V.è³¼å…¥é‡,V.cw as ä»Šå›ä½¿ç”¨é‡,(V.è³¼å…¥é‡-cw) as åœ¨åº«é‡ from V;\n~~~\n<div style=\"width:80%;margin:auto\">{% asset_img 20210126-2.png 20210126-2%}</div>\n","tags":["sql","å›ç­”"],"categories":["sql"]},{"title":"02.ç¾…å°é»’æˆ¦è¨˜ã®æ˜ ç”»ã‚³ãƒ¡ãƒ³ãƒˆã‚’åˆ†æã—ã¦ã¿ã‚ˆã†","url":"/Jorey-s-Blog/2021/01/08/02_luoxiaohei/","content":"\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/QmfU2NMCw8k\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\n<font size=3>è‡ªåˆ†ã®å¥½ããªã‚·ãƒªãƒ¼ã‚ºå‹•ç”»ã§ã‚ã‚‹ç¾…å°é»’æˆ¦è¨˜ã®ã‚¢ãƒ‹ãƒ¡æ˜ ç”»ç‰ˆã¯æ—¥æœ¬ã§ä¸Šæ˜ ã•ã‚ŒãŸã®ã§ã€\næ—¥æœ¬äººã®æ–¹ã‹ã‚‰ã“ã®å‹•ç”»ã‚’ã©ã†è¦‹ã¦ã„ã‚‹ã®ã‹ã‚’çŸ¥ã‚ŠãŸãã€ãƒãƒƒãƒˆä¸Šã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦åˆ†æã—ã¦ã¿ã¾ã—ãŸã€‚\nè‰¯ã„åˆ†æçµæœå¾—ã‚‰ã‚Œãªã‹ã£ãŸã§ã™ãŒã€ä»Šå›ã¨ã‚Šã‚ãˆãšã„ã‚ã„ã‚æ‰‹æ³•ã®ç·´ç¿’ã«ã—ã€ä»Šå¾Œã¯ä»Šå›ã®çµæœã‚’ã‚‚ã¨ã«ã€ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã¨ç²¾åº¦å‘ä¸Šã®ã»ã†ã«é€²ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚</font>\n\n<font size=3>**è©²å½“æ˜ ç”»ã‚³ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰ã§ã™â†“â†“â†“**</font>\n[<font size=3>Filmarksç¾…å°é»’æˆ¦è¨˜ ã¼ããŒé¸ã¶æœªæ¥ã®æ˜ ç”»æƒ…å ±ãƒ»æ„Ÿæƒ³ãƒ»è©•ä¾¡</font>>](https://filmarks.com/movies/86613)\n\n<!-- more -->\n---------------\n<!-- toc -->\n---------------\n### 1.ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°\n<font size=3.5>\n\n>ã¾ãšã‚µã‚¤ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãã¾ã—ãŸã€‚ã‚³ãƒ¡ãƒ³ãƒˆè‡ªä½“ã¯**ãƒã‚¿ãƒãƒ¬ã‚ã‚Š**ã€**ãƒã‚¿ãƒãƒ¬ãªã—**ã¨ã„ã†2ç¨®é¡ã«åˆ†ã‘ã‚‰ã‚ŒãŸã®ã§ã€ãã‚Œãã‚Œå–ã£ã¦ãã¾ã—ãŸã€‚\n\n</font>\n\n<font size=3>**â‘ ãƒã‚¿ãƒãƒ¬ãªã—ãƒ‡ãƒ¼ã‚¿ã®å–å¾—**</font>\n\t\n\tfrom selenium import webdriver\n\timport time\n\tbrowser = webdriver.Chrome()\n<font size=3>\n\n>ã‚µã‚¤ãƒˆã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã¦ã„ãã¨ã€2021å¹´1æœˆæ™‚ç‚¹ã€ãŠã‚ˆã300ãƒšãƒ¼ã‚¸ã»ã©ã‚ã‚Šã€ä¸€ãƒšãƒ¼ã‚¸ã¤ã¥10æœ¬ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§è‡ªå‹•çš„ã«ãƒšãƒ¼ã‚¸ã‚’ç¹°ã£ã¦å…¨éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã¨å¬‰ã—ã„ã§ã™ã­.\n>è‰²ã€…è¨˜äº‹ã‚’å‚è€ƒã—ã¦ã¾ã—ãŸãŒã€é›£ã—ã„ãã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ã‚Œã¦ã€ã„ã¾ã„ã¡ç†è§£ã§ããšãƒ»ãƒ»ãƒ»\nè‡ªåˆ†ãªã‚Šã«åœ°å‘³ã«è€ƒãˆãŸã®ã¯ï¼šæœ€çµ‚ãƒšãƒ¼ã‚¸æ•°ã‚’å–ã£ã¦ãã¦ã€Rangeé–¢æ•°ã‚’ä½¿ã£ã¦ã‚³ãƒ„ã‚³ãƒ„ã§é›†ã‚ã‚‹ã¨ã®ã‚„ã‚Šæ–¹ã§ã—ãŸã€‚\n>ã‚µã‚¤ãƒˆã®è¦ç´ ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€æœ€çµ‚ãƒšãƒ¼ã‚¸ã‚’ç¤ºã—ã¦ã„ã‚‹ **ã€>|ã€‘** ã¨ã„ã†å°ã¯ \nhref=\"/movies/86613?page=338\"ã§æŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ã€‚è¦ã™ã‚‹ã«ã€ã“ã“ã®338ã¨ã„ã†æ•°å­—ã¯æ±‚ã‚ã¦ã„ã‚‹æœ€çµ‚ãƒšãƒ¼ã‚¸æ•°ã§ã™ã­ï¼\n</font>>\n\n{% asset_img lastpage_href.png lastpage_href %}\n\n\tbrowser.get('https://filmarks.com/movies/86613/no_spoiler?page=1')\n\ttime.sleep(3)\n\n\tlinks = []\n\tfor link in browser.find_elements_by_xpath(\"//*[@href]\"):\n\t    if \"page\" in str(link.get_attribute('href')):\n\t        links.append(link.get_attribute('href'))\n<font size=3>\n\n>å–ã£ã¦ããŸãƒªãƒ³ã‚¯ã„ãã¤ãŒã‚ã‚Šã¾ã—ãŸã€ãã‚Œãã‚Œã¯ãƒšãƒ¼ã‚¸2ãƒ¼5ã€next pageè¡Œãã€æœ€çµ‚ãƒšãƒ¼ã‚¸è¡Œãã¨è¦‹ã‚Œã¾ã™ã­ã€‚\n>ä»Šå›ã¯ã¾ãšãƒã‚¿ãƒãƒ¬ãªã—ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã®ã§ã€page289ã¯ãƒã‚¿ãƒãƒ¬ãªã—ã®åˆè¨ˆãƒšãƒ¼ã‚¸æ•°ã§ã™ã­ã€‚\n>ã‚µã‚¤ãƒˆä¸Šã®çŠ¶æ³ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã—ã¾ã—ãŸã€‚\n\n</font>\n{% asset_img links.png links %}\n{% asset_img no_spoiler_allpage.png no_spoiler_allpage %}\n\n\t#ãƒšãƒ¼ã‚¸æ•°ã®ã¿ã‚’å–å¾—ã—ã¾ã™ã€‚\n\ttimes_no_spoiler = links[-1].split(\"page=\")[-1]\n\ttimes_no_spoiler\n\t#289\n\n<font size=3>\n\n>ã»ã‹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã¤ã‘ãŸã‚¹ã‚³ã‚¢ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™»éŒ²é »åº¦ã®æƒ…å ±ã‚‚å–ã£ã¦ããŸã„ã®ã§ã€ä¸€ã¤ã®é–¢æ•°ã«ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚\n\n>ãŸã æœ€çµ‚ãƒšãƒ¼ã‚¸ã¯å¿…ãšã‚³ãƒ¡ãƒ³ãƒˆ10æœ¬ã¨ã¯è¨€ãˆãªã„ã®ã§ã€æœ€çµ‚ãƒšãƒ¼ã‚¸å¯¸å‰ã®ãƒšãƒ¼ã‚¸ã¾ã§ã—ã‹ã“ã®é–¢æ•°ã‚’ä½¿ã£ã¦ã¾ã›ã‚“ã€‚\n\n>æœ€çµ‚ãƒšãƒ¼ã‚¸ã¯åˆ¥é€”ã§å‡¦ç†ã—ã¦ã¾ã™ã€‚\n\n</font>\n\n\tdef find_texts(times,url):\n\t    texts = [] #ã‚³ãƒ¡ãƒ³ãƒˆ\n\t    scores = []ã€€#ã‚¹ã‚³ã‚¢\n\t    users = []ã€€#ãƒ¦ãƒ¼ã‚¶ãƒ¼å\n\t    conditions = [] #ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²é »åº¦\n\t    for i in range(1,int(times)):\n\t        browser.get(url+str(i))\n\t        element_text = browser.find_elements('css selector','.p-mark__review')\n\t        element_score = browser.find_elements('css selector','.c-rating__score')\n\t        text = [m.text for m in element_text]\n\t        score = [l.text for l in element_score]\n\t        user = [n.get_attribute('alt') for n in browser.find_elements_by_tag_name('img')]\n\t        condition = [c.get_attribute('loading') for c in browser.find_elements_by_tag_name('img')]\n\t        texts.append(text)\n\t        scores.append(score[1:11])\n\t        users.append(user[3:13])\n\t        conditions.append(condition[3:13])\n\t    return texts,scores,users,conditions\n\n<font size=3>\n\n>æ—©é€Ÿãƒã‚¿ãƒãƒ¬ãªã—ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã¾ã—ãŸã€‚\n(ã„ãˆã€å˜˜ã§ã™ã€æ—©é€Ÿã§ã¯ãªãã€çµæ§‹æ™‚é–“ã‹ã‹ã‚Šã¾ã—ãŸã€‚)\n\n</font>\n\n\tresults_no_spoiler = find_texts(times_no_spoiler)\n\ttext_no_spoiler,score_no_spoiler,user_no_spoiler,condition_no_spoiler = results_no_spoiler\n\n\tprint(len(sum(results_no_spoiler[0],[])))\n\tprint(len(sum(results_no_spoiler[1],[])))\n\tprint(len(sum(results_no_spoiler[2],[])))\n\tprint(len(sum(results_no_spoiler[3],[])))\n\t#2880\n\t#2880\n\t#2880\n\t#2880\n\n<font size=3>\n\n>å•é¡ŒãŒãªã•ãã†ã§ã™ã­ï¼å¼•ãç¶šããƒã‚¿ãƒãƒ¬ãªã—ã®æœ€çµ‚ãƒšãƒ¼ã‚¸ã‚’ï¼\nï¼ˆã‚„ã‚Šæ–¹åœ°å‘³éãã¦ç”³ã—è¨³ãªã„ã§ã™ãƒ»ãƒ»ãƒ»ï¼‰\n\n</font>\n\n\tbrowser = webdriver.Chrome()\n\n\turl_no_spoiler ='https://filmarks.com/movies/86613/no_spoiler?page='\n\n\tbrowser.get(url_no_spoiler+str(times_no_spoiler))\n\telement_text_last_no_spoiler = browser.find_elements('css selector','.p-mark__review')\n\telement_score_last_no_spoiler = browser.find_elements('css selector','.c-rating__score')\n\n\ttext_last_no_spoiler = [m.text for m in element_text_last_no_spoiler]\n\tscore_last_no_spoiler = [l.text for l in element_score_last_no_spoiler]\n\n\tuser_last_no_spoiler = [n.get_attribute('alt') for n in browser.find_elements_by_tag_name('img')]\n\tcondition_last_no_spoiler = [c.get_attribute('loading') for c in browser.find_elements_by_tag_name('img')]\n\n\tprint(len(text_last_no_spoiler))\n\t#7\n<font size=3>\n\n>æœ€çµ‚ãƒšãƒ¼ã‚¸7æœ¬ã®ã‚³ãƒ¡ãƒ³ãƒˆã—ã‹ãªã„ã‚ˆã†ã§ã™ã­ã€‚å®Ÿéš›ã«ã‚µã‚¤ãƒˆã®æ–¹ã§ç¢ºèªã—ã¾ã—ãŸã‚‰ã€ä¸€è‡´ã§ã—ãŸã€‚\n\n</font>\n\n\ttexts_no_spoiler = sum(text_no_spoiler,[])+text_last_no_spoiler\n\tscores_no_spoiler = sum(score_no_spoiler,[])+score_last_no_spoiler[1:8]\n\tusers_no_spoiler = sum(user_no_spoiler,[])+user_last_no_spoiler[3:10]\n\tconditions_no_spoiler = sum(condition_no_spoiler,[])+condition_last_no_spoiler[3:10]\n\n\timport pandas as pd\n\tdf_no_spoiler = pd.DataFrame({'ãƒ†ã‚­ã‚¹ãƒˆ':texts_no_spoiler,\n\t                           'ã‚¹ã‚³ã‚¢':scores_no_spoiler,\n\t                           'ãƒ¦ãƒ¼ã‚¶ãƒ¼':users_no_spoiler,\n\t                           'ç™»éŒ²é »åº¦':conditions_no_spoiler})\n\tdf_no_spoiler['ãƒã‚¿ãƒãƒ¬'] = 'ãªã—'\n<font size=3>\n\n>ã“ã‚Œã§ãƒã‚¿ãƒãƒ¬ãªã—ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã§ãã¾ã—ãŸã€‚\n\n</font>\n{% asset_img df_no_spoiler.png df_no_spoiler %}\n\n<font size=3>\n\n>ã“ã‚Œã§ãƒã‚¿ãƒãƒ¬ã‚ã‚Šã®ãƒ‡ãƒ¼ã‚¿ã‚‚åŒæ§˜ãªæ–¹æ³•ã§å–å¾—ã—ã€æœ€å¾Œã§ããŸå…¨ä»¶ãƒ‡ãƒ¼ã‚¿ã¯3374ä»¶ã§ã—ãŸã€‚\n\n</font>\n{% asset_img df_all_data.png df_all_data %}\n\n### 2.å‰å‡¦ç†ã¨åˆ†ã‹ã¡æ›¸ã\n<font size=3>\n\n>å‰å‡¦ç†ã§ã¯ã€çµµæ–‡å­—ã€iphoneç³»çµµæ–‡å­—ã€æ”¹è¡Œè¨˜å·ã€çœç•¥è¨˜å·(â€¦)ã€è‹±èªã‚’å°æ–‡å­—ã«çµ±ä¸€ã€æ­£è¦åŒ–ã€urlã€æ•°å­—ã€å„ç¨®è¨˜å·ã®å‡¦ç†ã‚’è¡Œã„ã¾ã—ãŸã€‚\n\n</font>\n\n\timport neologdn\n\timport re\n\timport emoji\n\timport string\n\tdef filter(desstr, restr=''):\n\t\t\n\t\t#emoji\n\t    res = re.compile(u'[\\U00010000-\\U0010ffff]')\n\t    res_emoji = res.sub(restr,desstr)\n\n\t    #iPhoneã®emoji \n\t    res_iphone_emoji = ''.join(c for c in desstr if c not in emoji.UNICODE_EMOJI) \n\n\t    #æ”¹è¡Œè¨˜å·\n\t    res_linebreak = ''.join(res_iphone_emoji.replace('<br/>','').split())\n\n\t    #çœç•¥è¨˜å·\n\t    res_ellipsis = ''.join(res_linebreak.replace('â€¦','').split())\n\n\t    #å¤§æ–‡å­—â†’å°æ–‡å­—\n\t    res_uppertolower = res_ellipsis.lower() \n\n\t    #æ­£è¦åŒ–\n\t    res_normalization = neologdn.normalize(res_uppertolower)\n\n\t    #url\n\t    res_url = re.sub(r'https?://[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-]+','',res_normalization)\n\n\t    #è¨˜å·\n\t    res_punctuation = res_url.translate(str.maketrans( '', '',string.punctuation)) \n\n\t    #æ•°å­—\n\t    res_num = ''.join([i for i in res_punctuation if not i.isdigit()])\n\t        \n\t    return res_num\n\ttext_ed = [filter(str(i)) for i in df['text']]\n\tdf['texts_ed'] = text_ed\n<font size=3>\n\n>ä»Šå›Mecabã‚’ä½¿ã£ã¦åˆ†ã‹ã¡æ›¸ãã‚’è¡Œã„ã¾ã—ãŸã€‚\n\n</font>\n\n\tdef wakati_by_mecab(text):\n\t    tagger = MeCab.Tagger(r'C:\\Users\\â€»â€»\\Anaconda3\\envs\\enviroment\\Lib\\site-packages\\MeCab\\mecab-ipadic-neologd')\n\t    tagger.parse('') \n\t    node = tagger.parseToNode(text)\n\t    word_list = []\n\t    while node:\n\t        pos = node.feature.split(\",\")[0]\n\t        if pos in [\"åè©\", \"å‹•è©\", \"å½¢å®¹è©\"]:\n\t            word = node.surface\n\t            word_list.append(word)\n\t        node = node.next\n\t    return \" \".join(word_list)\n\n\ttexts_wakati = [wakati_by_mecab(i) for i in text_ed]\n\n\t#stopwordsã®å‡¦ç†\n\ttexts_wakati_ed =[]\n\tfor m in texts_wakati:\n\ttext_wakati_ed = [i for i in m.split() if i not in df_stopwords.values.tolist()]\n    texts_wakati_ed.append(text_wakati_ed)\n    df['texts_wakati'] = [' '.join(i) for i in texts_wakati_ed]\n<font size=3>\n\n>åˆ†ã‹ã¡æ›¸ãè¡Œã£ãŸãƒ‡ãƒ¼ã‚¿ã¯ã“ã†ã„ã†æ„Ÿã˜ã§ã™\n\n</font> \n{% asset_img wakati.png wakati%}\n\n### 3.ç™»å ´äººç‰©ã¨é–¢é€£ãƒ†ãƒ¼ãƒ\n#### A.ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã‚³ãƒ¡ãƒ³ãƒˆã®æ¦‚è¦ã‚’æŠŠæ¡\n<font size=3>\n\n>ã¾ãšã“ã®æ˜ ç”»ã®å†…å®¹ã«ã¤ã„ã¦ã€ã‚³ãƒ¡ãƒ³ãƒˆå†…ä¸€ç•ªè©±é¡Œã¨ãªã£ã¦ã„ã‚‹äººç‰©ã¨ãƒ†ãƒ¼ãƒã‚’æ¢ã‚ŠãŸã„ã®ã§ã€\n>ã¨ã‚Šã‚ãˆãšä¸€ç•ªã‚ˆãå‡ºã‚‹å˜èªã®ä¸Šä½200ä½ã®ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã§ç¢ºèªã—ã¦ã¿ã¾ã—ãŸã€‚\n\n</font> \n\n\tfrom collections import Counter\n\tfrom wordcloud import WordCloud\n\timport matplotlib.pyplot as plt\n\tfrom pyecharts.charts import *\n\tfrom pyecharts import options as opts\n\tfrom pyecharts.globals import ThemeType\n\tfrom IPython.display import Image\n\n\tword_count_1 = Counter(sum(texts_wakati_ed,[]))\n\twc_1 = WordCloud(\n    width=2000,\n    height=1200,\n    font_path=r'C:\\Users\\â˜…â˜…\\python\\UDDigiKyokashoN-R.ttc',\n    margin=2,\n    relative_scaling=0.2,\n    prefer_horizontal=1,\n    colormap='tab20')\n\twc2_1 = wc_1.generate_from_frequencies(word_count_1,200) \n\tfig = plt.figure(figsize=(20,12))\n\tplt.imshow(wc2_1, interpolation=\"bilinear\")\n\tplt.axis(\"off\")\n\tplt.show()\n\n<div style=\"width:70%;margin:auto\">{% asset_img wc_1.png wc_1%}</div>\n<font size=3>\n\n>ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’ç¢ºèªã—ã¦ã€ä»¥ä¸‹ã®ã„ãã¤ã®ãƒ†ãƒ¼ãƒã«ã¤ã„ã¦æ°—ã«ãªã‚Šã¾ã—ãŸã®ã§ã€ãã‚Œãã‚Œã®å†…å®¹ã‚’æŠ½å‡ºã—ã¦ã¿ã¾ã—ãŸã€‚\n>**['ã‚·ãƒ£ã‚ªãƒ˜ã‚¤','ãƒ ã‚²ãƒ³','ãƒ•ãƒ¼ã‚·ãƒ¼','äººé–“','å¦–ç²¾','æ—¥æœ¬','ä¸­å›½','ã‚¸ãƒ–ãƒª']**\n\n</font> \n\n\tl1=[]\n\tl2=[]\n\tfor i in range(0,len(df['text'])):\n\t    if 'ã‚·ãƒ£ã‚ªãƒ˜ã‚¤' in df['text'].iloc[i]:\n\t        l1.append(df['texts_wakati'].iloc[i])\n\t    if 'å°é»’' in df['text'].iloc[i]:\n\t        l2.append(df['texts_wakati'].iloc[i])\n\t...\n\n\tlist_=[len(list(set(l1+l2+l13))),len(list(set(l6+l7+l8))),len(list(set(l3+l4+l5+l12))),len(l9),len(l10),len(l11),len(l14),len(l15)]\n\tdf_kw = pd.DataFrame(list_,index=['ã‚·ãƒ£ã‚ªãƒ˜ã‚¤','ãƒ ã‚²ãƒ³','ãƒ•ãƒ¼ã‚·ãƒ¼','äººé–“','å¦–ç²¾','ã‚¸ãƒ–ãƒª','æ—¥æœ¬','ä¸­å›½'])\n\tdf_kw=df_kw.reset_index().rename(columns = {'index':'åå‰',0:'å›æ•°'})\n\n\txaxis = df_kw['å›æ•°'].to_list()\n\tyaxis = df_kw['åå‰'].to_list()\n{% asset_img xyaxis.png xyaxis%}\n\n\t#æ¨ªæ£’ã‚°ãƒ©ãƒ•ã§é›†è¨ˆçµæœã‚’ç¢ºèªã—ã¾ã—ãŸã€‚\n\tc = (\n\t    Bar(init_opts = opts.InitOpts(theme = ThemeType.CHALK))\n\t    .add_xaxis(yaxis)\n\t    .add_yaxis('',xaxis).reversal_axis()\n\t    .set_global_opts(title_opts = opts.TitleOpts(title = 'ãƒ†ãƒ¼ãƒè¨€åŠå›æ•°',pos_left = 'top'),\n\t                     yaxis_opts = opts.AxisOpts(axislabel_opts = opts.LabelOpts(font_size=13)),\n\t                     xaxis_opts = opts.AxisOpts(axislabel_opts = opts.LabelOpts(font_size=13))\n\t                    )\n\t    .set_series_opts(label_opts = opts.LabelOpts(font_size = 16,position ='right'))\n\t)\n\tc.render_notebook()\n<div style=\"width:70%;margin:auto\">{% asset_img ãƒ†ãƒ¼ãƒã”ã¨ã®çµæœ_1.png ãƒ†ãƒ¼ãƒã”ã¨ã®çµæœ_1%}</div>\n<font size=3>\n\n>ãƒ†ãƒ¼ãƒã”ã¨ã®è©³ç´°ã¯ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã§è¡¨ç¤ºã—ã¦ã¿ã¾ã—ãŸã€‚\n>5ã¤ã®ãƒ†ãƒ¼ãƒã®çµæœã—ã‹è¨˜è¼‰ã—ã¦ã„ãªã„ãŒã€å…¨ç„¶é•ã„ãŒãªã„ã“ã¨ä¸€ç›®ç­ç„¶ã§ã™ã­ã€‚ã€‚ã€‚\n>ãŠãã‚‰ããƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆãƒ†ãƒ¼ãƒã¯ã‹ãªã‚Šè¿‘ãã¦ã€æ–‡ç« ãƒ¬ãƒ™ãƒ«ã˜ã‚ƒã‚ã‚ã‹ã‚Šã«ãã„ã¨æ€ã†ã®ã§ã€Sentenceãƒ¬ãƒ™ãƒ«ã§è¡Œã£ã¦ã¿ã¾ã—ãŸã€‚\n\n</font>\n<div style=\"width:100%;margin:auto\">{% asset_img wc_1_all.png wc_1_all%}</div>\n<font size=3>\n\n>ã¾ãšæ–‡ç« ã‚’ä¸€ã¤ãšã¤ã®Sentenceã«åˆ†è§£ã—ã¾ã—ãŸã€‚\n\n</font>\n\t\n\ttext_kw=' '.join(' '.join(''.join(df['text'].to_list()).split('ã€')).split('ã€‚')).split()\n\n<div style=\"width:70%;margin:auto\">{% asset_img sentence_cut.png sentence_cut%}</div>\n\n\tkw_list = ['ã‚·ãƒ£ã‚ªãƒ˜ã‚¤','å°é»’','ãƒ•ãƒ¼ã‚·ãƒ¼','ãƒ•ãƒ¼ã‚·','é¢¨æ¯','ãƒ ã‚²ãƒ³','ç„¡é™','å¸«åŒ ','äººé–“','å¦–ç²¾','ã‚¸ãƒ–ãƒª','ãƒ•ã‚¦ã‚·ãƒ¼','é»’çŒ«','æ—¥æœ¬','ä¸­å›½']\n\tlist_kw_text_sh = []\n\tlist_kw_text_fs = []\n\t...\n\tlist_kw = []\n\tfor i in text_kw:\n\t    if kw_list[0] in i:\n\t        list_kw_text_sh.append(i)\n\t        list_kw.append(kw_list[0])\n\t    elif kw_list[1] in i:\n\t        list_kw_text_sh.append(i)\n\t        list_kw.append(kw_list[0])\n\t    elif kw_list[2] in i:\n\t        list_kw_text_fs.append(i)\n\t        list_kw.append(kw_list[2])\n\t    elif kw_list[3] in i:\n\t        list_kw_text_fs.append(i)\n\t        list_kw.append(kw_list[2])\n\t ...\n\tdf_count = pd.DataFrame(Counter(list_kw).keys(),Counter(list_kw).values(),columns =['KW'] )\n\tdf_count=df_count.reset_index().rename(columns = {'index':'å›æ•°'})\n\tdf_count\n\tyaxis = df_count['KW'].values.tolist()\n\txaxis = df_count['å›æ•°'].values.tolist()\n\n<font size=3>\n\n>ä¸Šè¨˜å¾—ãŸçµ±è¨ˆçµæœã‚’ã‚‚ã¨ã«ã—ãŸæ¨ªæ£’ã‚°ãƒ©ãƒ•çµæœã¨ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\n\n>ã“ã‚Œã‚‰ã®çµæœã‹ã‚‰ãƒ†ãƒ¼ãƒã”ã¨ã®é•ã„ãŒã‚ã‹ã‚Šã¾ã—ãŸã­ã€‚ä¾‹ãˆã°ã€ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ãã£ã¨ã¨ã«ã‹ãå¯æ„›ã„ã§ã™ã‚ˆã­ã€ãƒ ã‚²ãƒ³ã¯ã‹ã£ã“è‰¯ãæœ€å¼·ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å¸«åŒ ã§ã™ã­ã€ãƒ•ãƒ¼ã‚·ãƒ¼ã®å£°å„ªã•ã‚“ã§ã‚ã‚‹æ«»äº•å­å®ã•ã‚“ã¯çµæ§‹è©•ä¾¡ã•ã‚ŒãŸã‚‰ã‚ã†ã­ã€ä»²é–“ã«é–¢ã™ã‚‹ã€äººé–“ã¨å¦–ç²¾ã®å…±å­˜ã€å±…å ´æ‰€ãŒç ´å£Šã•ã‚ŒãŸã‚Šã•ã‚ŒãŸã‚·ãƒ¼ãƒ³ãŒã‚ã‚Šã¾ã—ãŸã­ã€ã“ã®æ˜ ç”»ã«æ—¥æœ¬ã®ã‚¸ãƒ–ãƒªã‚„ã€ãƒ‰ãƒ©ã‚´ãƒ³ã€ã‚‚ã®ã®ã‘ç­‰ã®ä½œå“ã«å½±éŸ¿ã•ã‚Œã€ã‹ãªã‚Šæ—¥æœ¬ã‚¢ãƒ‹ãƒ¡è¦ç´ å¤šãæ„Ÿã˜ã‚‰ã‚Œã¾ã—ãŸã‚ˆã­ã€‚ãã“ã‹ã‚‰ä¸­å›½æ–‡åŒ–ã«é–¢ã—ã¦èªã‚‰ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚ã„ãŸãªã©ãªã©ã®æƒ…å ±ãŒè¦‹ã‚‰ã‚Œã¾ã—ãŸã­ã€‚\n\n</font>\n<div style=\"width:70%;margin:auto\">{% asset_img ãƒ†ãƒ¼ãƒã”ã¨ã®çµæœ_2.png ãƒ†ãƒ¼ãƒã”ã¨ã®çµæœ_2%}</div>\n<div style=\"width:100%;margin:auto\">{% asset_img wc_2_all_1.png wc_2_all_1%}</div>\n<div style=\"width:100%;margin:auto\">{% asset_img wc_2_all_2.png wc_2_all_2%}</div>\n\n#### B.ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ç°¡æ˜“ç‰ˆGUI\n<font size=3>\n\n>ã“ã®çµæœã‚’ã‚‚ã¨ã«ã€ä»»æ„ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ãŒå‡ºã¦ãã‚‹ç°¡æ˜“ç‰ˆGUIãƒ„ãƒ¼ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚\n>ã“ã‚“ãªæ„Ÿã˜ã§ã™ï¼(åœ°å‘³ä¸å¯é¿ãƒ»ãƒ»ãƒ»)\n>ä»Šå¾Œã®èª²é¡Œã¨ã—ã¦ã©ã‚“ã©ã‚“æ”¹å–„ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼\n\n<font size=3>\n\n\tfrom tkinter import *\n\timport tkinter as tk\n\n\t#ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰ç”Ÿæˆç”¨ã®é–¢æ•°\n\tdef get_data():\n\t    theme_data = _input.get()\n\t    theme_texts =[i for i in text_kw if theme_data in i]\n\t    theme_wakati = [wakati_by_mecab(i) for i in theme_texts]\n\t    theme_count = Counter(' '.join(theme_wakati).split())\n\t    wc = WordCloud(\n\t        width=1800,\n\t        height=1200,\n\t        font_path=r'C:\\Users\\â€»â€»\\python\\UDDigiKyokashoN-R.ttc',\n\t        margin=2,\n\t        relative_scaling=0.3,\n\t        prefer_horizontal=1,\n\t        colormap='tab20')\n\t    wc2 = wc.generate_from_frequencies(theme_count,300)\n\t    fig = plt.figure(figsize=(18,12))\n\t    plt.imshow(wc2, interpolation=\"bilinear\")\n\t    plt.axis(\"off\")\n\t    plt.show()\n\n    #ç°¡æ˜“ç‰ˆGUIä½œæˆ\n    app = Tk()\n\t_input=tk.Entry(app,show=None) #å…¥åŠ›ç”»é¢ã®è¨­å®š\n\t_input.pack()ã€€\n\tapp.title('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›')\n\tscreenwidth = app.winfo_screenwidth()\n\tscreenheight = app.winfo_screenheight()\n\tdialog_width = 400\n\tdialog_height = 170\n\tapp.geometry(\n\t    \"%dx%d+%d+%d\" % (dialog_width, dialog_height, (screenwidth - dialog_width) / 2, (screenheight - dialog_height) / 2))\n\tbtn = Button(text ='search',command = get_data,width = 10)\n\tbtn.place(x=155,y = 80)\n\tbtn.pack()\n\tapp.mainloop()\n<div style=\"width:100%;margin:auto\">{% asset_img GUI.png GUI%}</div>\n\n### 4.æ¥µæ€§è¾æ›¸ã«ã‚ˆã‚‹æ„Ÿæƒ…åˆ†æ\n#### A.å˜èªæ„Ÿæƒ…æ¥µæ€§å¯¾å¿œè¡¨ã§ã‚¹ã‚³ã‚¢ã‚’ä»˜ã\n<font size=3>\n\n>æ¥µæ€§è¾æ›¸ã«ã‚ˆã‚‹æ„Ÿæƒ…åˆ†æã¯ä»Šå›ãƒ¡ã‚¤ãƒ³ã«ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã—ã¦è¡Œã„ã¾ã—ãŸã€‚\n>>[æ„Ÿæƒ…åˆ†æã§ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã®ãƒã‚¬ãƒã‚¸åº¦åˆã„ã‚’ã‚¹ã‚³ã‚¢åŒ–ã™ã‚‹](https://qiita.com/g-k/items/e49f68d7e2fed6e300ea)\n\n>ã¾ãšæ¥µæ€§è¾æ›¸ ([å˜èªæ„Ÿæƒ…æ¥µæ€§å¯¾å¿œè¡¨](http://www.lr.pi.titech.ac.jp/~takamura/pndic_ja.html))ã‚’èª­ã¿è¾¼ã¿\n>>æ¥µæ€§è¾æ›¸ã¨çµåˆã™ã‚‹ãŸã‚ã€åˆ†ã‹ã¡æ›¸ãã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã®å“è©æƒ…å ±ã‚’è‰²ã€…å‡¦ç†ã‚’è¡Œã„ã¾ã—ãŸã€‚\n\n</font>\n\n\t#æ¥µæ€§è¾æ›¸ã‚’èª­ã¿è¾¼ã¿\n\tdict_= pd.read_table('æ¥µæ€§è¾æ›¸.txt',sep =':',header = None)\n\tdff = dict_.rename(columns ={0:'åŸºæœ¬å½¢',1:'èª­ã¿æ–¹',2:'å“è©',3:'æ¥µæ€§ã‚¹ã‚³ã‚¢'})\n<div style=\"width:70%;margin:auto\">{% asset_img dff_dict.png dff_dict%}</div>\n\n\t#åˆ†ã‹ã¡æ›¸ã\n\timport MeCab\n\ttagger = MeCab.Tagger(r'C:\\Users\\â€»â€»\\Anaconda3\\envs\\enviroment\\Lib\\site-packages\\MeCab\\mecab-ipadic-neologd')\n\ttexts = [tagger.parse(i) for i in df.texts_ed]\n<div style=\"width:70%;margin:auto\">{% asset_img texts_wakati.png texts_wakati%}</div>\n\n\ttmps = []\n\tfor t in texts:\n\t        tmp = [k.split('\\t') for k in t.split('\\n')]\n\t        tmp_ = tmp[:-2] #æ–‡æœ«ã®EOSéƒ¨åˆ†ã‚’åˆ‡ã‚Šæ¨ã¦\n\t        tmps.append(tmp_)\n\tsurfs = [pd.DataFrame(m).rename(columns = {0:'å˜èª',2:'èª­ã¿æ–¹_old',3:'åŸºæœ¬å½¢',4:'å“è©_old'}) for m in tmps]\n\t\n\t#å½¢å®¹è©-éè‡ªç«‹å¯èƒ½ã€åè©-æ™®é€šåè©-åŠ©æ•°è©å¯èƒ½ã®ã‚ˆã†ãªå“è©æƒ…å ±ã‚’å½¢å®¹è©ã€åè©ã«ä¿®æ­£\n\tllist= []\n\tfor i in surfs:\n\t    list_ = []\n\t    for m in range(0,len(i)):\n\t        if i['å“è©_old'][m] !=None:\n\t            list_.append(i['å“è©_old'].str.split('-')[m][0])\n\t        else:\n\t            list_.append(i['å“è©_old'][m])\n\t    llist.append(list_) \n\t\n\t#èª­ã¿æ–¹ã‚’ã‚«ã‚¿ã‚«ãƒŠã‹ã‚‰ã²ã‚‰ãŒãªã«å¤‰æ›´\n\timport jaconv\n\tllists= []\n\tfor i in surfs:\n\t    list_y = []\n\t    for m in range(0,len(i)):\n\t        if i['èª­ã¿æ–¹_old'][m] != None:\n\t            list_y.append(jaconv.kata2hira(i['èª­ã¿æ–¹_old'][m]))\n\t        else:\n\t            list_y.append(i['èª­ã¿æ–¹_old'][m])\n\t    llists.append(list_y)\n\n\t#åˆ†ã‹ã¡æ›¸ãã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¨æ¥µæ€§è¾æ›¸ã‚’çµåˆã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å˜èªã”ã¨ã«ã‚¹ã‚³ã‚¢å€¤ã‚’ä»˜ã‘ã¦ã„ã\n\tscore_results = []\n\tfor i in range(0,len(surfs)):\n\t    surfs[i]['å“è©'] = llist[i]\n\t    surfs[i]['èª­ã¿æ–¹'] = llists[i]\n\t    if surfs[i].columns.size == 10:\n\t        score_result= pd.merge(surfs[i][['å˜èª','åŸºæœ¬å½¢','èª­ã¿æ–¹','å“è©']],dff,on=['åŸºæœ¬å½¢','èª­ã¿æ–¹','å“è©'],how = 'left')\n\t        score_results.append(score_result)\n\t    else:\n\t        score_results.append(surfs[i])\n<font size=3>\n\n>ã™ã¹ã¦ã®æ–‡æ›¸ã¯å˜èªã”ã¨ã«ã‚¹ã‚³ã‚¢ãŒä»˜ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚\n>æ¥µæ€§è¾æ›¸ã«ãªã„å˜èªã®ã‚¹ã‚³ã‚¢ã¯NaNå€¤ã€‚\n>æ–‡æ›¸ã”ã¨ã«ã™ã¹ã¦å˜èªã®ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—ã™ã‚‹ã¨ã€æ–‡æ›¸ã”ã¨ã®ã‚¹ã‚³ã‚¢ãŒå¾—ã‚‰ã‚Œã‚‹\n\n</font>\n<div style=\"width:70%;margin:auto\">{% asset_img socre_singlearticle.png socre_singlearticle%}</div>\n\n\tresults = []\n\tfor i in range(0,len(score_results)):\n\t    if score_results[i].columns.size == 5:\n\t        text = ''.join(list(score_results[i]['å˜èª']))\n\t        score = score_results[i]['æ¥µæ€§ã‚¹ã‚³ã‚¢'].astype(float).sum()\n\t        score_r = score/score_results[i]['æ¥µæ€§ã‚¹ã‚³ã‚¢'].astype(float).count()\n\t        result = [text,score,score_r]\n\t        results.append(result)\n\t    else:\n\t        results.append(score_results[i])\n\tdf_score = []\n\tfor i in range(0,len(results)):\n\t    if len(results[i]) == 3: \n\t        dfff = pd.DataFrame({\n\t            'ãƒ†ã‚­ã‚¹ãƒˆ':results[i][0],\n\t            'ç´¯è¨ˆã‚¹ã‚³ã‚¢':results[i][1],\n\t            'ç´¯è¨ˆæ¨™æº–åŒ–ã‚¹ã‚³ã‚¢':results[i][2],\n\t            'user':df.iloc[i]['user'],\n\t            'score':df.iloc[i]['score']},index =range(1))\n\t        df_score.append(dfff.iloc[[0]])\n\tddf_score = pd.concat(df_score).reset_index().sort_values('ç´¯è¨ˆæ¨™æº–åŒ–ã‚¹ã‚³ã‚¢',ascending=False)\n<font size=3>\n\n>ä¸€ç™ºã§è¡Œã£ãŸçµæœã€ä¸Šä½10ä½ã¨ä¸‹ä½10ä½ã®å†…å®¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã—ãŸã€‚\n>åˆ†ã‹ã¡æ›¸ãã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ã®å“è©ã‚„èª­ã¿æ–¹ç­‰æ¥µæ€§è¾æ›¸ã¨ä¸€è‡´ã—ãªã„å˜èªãŒã‚ã‚‹ã“ã¨ã§ã€ã‚¹ã‚³ã‚¢ä»˜ã‘ãŒã‚ºãƒ¬ãŒç”Ÿã˜ãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚\n>>ä¾‹ãˆã°2678è¡Œã®ã€Œå¥½ãã§ã™ã€ã®ã€Œå¥½ãã€ã¯åˆ†ã‹ã¡æ›¸ãã—ãŸå“è©ãŒå½¢çŠ¶è©ã§ã™ãŒã€æ¥µæ€§è¾æ›¸å†…ã§ã¯åè©ã¨ã®ã“ã¨ã§ã€ã‚¹ã‚³ã‚¢ãŒä»˜ã‘ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚\n\n</font>\n\t\n\tddf_score[:10:]['ãƒ†ã‚­ã‚¹ãƒˆ'].to_list()\n\t#['ãƒ•ãƒ¼ã‚·ãƒ¼ã«ã‚‚ãƒ ã‚²ãƒ³ã«ã‚‚ãã†ã ã‚ˆã­ã‡ã£ã¦ã„ã†æ°—æŒã¡ã€‚ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ãŒã‹ãƒ¼ã‚ã„ã„ã€‚',\n\t 'ã¨ã£ã¦ã‚‚å¯æ„›ã‹ã£ãŸãƒ¼çŒ«å¥½ããªã‚‰è¦‹ã‚‹ã¹ãã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚‚è‰¯ã‹ã£ãŸ',\n\t 'æ˜­å’Œã®æ±æ˜ ã¾ã‚“ãŒç¥­ã‚Šã‚’å½·å½¿ã¨ã•ã›ã‚‹åŠ›å¼·ãã¾ã£ã™ããªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚ç´ æ™´ã‚‰ã—ã‹ã£ãŸã€‚',\n\t 'ã‚„ã•ã—ã„ã‚¿ãƒƒãƒã®ã‚­ãƒ£ãƒ©ãƒ‡ã‚¶ã‹ã‚‰ç¹°ã‚Šåºƒã’ã‚‰ã‚Œã‚‹ã‚´ãƒªãƒƒã‚´ãƒªã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä½œç”»ã«åœ§å·»ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒŸãƒƒã‚¯ã‚¹ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ã‹ã‚ã‚†ã„',\n\t 'ã€ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«ãƒ–ãƒ­ãƒªãƒ¼ã€ä¸¦ã¿ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒˆãƒ«ã‚·ãƒ¼ãƒ³ã«åœ§å·»',\n\t 'ãŠã‚‚ã‚ã‹ã£ãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ã‹ã‚Šã‚„ã™ã„ã—ã€ä½œç”»ãŒç¥ãƒ‡ãƒ‘ãƒ¼ãƒˆã§ã®ãƒãƒˆãƒ«ã‚·ãƒ¼ãƒ³ãŒä¸€ç•ªå¥½ã',\n\t 'ãƒ ã‚²ãƒ³æ§˜ãƒãƒˆãƒ«ã‚·ãƒ¼ãƒ³ãŒå‡„ã‹ã£ãŸã“ã‚Œã¯dxã§ã¿ã‚Œã°ã‚ˆã‹ã£ãŸãª',\n\t 'å¯æ„›ã„çµµãŒç¶ºéº—å¯æ„›ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚·ãƒ¼ãƒ³ãŒã™ã”ã„å¯æ„›ã„é¢ç™½ã„å¯æ„›ã„å¯æ„›ã„å¯æ„›ã„',\n\t 'ã“ã‚Œã¯æº€è¶³ã§ã™ã¾ãšã‚·ãƒ£ã‚ªãƒ˜ã‚¤ãŒå¯æ„›ã„ã—ã€ãƒ ã‚²ãƒ³æ§˜ãŒã‚«ãƒƒã‚³ã„ã„',\n\t 'è‰¯ã„ãƒªã‚¢ãƒ«ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã§ã€è‰¯ã„å¸«å¼Ÿã‚‚ã®ã§ã—ãŸã€‚ã‚ã‹ã‚Šã‚„ã™ã„é¢ç™½ã•ãŒã‚ã‚Šã¾ã™ã€‚']\n\n\t ddf_score[-10::]['ãƒ†ã‚­ã‚¹ãƒˆ'].to_list()\n\t #['ãƒŠãƒ«ãƒˆÃ—ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«Ã—ã‚¸ãƒ–ãƒªã¿ãŸã„ã§ã€ãã‚‰å¤§å¥½ãã«ãªã‚Šã¾ã™ã‚ã¨ã„ã£ãŸæ„Ÿã˜ã§ã™ã€‚',\n\t 'ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«ã¨åƒã¨åƒå°‹ã¨ãªã‚“ã‹ã‚’ãƒŸãƒƒã‚¯ã‚¹ã—ãŸæ„Ÿã˜ã€‚ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ã¨ã¦ã‚‚ãã‚ƒã‚ã‚ã€‚',\n\t 'å­ä¾›ã¨è¦³ãŸã‚“ã ã‘ã‚Œã©ã‚‚ã€ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãŒã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã¿ãŸã„ã€‚',\n\t 'ã‚¢ãƒ‹ãƒ¡ã§è¦‹ãŸã„ã®ã¯ã“ã†ã„ã†ã®ãªã‚“ã ã‚ˆ', â†’score=0\n\t 'ãƒ ã‚²ãƒ³æ§˜ãƒ•ãƒ¼ã‚·ãƒ¼ãƒ ã‚²ãƒ³æ§˜ãƒ•ãƒ¼ã‚·ãƒ¼ã‚¦ãƒƒ',â†’score=0\n\t 'ãˆå¥½ã',â†’score=0\n\t 'ã‚¢ã‚¢ã‚¢ã‚¡ã‚¡ã‚¡ã‚¡ã‚¯ã‚·ãƒ§ãƒ³ãƒ³ãƒ³ãƒ³ãƒ³ãƒ³ãƒ³ã ã£ãŸã“ã‚Œã¯ã‚µã‚¤ãƒ‰ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã²ãŸã™ã‚‰è¦³ãŸã„ãª',â†’score=0\n\t 'livezoundÃ—rgbãƒ¬ãƒ¼ã‚¶ãƒ¼ãƒãƒãƒãƒƒã‚¿ãƒãƒm',â†’score=0\n\t 'ä¸­å›½èªç‰ˆãƒ¦ã‚¸ã‚¯æ—¥æœ¬èªå¹ãæ›¿ãˆç‰ˆãƒãƒ«ãƒˆ',â†’score=0\n\t 'å¥½ãã§ã™'â†’score=0]\n#### B.æ¥µæ€§è¾æ›¸ã‚’ç”Ÿæˆã—ãŸä¸Šã§ã‚¹ã‚³ã‚¢ã‚’ä»˜ã\n<font size=3>\n\n>æ—¢å­˜ã®æ¥µæ€§è¾æ›¸ã¯ä»Šå›ã®ãƒ‡ãƒ¼ã‚¿ã¨ç›¸æ€§ãŒè‰¯ããªã„ã‚ˆã†ãªã®ã§ã€ç‹¬è‡ªã®æ¥µæ€§è¾æ›¸ã‚’ç”Ÿæˆã™ã‚‹æ‰‹ã‚’è€ƒãˆã¾ã—ãŸã€‚\n>>ãƒ¡ã‚¤ãƒ³ã¯ã“ã¡ã‚‰ã®è¨˜äº‹[æ„Ÿæƒ…åˆ†æã«ç”¨ã„ã‚‹æ¥µæ€§è¾æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹](https://qiita.com/g-k/items/1b7c765fa6520297ca7c)ã‚’å‚è€ƒã—ã¾ã—ãŸã€‚\n>>model_neologd.vecã®å–å¾—ã¯ã“ã¡ã‚‰ã®è¨˜äº‹[fastTextã®å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’å…¬é–‹ã—ã¾ã—ãŸ](https://qiita.com/Hironsan/items/513b9f93752ecee9e670)ã‚’ã”å‚è€ƒãã ã•ã„ã€‚\n>>posi_listã¨nega_listã¯ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’ã¿ã¦é©å®œä¿®æ­£ã‚ã‚Š\n\n</font>\n\n\timport gensim\n\tmodel = gensim.models.KeyedVectors.load_word2vec_format('model_neologd.vec', binary=False)\n\n\tposi_list = ['å„ªã‚Œã‚‹', 'è‰¯ã„','å–œã¶','è¤’ã‚ã‚‹', 'ã‚ã§ãŸã„','è³¢ã„','å–„ã„', 'é©ã™','å¤©æ™´','ç¥ã†', 'åŠŸç¸¾','è³',\n\t'å¬‰ã—ã„','å–œã³','æ‰çŸ¥','å¾³', 'æ‰èƒ½','ç´ æ™´ã‚‰ã—ã„','èŠ³ã—ã„','ç§°ãˆã‚‹','é©åˆ‡','å´‡ã‚ã‚‹','åŠ©ã‘ã‚‹','æŠœãã‚“ã§ã‚‹','æ¸…æ°´',\n\t'é›„é›„ã—ã„','ä»•åˆã›','å¹¸ã„','å‰å…†','ç§€ã§ã‚‹','ã‹ã‚ã„ã„','ã™ã™ã‚','dvd','å¯æ„›','æ¶™è…º','æ³£ã','è±ªè¯','ã†ã¾ã„',\n\t'ç·»å¯†','ãŠã‚‚ã—ã‚ã‹ã£','åŠ ç‚¹','æœ€é«˜','ã™ã”ã„','é­…åŠ›','ç‹é“','ç¶ºéº—','æ„Ÿå‹•','æ¥½ã—ã‚','å¥½ã','ä¸€ç•ª','ã‚„ã™ã„','ã„ãˆãƒ¼',\n\t'é…”ã„ã—ã‚Œ','å¾®ç¬‘ã¿']\n\tnega_list = ['æ‚ªã„', 'æ­»ã¬', 'ç—…æ°—', 'é…·ã„', 'ç½µã‚‹', 'æµ¸ã‘ã‚‹', 'å‘ã—ã„','ä¸‹æ‰‹', 'è‹¦ã—ã‚€', 'è‹¦ã—ã„', 'ä»˜ã', \n\t'å³ã—ã„', 'é›£ã—ã„', 'æ®ºã™', 'é›£ã„', 'è’è’ã—ã„','æƒ¨ã„', 'è²¬ã‚ã‚‹', 'æ•µ', 'èƒŒã', 'å˜²ã‚‹', 'è‹¦ã—ã‚ã‚‹', 'è¾›ã„', \n\t'ç‰©å¯‚ã—ã„', 'ç½°', 'ä¸è²è…ã‚‹','å¯’ã„', 'ä¸‹ã‚‰ãªã„','æ®‹å¿µ','ç–²ã‚Œ','è¤‡é›‘','çœŸä¼¼','ä¸è¶³','ã‚ã‹ã‚‰','é•ã†','BLM','ãƒ‡ãƒ¢',\n\t'éæ¿€','å¯¾ç«‹','ã‚¹ãƒ†ãƒ¬ã‚ªã‚¿ã‚¤ãƒ—','å¤ã„','å¯','è¬','è¶³ã—','ã‚ªãƒªã‚¸ãƒŠãƒªãƒ†ã‚£','è‹¦ç—›','å¾Œé€²','æ˜­å’Œ','ç¨šæ‹™','ãªã•','é€€å±ˆ',\n\t'é«˜ã‹ã£','æ®‹ã‚‰','èª¬æ˜','ã—ã‚“ã©','æ¸›ç‚¹','é•å’Œæ„Ÿ','ã½ã‚“ã½ã“','ç²—','ä»•æ–¹ãªã„','åˆã‚','æ˜ã‚Šä¸‹ã’','è–„ã„','æœªç†Ÿ','è‹¦æ‰‹',\n\t'ãƒ€ãƒ¡','ã”ã‚ã‚“','ã‚¬ãƒƒã‚«ãƒª','çœ ','æŠ‘åœ§','ã«ãã„']\n\n\tdef posi_nega_score(x):\n\t    #ãƒã‚¸ãƒ†ã‚£ãƒ–åº¦åˆã„ã®åˆ¤å®š\n\t    posi = []\n\t    for i in posi_list:\n\t        try:\n\t            n = model.similarity(i, x)\n\t            posi.append(n)\n\t        except:\n\t            continue\n\t    try:\n\t        posi_mean = sum(posi)/len(posi)\n\t    except:\n\t        posi_mean = 0\n\t    #ãƒã‚¬ãƒ†ã‚£ãƒ–åº¦åˆã„ã®åˆ¤å®š\n\t    nega = []\n\t    for i in nega_list:\n\t        try:\n\t            n = model.similarity(i, x)\n\t            nega.append(n)\n\t        except:\n\t            continue\n\t    try:\n\t        nega_mean = sum(nega)/len(nega)\n\t    except:\n\t        nega_mean = 0\n\t    if posi_mean > nega_mean:\n\t        return posi_mean\n\t    if nega_mean > posi_mean:\n\t        return -nega_mean\n\t    else:\n\t        return 0\n\n    for i in score_results:\n\t    if i.columns.size !=2:\n\t        i['æ¥µæ€§ã‚¹ã‚³ã‚¢_new'] = i['å˜èª'].apply(lambda x : posi_nega_score(x))\n<div style=\"width:70%;margin:auto\">{% asset_img score_result_2.png score_result_2%}</div>\n<font size=3>\n\n>æ–°ã—ãå¾—ãŸæ¥µæ€§ã‚¹ã‚³ã‚¢ã‚’ç”¨ã„ã¦æ–‡æ›¸ã”ã¨ã®ã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¾ã—ã‚‡ã†\n\n</font>\n\n\t#ã‚¹ã‚³ã‚¢ã‚’æ¨™æº–åŒ–\n\timport numpy as np\n\tfor i in score_results:\n\t    if i.columns.size!=2:\n\t        sscore = np.array(i['æ¥µæ€§ã‚¹ã‚³ã‚¢_new'])\n\t        sscore_std = (sscore - sscore.min())/(sscore.max() - sscore.min())\n\t        sscore_scaled = sscore_std * (1 - (-1)) + (-1)\n\t        i['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'] = sscore_scaled\n\t\n\t#æ–‡æ›¸ã®ã‚¹ã‚³ã‚¢ã‚’ç®—å‡º\n\tresults_new = []\n\tfor i in score_results:\n\t    if i.columns.size != 2:\n\t        text_new = ''.join(list(i['å˜èª']))\n\t        score_new = i['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'].astype(float).sum()\n\t        score_r_new = score_new/i['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'].astype(float).count()\n\t        result_new = [text_new,score_new,score_r_new]\n\t        results_new.append(result_new)\n\t    else:\n\t        results_new.append(i)\n\n\t#ä¸Šä½10ä½ã¨ä¸‹ä½10ä½\n\tddf_score_new[:10:]['ãƒ†ã‚­ã‚¹ãƒˆ'].to_list()\n\t#['æˆ¦ç›®æ–°å®¿ãƒãƒ«ãƒˆæˆ¦ç›®tãƒ»ã‚¸ãƒ§ã‚¤ãƒ—ãƒªãƒ³ã‚¹å“å·æˆ¦ç›®æ–°å®¿ãƒãƒ«ãƒˆæˆ¦ç›®æ–°å®¿ãƒãƒ«ãƒˆæˆ¦ç›®ãƒãƒãƒãƒƒã‚¿å·å´æˆ¦ç›®ãƒãƒãƒãƒƒã‚¿å·å´æœ€æ–°å­—å¹•ç‰ˆæˆ¦ç›®ãƒãƒãƒãƒƒã‚¿å·å´æœ€æ–°å­—å¹•ç‰ˆ',\n\t 'ä¹…ã—ã¶ã‚Šã«ã¡ã‚ƒã‚“ã¨ã—ãŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ˜ ç”»ã‚’è¦³ãŸãªã£ã¦ã„ã†æ„Ÿã˜ã ã£ãŸ',\n\t 'æœŸå¾…ã©ãŠã‚Šæœ€é«˜ã€‚ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€ã‚­ãƒ£ãƒ©ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒ†ãƒ³ãƒæ„Ÿã€ä¼šè©±ã®æ›ã‘åˆã„ã€å£°å„ªæ¥å ´è€…ç‰¹å…¸ã‚¤ãƒ©ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ã€‚',\n\t 'å¯æ„›ã„çµµãŒç¶ºéº—å¯æ„›ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚·ãƒ¼ãƒ³ãŒã™ã”ã„å¯æ„›ã„é¢ç™½ã„å¯æ„›ã„å¯æ„›ã„å¯æ„›ã„',\n\t 'ã€ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«ãƒ–ãƒ­ãƒªãƒ¼ã€ä¸¦ã¿ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒˆãƒ«ã‚·ãƒ¼ãƒ³ã«åœ§å·»',\n\t 'å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰å¤§å¤‰ã«ã€å¥½ã¿ã®æ˜ ç”»ã§ã—ãŸãƒ‘ãƒ³ãƒ•å£²ã‚Šåˆ‡ã‚Œã ã£ãŸã®ã§ã€ã‚¢ãƒ‹ãƒ—ãƒ¬ãƒƒã‚¯ã‚¹ã•ã‚“ã®é€šè²©ã§è²·ã„ã¾ã—ãŸã€‚è²·ãˆã¦ã‚ˆã‹ã£ãŸ',\n\t 'æ¶™è…ºã‚¬ãƒã ã‹ã‚‰æ³£ã„ãŸã‚ã¡ã‚ƒãã¡ã‚ƒç‹é“ã ã—ã‚¯ã‚ªãƒªãƒ†ã‚£é«˜ã„ä¸­å›½ã‚¢ãƒ‹ãƒ¡ã„ã„ã§ã™',\n\t 'ãƒãƒˆãƒ«ã‹ã£ã“ã‚ˆã™ã€‚æ«»äº•vså®®é‡ã€æœ¨å±æ€§vsé‡‘å±æ€§ã€è‡ªç„¶vsäººå·¥ã€‚',\n\t 'è¶…ç¥ä½œç”»ã€ã€ãƒ ã‚²ãƒ³ã•ã¾ã€ã€å®®é‡ã•ã¾ã€ã€å…±ã«ç”Ÿãã‚‹ã“ã¨',\n\t 'ã‚‚ã†ä¸€åº¦è¦‹ãŸã„â˜…â˜…â˜…â˜…â˜…æœŸå¾…ä»¥ä¸Šâ˜†â˜†â˜†â˜†æœŸå¾…é€šã‚Šâ˜†â˜†â˜†æœŸå¾…å¤–ã‚Œâ˜†â˜†æ™‚é–“è¿”ã›â˜†dynamicãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»â˜…ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»realisticãƒ¼ãƒ¼fantasticãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»staticæ—¥æ™‚å ´æ‰€ãƒãƒ«ãƒˆå®¢å…¥â˜†â˜†â˜…â˜†â˜†']\n\n\tddf_score_new[-10::]['ãƒ†ã‚­ã‚¹ãƒˆ'].to_list()\n\t['ç·šã‚‚é€ å½¢ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã ã‘ã©ã¨ã«ã‹ãå‹•ãå›ã‚Šã¾ãã£ã¦ã¦æ¥½ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚„ä¸–ç•Œè¦³ã«æƒ³åƒã®ä½™åœ°ãŒã‚ã£ã¦ã‚‚ã£ã¨è¦‹ãŸããªã‚‹ã‹ã‚‰ã¾ã§èª¬æ˜ã™ã‚‹é¬¼æ»…ã¨ã¯ã‚ã‚‹æ„å‘³åå¯¾ã§ãã“ã¯å¥½ã¿',\n\t 'ã—ã‚…ãæ­£ç›´è©±ã¨ã—ã¦é£²ã¿è¾¼ã‚ãªã„ã¨ã“ã‚‚å¤šã€…ã‚ã£ãŸã‘ã©ã€ã—ã‚…ãã¨ã„ã†æ„Ÿæƒ…ã«ã­ã˜ä¼ã›ã‚‰ã‚Œã‚‹',\n\t 'ã‹ã‚ã„ã„ã—ã‹ãªã„æ˜ ç”»ã€‚ãƒ­ã‚·ãƒ£ã‚ªã¨ãƒ ã‚²ãƒ³ã®ã‚„ã‚Šå–ã‚ŠãŒå¥½ãã™ãã‚‹',\n\t 'å¤‰åŒ–ã‚’å—ã‘ã„ã‚‰ã‚Œãªã„äººãŸã¡ã¯åˆ‡ã‚Šæ¨ã¦ã‚‹ã—ã‹ãªã‹ã£ãŸã®ã‹ã¨æ€ã£ãŸã‚‰ã€æ‚²ã—ããªã£ã¦ããŸ',\n\t 'ã€Œã€Šå…±å­˜ã€‹ã‚³ã‚½ã‚³ã‚½ç”Ÿãã‚ã£ã¦ã€æ§‹å›³ã¨å‹•ãã®è¡¨ç¾ã«å‹¢ã„ãŒã‚ã‚‹ã€‚è©±ã®å†…å®¹ã¯è£½ä½œå›½ã®æœ€è¿‘ã®ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ã¡ã‚‡ã£ã¨è¤‡é›‘ã€‚',\n\t 'ã‚½ãƒ•ãƒˆåŒ–æœªå®šã£ã¦ã©ã†ã„ã†ã“ã¨ã‚„ã‚¢ãƒ‹ãƒ—ãƒ¬ãƒƒã‚¯ã‚¹ãªã‚“ã¨ã‹ã—ã¦ãã‚Œã‚„',\n\t 'ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã™ã”ãè¿«åŠ›ãŒã‚ã‚Šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‚å¯æ„›ã‚‰ã—ãå¤§å¤‰æ¥½ã—ã‚ãŸãŒblmé‹å‹•ã‚„é¦™æ¸¯ã®ãƒ‡ãƒ¢ã®ã“ã¨ãªã©ãŒé ­ã«ã‚ˆãã‚Šãƒã‚¤ãƒãƒªãƒ†ã‚£ã®éæ¿€æ´¾ã¨ç©å¥æ´¾ã®å¯¾ç«‹ã¨ã„ã†ç‰©èªã¯ã‚‚ã†å¤ã„ã¨ã„ã†ã‹ãƒã‚¸ãƒ§ãƒªãƒ†ã‚£ã«ã‚ˆã‚‹ã‚¹ãƒ†ãƒ¬ã‚ªã‚¿ã‚¤ãƒ—ã®å†ç”Ÿç”£ã˜ã‚ƒç„¡ã„ã‹ã¨æ€ã£ã¦ã—ã¾ã£ãŸ',\n\t 'ã²ãŸã™ã‚‰ã‹ã‚ã„ã„ã€ã—ã‹ã‚‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæ¥½ã—ã„å­—å¹•ã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã€å¤§ãã•ã€è‰²ãŒã„ã¤ã‚‚ã®æ˜ ç”»ã®ãã‚Œã¨ã¯é•ã£ã¦ã¦è¿½ãˆãªã„ç®‡æ‰€ãŒå¤šã‹ã£ãŸ',\n\t 'æ£®ã«ãªã‚‹æ£®ã«ãªã‚‹ã—ã‹ãªã‹ã£ãŸæ£®ã«ãªã‚‹ã—ã‹ãªã‹ã£ãŸäººã¯ã©ã†ã™ã‚Œã°ã„ã„ã®ã‹',\n\t 'ã¨ã«ã‹ãã‚·ãƒ£ã‚ªãƒ˜ã‚¤ãŒã‹ã‚ã„ã„è©±ãŒé€²ã‚€ã«ã¤ã‚Œã¦å¤‰åŒ–ã™ã‚‹ãƒ ã‚²ãƒ³ã¨ã®é–¢ä¿‚ã‚‚è¦‹ã¦ã„ã¦æ¥½ã—ã‹ã£ãŸ']\n<font size=3>\n\n>ã†ã‚“ã€ã¡ã‚‡ã£ã¨ã¾ãšã„ã§ã™ã­ãƒ»ãƒ»ãƒ»\n>'ã€‡ã€‡è‰¯ã‹ã£ãŸã§ã™ãŒã€ã€‡ã€‡ã¯ãƒ€ãƒ¡ã§ã™ã­'ã¨ã„ã†ã‚ˆã†ãªã‚³ãƒ¡ãƒ³ãƒˆã¯ã¡ã‚‰ã»ã‚‰è¦‹ã‚‰ã‚Œã¾ã™ã­\n>ã™ã”ã„äººã‹ã‚‰ã€ä¸­ç›¤ã‚¹ã‚³ã‚¢ã‚’é™¤ãã¨ã€æ‚ªã„è©•ä¾¡ã¨è‰¯ã„è©•ä¾¡ã®å·®ãŒä»˜ã‘ã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã¨ã„ã†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’é ‚ãã¾ã—ãŸãŸã‚ã€å®Ÿæ–½ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\n</font>\n\n\tresults_new = []\n\tfor i in score_results:\n    if i.columns.size != 2:\n        text_new = ''.join(list(i['å˜èª']))\n        score_new = i[abs(i['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'])>0.5]['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'].sum() #æ¥µæ€§ã‚¹ã‚³ã‚¢ã®çµ¶å¯¾å€¤ã¯0.5ä»¥ä¸Šã—ã‹åŠ ç®—ã—ãªã„ã¨æŒ‡å®š\n        score_r_new = score_new/i['æ¨™æº–åŒ–ã‚¹ã‚³ã‚¢_new'].astype(float).count()\n        result_new = [text_new,score_new,score_r_new]\n        results_new.append(result_new)\n    else:\n        results_new.append(i)\n\n    #ä¸Šä½10ä½ã¨ä¸‹ä½10ä½\n<div style=\"width:100%;margin:auto\">{% asset_img score_result_4.png score_result_4%}</div>\n<div style=\"width:100 %;margin:auto\">{% asset_img score_result_5.png score_result_5%}</div>\n\n<font size=3>\n\n>è‹¥å¹²æ”¹å–„?ã§ã‚‚ã‚„ã¯ã‚Šä¸€éƒ¨è‰¯ã„è©•ä¾¡ãªã®ã«ä¸‹ä½ã«æ¥ã¦ã—ã¾ã£ãŸæ–‡æ›¸ãŒã‚ã‚Šã¾ã™ã­\n>ã¾ãŸãã‚‚ãã‚‚å„å˜èªã®ã‚¹ã‚³ã‚¢ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€ã‚·ãƒ£ã‚ªãƒ˜ã‚¤ã‚„ãƒ ã‚²ãƒ³ã¨ã„ã†ã‚­ãƒ£ãƒ©ã‚¯ã‚¿åã®ã‚¹ã‚³ã‚¢ã‚‚ãƒã‚¤ãƒŠã‚¹ã«ãªã£ã¦ã„ã¦ã€æ›´ã«ã€Œè©±ã€ã‚„ã€ŒãŒã€ã€ã€Œã¤ã‚Œã€ã€ã€Œã®ã€ç­‰ã‚‚ç„¡é§„ã«ãƒã‚¤ãƒŠã‚¹ã«ãªã£ã¦ã„ã¾ã™ã­ã€‚ã‚„ã¯ã‚Šä»Šå›ç”Ÿæˆã—ãŸè¾æ›¸ãã®ã‚‚ã®ãŒæ€ªã—ã„ã§ã™ã­ã€‚ã€‚\n\n</font>\n<div style=\"width:100 %;margin:auto\">{% asset_img score_result_6.png score_result_6%}</div>\n\n<font size=3>\n\n>ãã‚Œã«å¿œã˜ã¦å¾—ãŸã‚¹ã‚³ã‚¢ã‚‚æ€ªã—ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ãŒã€ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚\n\n</font>\n\n\tdata = ddf_score_new[ddf_score_new['ã‚¹ã‚³ã‚¢']!='-']['ç´¯è¨ˆæ¨™æº–åŒ–ã‚¹ã‚³ã‚¢'].to_list()\n\tfig = plt.figure(figsize=(12,8))\n\tplt.hist(data,bins=40, density=True,stacked=True, facecolor=\"blue\", edgecolor=\"black\", alpha=0.7)\n\tplt.show()\n<div style=\"width:70%;margin:auto\">{% asset_img score_plot.png score_plot%}</div>\n\n\tscore_new = [round((3+i/0.5),1) for i in ddf_score_new['ç´¯è¨ˆæ¨™æº–åŒ–ã‚¹ã‚³ã‚¢']]\n\tddf_score_new['score_test'] = score_new\n<div style=\"width:100%;margin:auto\">{% asset_img score_test.png score_test%}</div>\n\n#### C.ã¾ã¨ã‚\n<font size=3>\n\n>æ¥µæ€§è¾æ›¸ã‚’ä½¿ã£ã¦ã€å®¹æ˜“ã«ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã‚¹ã‚³ã‚¢ã‚’ã¤ã‘ã‚‰ã‚Œã‚‹ã“ã¨ãŒä½¿ã„ã‚„ã™ã„ã§ã™ã­\n>ã—ã‹ã—ã€ç”Ÿæˆã—ãŸè¾æ›¸ã®æ­£ç¢ºæ€§ã‚’ã©ã®ã‚ˆã†ã«ä¿è¨¼ã—ã¦ã„ãã®ã‹ã€ä»Šå¾Œã®èª²é¡Œã¨ã—ã¦æ¢æ±‚ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚\n>ä¸­ç›¤ã®ã‚¹ã‚³ã‚¢ã‚’ç„¡è¦–ã—ã€ä¸¡ç«¯å´(ä»Šå›ã¯çµ¶å¯¾å€¤0.5ä»¥ä¸Šã®ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—)ã‚¹ã‚³ã‚¢ã®åŠ ç®—ã¯æœ‰åŠ¹ãªæ‰‹æ®µã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚\n\n</font>\n\n### 5.æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹æ„Ÿæƒ…åˆ†æ_LSTM(ä»Šå¾Œãƒ‡ãƒ¼ã‚¿é‡ã‚’å¢—åŠ ã™ã‚‹äºˆå®š)\n#### A.ãƒ©ãƒ™ãƒ«ä»˜ã‘\n<font size=3>\n\n>ã¾ãšãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¹ã‚³ã‚¢ã«ã‚ˆã‚‹ãƒã‚¸ãƒ•ãƒ©ã‚°ã¨ãƒã‚¬ãƒ•ãƒ©ã‚°ã‚’ä»˜ã‘ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ãŒã€ä»Šå›ã‚¹ã‚³ã‚¢2ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã¯ã‚ãšã‹7ä»¶ã—ã‹ãªã„ãŸã‚ã€ã‚¹ã‚³ã‚¢3.5ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã®ã†ã¡ã€ãƒã‚¬æƒ…å ±å…¥ã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚¬ãƒ•ãƒ©ã‚°ã¤ã‘ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚(ã“ã“ã¯ã‚ãã¾ã§äººå·¥çŸ¥èƒ½ã®äººå·¥ã®éƒ¨åˆ†ã§ã™ã€‚)\n\n</font>\n\n\t#ä»Šå›ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿\n\tdf.loc[df['label'] == '-','sentiment'] = 3\n\t#ãƒã‚¬ãƒ•ãƒ©ã‚°ãƒ‡ãƒ¼ã‚¿\n\tdf.loc[df['label'] == '0','sentiment'] =0\n\t#ãƒã‚¸ãƒ•ãƒ©ã‚°ãƒ‡ãƒ¼ã‚¿\n\tdf.loc[(df['label'] == '1'),'sentiment'] =1\n\t#ãƒã‚¬ã§ã¯ãªãã€ãƒã‚¸ã§ã‚‚ãªã„ãƒ‡ãƒ¼ã‚¿\n\tdf.loc[df['label'] == '2','sentiment'] =2\n\tprint(len(df[df.sentiment == 1]),len(df[df.sentiment == 0]),len(df[df.sentiment == 2]),len(df[df.sentiment == 3]))\n\t#2302 180 587 305\n<div style=\"width:100%;margin:auto\">{% asset_img sentiment_plot_1.png sentiment_plot_1%}</div>\n\n#### B.ãƒ™ã‚¯ãƒˆãƒ«åŒ–\n<font size=3>\n\n>å‰å‡¦ç†ã¨åˆ†ã‹ã¡æ›¸ãã‚’è¡Œã„ã¾ã—ãŸã‚‰ã€gensimã®word2vecãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã®ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã‚’è¡Œã„ã¾ã—ãŸ\n\n</font>\n\t\n\timport gensim\n\tmodel = gensim.models.KeyedVectors.load_word2vec_format('model_neologd.vec', binary=False)\n\t#Wikiãƒ¢ãƒ‡ãƒ«å†…æ ¼ç´ã—ã¦ã„ã‚‹å„å˜èª\n\tvocab_list = list(model.wv.vocab.keys())\n\t#Wikiãƒ¢ãƒ‡ãƒ«å†…æ ¼ç´ã—ã¦ã„ã‚‹å„å˜èªã®ãƒ™ã‚¯ãƒˆãƒ«\n\tword_vectors = model.wv.syn0\n\t#Wikiãƒ¢ãƒ‡ãƒ«å†…æ ¼ç´ã—ã¦ã„ã‚‹å„å˜èªåŠã³å˜èªã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æƒ…å ±\n\tword_index = {word: index for index, word in enumerate(vocab_list)}\n\n\tlen_list =[len(i.split()) for i in df['texts_wakati']]\n\tprint('ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä»¶',len(len_list),'ä»¶ã§ã™')\n\tprint('å˜èªå…¨éƒ¨',sum(len_list),'å€‹ã§ã™')\n\tprint('å˜èªæ•°ã®æœ€å¤§å€¤ã¯',max(len_list),'ã§ã™')\n\t#ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä»¶ 3374 ä»¶ã§ã™\n\t#å˜èªå…¨éƒ¨ 206770 å€‹ã§ã™\n\t#å˜èªæ•°ã®æœ€å¤§å€¤ã¯ 2087 ã§ã™\n\n\timport random\n\tpos_data = df[df['sentiment'] == 1]\n\tneg_data = df[df['sentiment'] == 0]\n\t#ãƒã‚¸ãƒ»ãƒã‚¬ãƒ‡ãƒ¼ã‚¿ã‚’17:1ã§åˆ†å‰²ã™ã‚‹\n\tpos_index_train = random.sample(list(pos_data.index),2174)\n\tneg_index_train = random.sample(list(neg_data.index),170)\n\t#ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—\n\tpos_index_validation = [x for x in pos_data.index if x not in pos_index_train]\n\tneg_index_validation = [x for x in neg_data.index if x not in neg_index_train]\n\t#ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç­‰ã‚’å–å¾—\n\tpos_sentence_train = pos_data.loc[pos_index_train]\n\tneg_sentence_train = neg_data.loc[neg_index_train]\n\tpos_sentence_validation = pos_data.loc[pos_index_validation]\n\tneg_sentence_validation = neg_data.loc[neg_index_validation]\n\n\t#trainãƒ‡ãƒ¼ã‚¿ã¨validãƒ‡ãƒ¼ã‚¿ã‚’çµåˆã™ã‚‹\n\tdf_train = pd.concat([pos_sentence_train,neg_sentence_train],axis =0)\n\tdf_validation = pd.concat([pos_sentence_validation,neg_sentence_validation],axis =0)\n\tdf_all = pd.concat([df_train,df_validation],axis = 0)\n\tprint(len(df_train),len(df_validation),len(df_all))\n\t#2344 138 2482\n\tX_all = df_all.texts_wakati.tolist()\n\tX_train = df_train.texts_wakati.tolist()\n\tX_validation = df_validation.texts_wakati.tolist()\n\ty_train = df_train['sentiment'].values.astype('int8')\n\n\tfrom keras.preprocessing.text import Tokenizer\n\tfrom keras.preprocessing.sequence import pad_sequences\n\t#ã¾ãšTokenizerã‚’ä½¿ã£ã¦ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸ\n\ttokenizer = Tokenizer(\n\t    nb_words = 2000,\n\t    filters='!\"#$%&()*+,-./:;<=>?@[\\\\]^_`{|}~\\t\\n',\n\t    lower=True,\n\t    split=' ')\n\ttokenizer.fit_on_texts(X_all)\n\tX = tokenizer.texts_to_sequences(X_all)\n\tX = pad_sequences(X)\n\tX.shape\n\t#(2482,1715)\n\n#### C.LSTMãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦å®Ÿæ–½\n\tembed_dim = 128\n\tlstm_out = 256\n\tbatch_size = 32\n\n\tfrom keras.models import Sequential\n\tfrom keras.layers import Embedding\n\tfrom tensorflow.keras.layers import Dropout, Dense, LSTM,Flatten\n\tmodel_1 =  Sequential()\n\tmodel_1.add(Embedding(2000,embed_dim,input_length = X.shape[1]))\n\tmodel_1.add(LSTM(lstm_out,dropout=0.2,return_sequences=True))\n\tmodel_1.add(Flatten())\n\tmodel_1.add(Dense(2,activation='softmax'))\n\tmodel_1.compile(loss = 'categorical_crossentropy', optimizer='adam',metrics = ['accuracy'])\n\tprint(model_1.summary())\n<div style=\"width:100%;margin:auto\">{% asset_img LSTM.png LSTM%}</div>\n\n\tfrom sklearn.model_selection import train_test_split\n\tfrom sklearn.metrics import roc_auc_score\n\tfrom keras.callbacks import Callback\n\n\tx_train5,y_train5,x_label5,y_label5 = train_test_split(X_train,y_binary, train_size=0.8, random_state=234)\n\n\thistory =  model_1.fit(x_train5,x_label5,batch_size=batch_size,epochs= 2,validation_data=(y_train5, y_label5),verbose=2)\n<div style=\"width:100%;margin:auto\">{% asset_img LSTM_2.png LSTM_2%}</div>\n\n\ty_lstm = model_1.predict(X_validation,batch_size=batch_size)\n\tdf_validation['score_new'] = [round((i/0.2),1) for i in y_lstm[:,1].tolist()]\n\n\t#å‡ºãŸçµæœã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è©•ä¾¡ã¨æ¯”è¼ƒã—ã¦ã¿ã‚‹ã¨\n\txaxis = df_validation['user'].tolist()\n\tyaxis1 = df_validation['score'].astype(float).tolist()\n\tyaxis2 = df_validation['score_new'].astype(float).tolist()\n\tplt.figure(figsize = (12,8))\n\tplt.title('Result Analysis')\n\tplt.plot(yaxis1,color='red',linewidth=2.0,linestyle='--',label = 'user')\n\tplt.plot(yaxis2,color='green',linewidth=2.0,linestyle='solid',label = 'LSTM')\n\tplt.legend()\n\tplt.show()\n<div style=\"width:100%;margin:auto\">{% asset_img LSTM_1.png LSTM_1%}</div>\n\n#### ã¾ã¨ã‚\n>epochs5å›ã¨30å›ã‚‚å®Ÿè¡Œã—ã¦ã¿ã¾ã—ãŸãŒã€ã©ã†ã‚„ã‚‰ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®accuracyãŒã²ãŸã™ã‚‰ã‚ˆããªã£ã¦ã€val_accuracyã¯ç¶­æŒã™ã‚‹çµæœã—ã‹ãªã‚‰ãªã„ã§ã™ã­ã€‚\n>ãã‚‚ãã‚‚3000ä»¶ã—ã‹ãªã„ãƒ‡ãƒ¼ã‚¿ã ã¨ãƒ‡ã‚£ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã§éå­¦ç¿’ã—ã‚„ã™ã„ã¨å¾Œã»ã©çŸ¥äººã«ã‹ã‚‰ã‹ã‚ã‚Œã¾ã—ãŸãƒ»ãƒ»ãƒ»\n>ã¨ã‚Šã‚ãˆãšãƒ‡ãƒ¼ã‚¿ã‚’å¢—åŠ ã—ã¦ã‹ã‚‰å†åº¦ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼ï¼ï¼\n\n### 6.æ®‹ã‚Šèª²é¡Œ\n>æ¥µæ€§è¾æ›¸ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°\n>LSTMã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°\n>çµµæ–‡å­—ã¨ã„ã£ãŸæ„Ÿæƒ…è¡¨ç¾ã‚’å«ã‚ã¦è€ƒæ…®ã—ãŸã‚‰ï¼Ÿ\n>ç•°å¸¸æ¤œçŸ¥\n>äººç‰©ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†æ\n\n### å‚è€ƒæ–‡çŒ®\n[1.selenium Web element](https://www.selenium.dev/documentation/en/webdriver/web_element/)\n[2.pythonã§çµµæ–‡å­—ã‚’é§†é€ã™ã‚‹](https://qiita.com/yoshimo123/items/85331d881aed9ad41020)\n[3.æ„Ÿæƒ…åˆ†æã«ç”¨ã„ã‚‹æ¥µæ€§è¾æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹](https://qiita.com/g-k/items/1b7c765fa6520297ca7c)\n[4.æ„Ÿæƒ…åˆ†æã§ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã®ãƒã‚¬ãƒã‚¸åº¦åˆã„ã‚’ã‚¹ã‚³ã‚¢åŒ–ã™ã‚‹](https://qiita.com/g-k/items/e49f68d7e2fed6e300ea)\n[5.Pythonå®ç°è¾“å…¥ç”µå½±åå­—è‡ªåŠ¨ç”Ÿæˆè±†ç“£è¯„è®ºè¯äº‘å›¾ï¼ˆå¸¦GUIç•Œé¢ï¼‰å°ç¨‹åº](https://blog.csdn.net/q_u_a_r_t_e_r/article/details/111286094)\n[6.fastTextã®å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’å…¬é–‹ã—ã¾ã—ãŸ](https://qiita.com/Hironsan/items/513b9f93752ecee9e670)","tags":["è‡ªç„¶è¨€èªå‡¦ç†","ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°","æ„Ÿæƒ…åˆ†æ","LSTM","GUI"],"categories":["è‡ªç„¶è¨€èªå‡¦ç†"]},{"title":"04_bilibiliä¸‰å›½å¿—_ä¸­å›½ãƒ•ã‚¡ãƒ³ã®è‡ªä½œå‹•ç”»ã®å¼¾å¹•ã‚’å–å¾—ã—ã¦ã¿ãŸ","url":"/Jorey-s-Blog/2021/01/05/04_bilibili/","content":"\n\n<iframe width=\"560\" height=\"315\" src=\"//player.bilibili.com/player.html?aid=50865908&bvid=BV12441147tV&cid=89046676&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n\nå¼¾å¹•ã‚’é–‰ã˜ã‚‹æ–¹æ³•ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®ã‚ˆã†ãªãƒœãƒ€ãƒ³ã‚’æŠ¼ã›ã°å¼¾å¹•ã‚’é–‰ã˜ã‚Œã¾ã™ã€‚\n<div style=\"width:70%;margin:auto\">{% asset_img danmaku_close.jpg danmaku_close%}</div>\n\næœ€è¿‘æ–°è§£é‡ˆãƒ»ä¸‰å›½å¿—ä¸Šæ˜ ã•ã‚ŒãŸã®ã§ã€ä¸Šæ˜ åˆæ—¥è¦³ã«è¡Œãã¾ã—ãŸï¼\nç¦ç”°ç›£ç£ã®ä½œå“ãªã®ã§ã€ä¸‰å›½æ™‚ä»£ã®è©±ã‚’é¢ç™½ãèªã£ã¦ã„ã¦ã€ã¤ã‹ã¿åˆã„ã®ã‚·ãƒ¼ãƒ³ã¯å€‹äººçš„ã«ã¨ã¦ã‚‚è‰¯ã‹ã£ãŸã¨æ€ã„ã¾ã—ãŸã€‚ã¾ãŸã€åŸç”°å„ªã•ã‚“ãŒæ¼”ã˜ãŸå‘‚å¸ƒã¯ã‚¤ãƒ¡ãƒ¼ã‚¸é€šã‚Šã§ã—ãŸãŒã€å²©ç”°ã•ã‚“ãŒæ¼”ã˜ãŸè¶™é›²å­é¾ã®ã‚­ãƒ£ãƒ©ã¯ã¡ã‚‡ã£ã¨å¾…ã£ã¦ã£ã¦æ„Ÿã˜ã§ã—ãŸã€‚ç¬‘\n\nåŒæ™‚æœŸã«ä¸­å›½ã®bilibiliå‹•ç”»ã‚µã‚¤ãƒˆï¼ˆãƒ‹ã‚³ãƒ‹ã‚³ã®ä¸­å›½ç‰ˆã‚µã‚¤ãƒˆï¼‰ã§ä¸­å›½ã®ãƒ•ã‚¡ãƒ³ãŒä¸‰å›½ã‚’ãƒ†ãƒ¼ãƒã«ã€è¤‡æ•°ã®ãƒ‰ãƒ©ãƒã€æ˜ ç”»ã‹ã‚‰ç´ æã‚’é›†ã¾ã£ã¦è‡ªä½œã—ãŸå‹•ç”»ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚77ä¸‡å›ã‚‚è¦–è´ã•ã‚Œã€å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã¯2000æœ¬ã»ã©ã‚ã‚Šã¾ã—ãŸã€‚ã¨ã¦ã‚‚æ°—ã«å…¥ã£ãŸå‹•ç”»ãªã®ã§ã€å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ã¿ã¾ã—ãŸã€‚\n<!-- more -->\n---------------\n<!-- toc -->\n---------------\n### 1.å‹•ç”»ã®CIDã‚’å–å¾—ã™ã‚‹\n{% asset_img cidå–å¾—.png cidå–å¾— %}\n\n**cid = 89046676**\n\n### 2.å‹•ç”»å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã®xmlã«ã‚¢ã‚¯ã‚»ã‚¹\n\n\tâ… .https://comment.bilibili.com/ + {cid}.xml\n\thttps://comment.bilibili.com/89046676.xmlã€€ã€€\n\t\tâ†’1000ä»¶ã‚³ãƒ¡ãƒ³ãƒˆã—ã‹å–å¾—ã§ããªã„\n\t\tâ†’å ´åˆã«ã‚ˆã£ã¦8000ä»¶ã€500ä»¶ã ã£ãŸã‚‹ã™ã¦å–å¾—å¯èƒ½ãªä»¶æ•°ãŒä¸å®‰å®šã‚‰ã—ã„ã§ã™ã€‚\n\n\tâ…¡.å…¨ä»¶å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ã«ã¯ã€\n\thttps://api.bilibili.com/x/v2/dm/history?type=1&oid={cid}&date={date}ã€€\n\t\tâ†’æœ¬å‹•ç”»ã¯2019-04-29ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã®ã§ã€date = 2019-04-29 ~ 2021-01-05ã®å¼¾å¹•ã‚’å–å¾—ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚\n\n### 3.æœ€æ–°ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ã¿ã‚ˆã†\n\n{% asset_img 1_xml.png 1_xml %}\n\n\trequestãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦å–å¾—ã—ã¦ã¿ãŸ\n\n\timport requests\n    from bs4 import BeautifulSoup\n\n    url = 'https://comment.bilibili.com/89046676.xml'\n    request = requests.get(url)\n    request.text\n{% asset_img 1_encoding.png 1_encoding %}\n\n\t#ä¸€åº¦æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹\n\trequest.encoding='utf-8-sig'\n{% asset_img 1_encoded.png 1_encoded %}\n\n\t#å–å¾—ã—ã¦ããŸãƒ†ã‚­ã‚¹ãƒˆæ–‡æ›¸ã‚’BeautifulSoupã§åˆ†æã™ã‚‹\n\tsoup = BeautifulSoup(request.text,'lxml')\n\n\t#ãƒ†ã‚­ã‚¹ãƒˆæ–‡æ›¸ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ã¨ã€å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã¯ã™ã¹ã¦ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æ ¼ç´ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸ\n\t#<d p=\"18.29700,1,25,16777215,1609775751,0,8d1aab76,43323792511467527\">ãƒ†ã‚­ã‚¹ãƒˆ</d>\n\n\t#ã—ãŸãŒã£ã¦ã€<d>ã‚’æŠ½å‡ºã™ã‚‹\n\tresults = soup.find_all('d')\n{% asset_img då–å¾—.png då–å¾— %}\n\n\t#ã‚³ãƒ¡ãƒ³ãƒˆéƒ¨åˆ†ã ã‘ã‚’å–å¾—\n\tcomments = [comment.text for comment in results]\n{% asset_img comment.png comment %}\n\n\tlen(comments)\n\tï¼ƒ1000\n\tï¼ƒã“ã®ã‚„ã‚Šæ–¹ã§1000ä»¶ã‚³ãƒ¡ãƒ³ãƒˆã—ã‹å–å¾—ã§ããªã„ã€‚\n\n### 4.å¤ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ã¿ã‚ˆã†\n\n\t#bilibiliã®å¤ã„å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã¯1æ—¥åˆ†ã”ã¨ã«xmlã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ä¸Šè¨˜ãƒªãƒ³ã‚¯ã§æ—¥ä»˜ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€è©²å½“æ—¥ã®å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã§ãã‚‹ã€‚\n\tã€€ã—ã‹ã—ã€ã“ã¡ã‚‰ã®xmlãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚\n\tã€€æœ¬è¨˜äº‹ã¯seleniumã‚’ä½¿ã£ã¦ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¡Œã„ãŸã„ã¨æ€ã†\n\n\tfrom bs4 import BeautifulSoup as bs\n\timport pandas as pd\n\tfrom selenium import webdriver\n\timport time, datetime\n\n\turl_login = 'https://passport.bilibili.com/login'\n\tdriver = webdriver.Chrome()\n\tdriver.get(url_login)\n\t#ã“ã“ã§ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å…¥åŠ›â†“â†“â†“\n{% asset_img login.png login %}\n\n\tcid = 89046676\n\tbegin = '2019-04-29'\n\tend = '2021-01-05'\n\tfmt = '%Y-%m-%d'\n\n\tï¼ƒã‚ã‚‹æœŸé–“ä¸­ã®æ—¥ä»˜ã‚’ä¸€æ—¥å˜ä½ã§å–å¾—ã™ã‚‹\n\tdef day_range(bgn,end):\n\t    fmt = '%Y-%m-%d'\n\t    begin=datetime.datetime.strptime(bgn,fmt)\n\t    end=datetime.datetime.strptime(end,fmt)\n\t    delta=datetime.timedelta(days=1)\n\t    interval=int((end-begin).days) +1\n\t   \n\t    return [begin+delta*i for i in range(0,interval,1)]\n\n\ttime_list = [m.strftime(fmt) for m in day_range(begin,end)]\n{% asset_img timelist.png timelist %}\n\n\t#å¯¾è±¡ã¨ãªã‚‹ã™ã¹ã¦ã®xmlã‚’ãƒªã‚¹ãƒˆã«æ ¼ç´\n\turls = ['https://api.bilibili.com/x/v2/dm/history?type=1&oid='+str(cid)+'&date='+str(i) for i in time_list]\n{% asset_img urls.png urls %}\n\t\n\thtmls = []\n\tfor i in urls:\n\t    driver.get(i)\n\t    time.sleep(3)\n\t    #get_attribute('innerHTML'):seleniumã§WebElementã‹ã‚‰htmlã‚’å–å¾—ã™ã‚‹\n\t    htmls.append(driver.find_element_by_tag_name('i').get_attribute('innerHTML'))\n\n\tsoups = [bs(h,'lxml') for h in htmls]\n\tresults = [soup.find_all('d') for soup in soups]\n{% asset_img results.png results %}\n\n\tresultss = sum(results,[])\n\tcomments = [comment.text for comment in resultss]\n{% asset_img comments.png comments %}\n\n\tlen(comments)\n\t#608931\n\n\t#é‡è¤‡å‰Šé™¤\n\tcommentss = list(set(comments))\n\tlen(commentss)\n\t#1625 \n\n### 5.æ®‹ã‚‹èª²é¡Œ\n>1_å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã ã‘ã§ã¯ãªãã€æ—¥ä»˜æƒ…å ±ã‚‚å–å¾—ã—ãŸã„\n>2_é•ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åŒã˜å¼¾å¹•ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‡ºã™ã“ã¨ãŒå¯èƒ½ãªã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—å¯èƒ½ã‹\n>3_çŸ­ã„æ–‡æ›¸ã®è§£æ\n>4_ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã—ãŸã„\n\n### å‚è€ƒæ–‡çŒ®\n\n[[Python][Bilibili]Bç«™å†å²å¼¹å¹•çˆ¬è™«](https://blog.csdn.net/sinat_18665801/article/details/104519838)","tags":["bilibili","è‡ªç„¶è¨€èªå‡¦ç†","nlp","ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°"],"categories":["è‡ªç„¶è¨€èªå‡¦ç†"]},{"title":"2021å¹´1æœˆSQLç·´ç¿’èª²é¡Œ","url":"/Jorey-s-Blog/2021/01/05/2021å¹´1æœˆSQLç·´ç¿’èª²é¡Œ/","content":"<!-- toc -->\n---------------\n\n### 1.2021å¹´1æœˆ12æ—¥\n\n<font size=3>ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€NAMEåˆ—å†…ç¨®é¡ã”ã¨ã®å’Œã¨å„ç¨®é¡ã®ç·æ•°ã®æ¯”ç‡ãŒ0.6ã‚ˆã‚Šå¤§ãã„IDã¨NAMEã‚’æŠ½å‡ºã›ã‚ˆã€‚</font>\n\n|ID|NAME|NUM|\n|-|-|-|\n|1|A|1|\n|2|A|2|\n|3|A|6|\n|4|A|4|\n|5|A|3|\n|6|B|2|\n|7|B|8|\n|8|B|2|\n<!-- more -->\n### 2.2021å¹´1æœˆ13æ—¥\n<font size=3>ãƒ†ãƒ¼ãƒ–ãƒ«T0113ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</font>\n\n|æ—¥ä»˜|ã‚³ãƒ¼ãƒ‰|é‡‘é¡|é‡‘é¡ç›¸é•å€¤|\n|-|-|-|-|\n|2020-07-01|A|2.00|.00|\n|2020-07-06|A|4.00|2.00|\n|2020-07-12|A|3.00|-1.00|\n|2020-07-13|A|4.00|1.00|\n|2020-07-13|B|2.00|.00|\n|2020-07-19|B|4.00|2.00|\n\n<font size=3>åŒã˜ã‚³ãƒ¼ãƒ‰ã§ã‚‚æ—¥ã«ã‚ˆã£ã¦ã€é‡‘é¡é•ã†ã®ã§ã€ãã®é€£ç¶šå¢—é•·ã®æ—¥æ•°ã¨é€£ç¶šæ¸›å°‘ã®æ—¥æ•°ã‚’çµ±è¨ˆã—ã€ä»¥ä¸‹ã®çµæœã‚’å‡ºã—ã¦ã¿ã‚ˆã†</font>\n\n|æ—¥ä»˜|ã‚³ãƒ¼ãƒ‰|é‡‘é¡|é‡‘é¡ç›¸é•å€¤|å¢—é•·æ–¹å‘|é€£ç¶šå¢—é•·æ—¥æ•°ï½œ\n|-|-|-|-|-|-|\n|2020-07-01|A|2.00|.00|æ­£|1|\n|2020-07-06|A|4.00|2.00|æ­£|2|\n|2020-07-12|A|3.00|-1.00|è² |1|\n|2020-07-13|A|4.00|1.00|æ­£|1|\n|2020-07-13|B|2.00|.00|æ­£|1|\n|2020-07-19|B|4.00|2.00|æ­£|2|\n\n### 3.2021å¹´1æœˆ16æ—¥\n<font size=3>T0116ã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã£ã¦ã€å•†å“ã”ã¨ã«æœ€æ–°æ—¥ã®æ—¥å¹³å‡å˜ä¾¡ã‚’æ±‚ã‚ã‚ˆã†</font>\n\n|å•†å“|æ—¥ä»˜|å˜ä¾¡|å€‹æ•°|\n|-|-|-|-|\n|ãƒ‡ã‚¹ã‚¯|2016-01-01|5000|1|\n|ã‚¤ã‚¹|2016-01-01|3000|4|\n|ãƒ‡ã‚¹ã‚¯|2016-01-02|5000|2|\n|ãƒ‡ã‚¹ã‚¯|2016-01-01|5000|3|\n|ã‚¤ã‚¹|2016-01-02|3000|2|\n|ãƒ‡ã‚¹ã‚¯|2016-01-02|4800|1|\n\n### 4.2021å¹´1æœˆ17æ—¥\n<font size=3>T0117ã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã£ã¦ã€å¸Œæœ›ã®å½¢(å³)ã«æ•´ãŠã†</font>\n\n<table>\n<tr><th>T0117</th><th>é›†è¨ˆå¾Œ</th></tr>\n<tr><td>\n\n|X|L|\n|-|-|\n|1|A|\n|2|A| ã€€ã€€\n|3|A|\n|4|A|\n|5|B|\n|6|B|\n|7|B|\n|8|A|\n|9|A|\n\n</td><td>\n\n|L|R|\n|-|-|\n|A|1-4|\n|A|8-9|\n|B|5-7|\n\n</td></tr> </table>\n\n### 5.2021å¹´1æœˆ21æ—¥\n<font size=3>T0121ã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã£ã¦ã€Amountã¯ä¸€äººã²ã¨ã‚ŠãŒåŒã˜æœˆã«é•ã†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã—ãŸã®é‡‘é¡ç·å’Œã§ã‚ã‚‹ã€‚ãã®ç·å’Œã‚’è©²å½“æœˆã®å¹³å‡é‡‘é¡ã«æ›ç®—ã—ã‚ˆã†</font>\n\n|ID|NAME|MON|STATE|AMOUNT|\n|-|-|-|-|-|\n|1|Aã•ã‚“|201901|A|9000|\n|2|Aã•ã‚“|201901|B|9000|\n|3|Aã•ã‚“|201901|E|9000|\n|4|Bã•ã‚“|201902|A|1800|\n|5|Bã•ã‚“|201902|C|1800|\n|6|Cã•ã‚“|201902|C|30000|\n|7|Cã•ã‚“|201902|F|30000|\n\n<font size=3>å¸Œæœ›:</font>\n\n|ID|NAME|MON|STATE|AMOUNT|\n|-|-|-|-|-|\n|1|Aã•ã‚“|201901|A|3000|\n|2|Aã•ã‚“|201901|B|3000|\n|3|Aã•ã‚“|201901|E|3000|\n|4|Bã•ã‚“|201902|A|900|\n|5|Bã•ã‚“|201902|C|900|\n|6|Cã•ã‚“|201902|C|15000|\n|7|Cã•ã‚“|201902|F|15000|\n|8|Aã•ã‚“|201902|D|2000|\n\n### 6.2021å¹´1æœˆ25æ—¥\n<font size=3>T0125ã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚</font>\n\n|TransType|OprSeq|OpCode|TransTime|\n|-|-|-|-|\n|é–‹å§‹|10|NF21|2019-11-30 14:06|\n|ã‚·ãƒ•ãƒˆ|10|NF21|2019-11-30 14:09|\n|é–‹å§‹|10|NF21|2019-11-30 14:10|\n|çµæŸ|10|NF21|2019-11-30 14:13|\n|é–‹å§‹|20|NF22|2019-11-30 14:15|\n|çµæŸ|20|NF22|2019-11-30 14:16|\n|é–‹å§‹|30|NF24|2019-11-30 14:17|\n|çµæŸ|30|NF24|2019-11-30 14:20|\n\n<font size=3>ä»¥ä¸‹ã®ã‚ˆã†ã«æ•´ç†ã—ã¾ã—ã‚‡ã†</font>\n\n|TransType|OprSeq|OpCode|StartTime|EndTime|\n|-|-|-|-|-|\n|é–‹å§‹-ã‚·ãƒ•ãƒˆ|10|NF21|2019-11-30 14:06|2019-11-30 14:09|\n|é–‹å§‹ãƒ¼çµæŸ|10|NF21|2019-11-30 14:10|2019-11-30 14:13|\n|é–‹å§‹ãƒ¼çµæŸ|20|NF22|2019-11-30 14:15|2019-11-30 14:16|\n|é–‹å§‹ãƒ¼çµæŸ|30|NF24|2019-11-30 14:17|2019-11-30 14:20|\n\n### 7.2021å¹´1æœˆ26æ—¥\n<font size=3>T0126Aã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚è–¬Aã¨Bã®é…ã‚ŠçŠ¶æ³ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚T0126Bã¯è–¬Aã¨Bã®è³¼è²·è¨˜éŒ²ã§ã™ã€‚</font>\n\n<table>\n<tr><th>T0126A</th><th>T0126B</th></tr>\n<tr><td>\n\n|id|spmc|åˆ†é…é‡|\n|-|-|-|\n|1|A|80.0000|\n|2|B|100.0000|\n\n</td><td>\n\n|id|spmc|è³¼å…¥é‡|\n|-|-|-|\n|1|A|20.0000|\n|2|A|50.0000|\n|3|A|40.0000|\n|4|A|30.0000|\n|5|B|120.0000|\n|6|B|80.0000|\n|7|B|100.0000|\n\n</td></tr> </table>\n<font size=3>ä¸Šè¨˜2ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã‚’ã¾ã¨ã‚ã¦ã€ä¸‹è¨˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‡ºã—ã¾ã—ã‚‡ã†ã€‚</font>\n\n|spmc|è³¼å…¥é‡|ä»Šå›ä½¿ç”¨é‡|åœ¨åº«é‡|\n|-|-|-|-|\n|A|20.0000|20.0000|.0000|\n|A|50.0000|50.0000|.0000|\n|A|40.0000|10.0000|30.0000|\n|A|30.0000|.0000|30.0000|\n|B|120.0000|100.0000|20.0000|\n|B|80.0000|.0000|80.0000|\n|B|100.0000|.0000|100.0000|\n\n\n\n","tags":["sql"],"categories":["sql"]},{"title":"01_1_index.js","url":"/Jorey-s-Blog/2021/01/04/01_1_index/","content":"\n----------\n\t'use strict';\n\tvar cheerio = require('cheerio');\n\n\t// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string\n\tfunction getPosition(str, m, i) {\n\t  return str.split(m, i).join(m).length;\n\t}\n<!-- more -->\n\tvar version = String(hexo.version).split('.');\n\thexo.extend.filter.register('after_post_render', function(data){\n\t  var config = hexo.config;\n\t  if(config.post_asset_folder){\n\t    \tvar link = data.permalink;\n\t\tif(version.length > 0 && Number(version[0]) == 3)\n\t\t   var beginPos = getPosition(link, '/', 1) + 1;\n\t\telse\n\t\t   var beginPos = getPosition(link, '/', 3) + 1;\n\t\t// In hexo 3.1.1, the permalink of \"about\" page is like \".../about/index.html\".\n\t\tvar endPos = link.lastIndexOf('/') + 1;\n\t    link = link.substring(beginPos, endPos);\n\n\n\t    var toprocess = ['excerpt', 'more', 'content'];\n\t    for(var i = 0; i < toprocess.length; i++){\n\t      var key = toprocess[i];\n\t \n\t      var $ = cheerio.load(data[key], {\n\t        ignoreWhitespace: false,\n\t        xmlMode: false,\n\t        lowerCaseTags: false,\n\t        decodeEntities: false\n\t      });\n\n\t      $('img').each(function(){\n\t\t\tif ($(this).attr('src')){\n\t\t\t\t// For windows style path, we replace '\\' to '/'.\n\t\t\t\tvar src = $(this).attr('src').replace('\\\\', '/');\n\t\t\t\tif(!/http[s]*.*|\\/\\/.*/.test(src) &&\n\t\t\t\t   !/^\\s*\\//.test(src)) {\n\t\t\t\t  // For \"about\" page, the first part of \"src\" can't be removed.\n\t\t\t\t  // In addition, to support multi-level local directory.\n\t\t\t\t  var linkArray = link.split('/').filter(function(elem){\n\t\t\t\t\treturn elem != '';\n\t\t\t\t  });\n\t\t\t\t  var srcArray = src.split('/').filter(function(elem){\n\t\t\t\t\treturn elem != '' && elem != '.';\n\t\t\t\t  });\n\t\t\t\t  if(srcArray.length > 1)\n\t\t\t\t\tsrcArray.shift();\n\t\t\t\t  src = srcArray.join('/');\n\t\t\t\t  $(this).attr('src', config.root + link + src);\n\t\t\t\t  console.info&&console.info(\"update link as:-->\"+config.root + link + src);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tconsole.info&&console.info(\"no src attr, skipped...\");\n\t\t\t\tconsole.info&&console.info($(this));\n\t\t\t}\n\t      });\n\t      data[key] = $.html();\n\t    }\n\t  }\n\t});\n\n","tags":["hexo-asset-image"],"categories":["ã‚µã‚¤ãƒˆæ§‹ç¯‰"]},{"title":"01_Hexoä¸Šã§ã‚µã‚¤ãƒˆã®æ§‹ç¯‰ã«ã¤ã„ã¦","url":"/Jorey-s-Blog/2021/01/03/01_Hexoä¸Šã§ã‚µã‚¤ãƒˆã®æ§‹ç¯‰ã«ã¤ã„ã¦/","content":"<!-- toc -->\n### ï¼‘.å†™çœŸã®æŒ¿å…¥ï¼š\n\nHexoã‚’githubã«æ­è¼‰ã™ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚„ã‚Šæ–¹ã§ã†ã¾ãã§ãã¾ã—ãŸ\n\n\t1.npm install https://github.com/CodeFalling/hexo-asset-image --save\n\t\t*ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\n\t2.ä»¥ä¸‹ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã€index.jsã«ä¿å­˜ã™ã‚‹\n\tã€€>node_modules>hexo-asset-image>index.jsã‚’äº¤æ›ã™ã‚‹\n\n[index.js](http://localhost:4000/Jorey-s-Blog/2021/01/04/index/)\n<!-- more -->\n\t3.hexoã®_config.ymlã«post_asset_folder: trueã«å¤‰æ›´ã™ã‚‹\\n\n\n{% asset_img post_asset_folder.png post_asset_folder %}\n\t\n\t4.cd hexo(Jorey-s-Blog)\n\t hexo new photo \n\t\t*æ–°ã—ã„photo.mdã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹\n\t\t*ãã—ã¦source/_posts ãƒ•ã‚¡ãƒ«ãƒ€ã«photoã¨ã„ã†ãƒ•ã‚¡ãƒ«ãƒ€ã‚‚ç”Ÿæˆã•ã‚Œã‚‹\n{% asset_img mdã¨ãƒ•ã‚©ãƒ«ãƒ€åŒæ™‚ç”Ÿæˆ.png mdã¨ãƒ•ã‚©ãƒ«ãƒ€åŒæ™‚ç”Ÿæˆ %}\n\n\t5.{% asset_img å†™çœŸã®åå‰.png æ³¨é‡ˆ(è¨˜å…¥ã—ãªãã¦ã‚‚ã„ã„) %}\n\t\t*githubã«æ­è¼‰ã™ã‚‹å ´åˆã€ã“ã®çµ¶å¯¾ãƒ‘ã‚¹ã®å¼•ç”¨ãŒåŠ¹ãã¾ã™\n\t\t*![]()ã®è¨˜å…¥æ–¹æ³•ã ã¨ã€![](githubä¸Šã®ãƒ‘ã‚¹)ã‚’è¨˜å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹\n\n\t6.hexo clean && hexo g -dã§æ›´æ–°ã™ã‚‹\n\n---\n### 2.Music Playerã®æŒ¿å…¥\n\nspotifyã®Playlistã‚’æŒ¿å…¥ã™ã‚‹\n\t\n\t1.npm install hexo-tag-spotify\n\n\t2.hexoã®_config.ymlã«ä»¥ä¸‹ã®å†…å®¹ã‚’è¿½åŠ \n\n\t\tplugins:\n\t\t - hexo-tag-spotify\n\t\tspotify:\n\t\t  size: 'large'\n\t\t  theme: 'light'\n\t\t  view: 'list'\n\n\t3.\n\tã‚·ãƒ³ã‚°ãƒ«ã‚½ãƒ³ã‚°ã®æŒ¿å…¥ï¼š\n\t{% spotify spotify:track:0ZoOOxoA8o0lY590ivyM %}\n\tã‚·ãƒ³ã‚°ãƒ«ã‚½ãƒ³ã‚°ã€ã‚¢ãƒ«ãƒãƒ ã€playlistã®æŒ¿å…¥ï¼š\n\t{% spotify https://play.spotify.com/user/12132493/playlist/1kBmZZ1rW2Mq2jQdS4QclQ %}\n{% spotify spotify:playlist:37i9dQZF1EphGUoLq3zryN%}\n\n---\n### 3.æ–‡ç« ã®å­—æ•°çµ±è¨ˆã¨æ–‡ç« ã‚’èª­ã‚€ã«ã¯ã‹ã‹ã‚‹æ™‚é–“ã‚’è¡¨ç¤ºã™ã‚‹\n[hexo-symbols-count-time](https://github.com/theme-next/hexo-symbols-count-time)\n- hexo-symbols-count-timeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n```\nnpm install hexo-symbols-count-time\n```\n- hexo_config.ymlã®ä¿®æ­£\n```\nsymbols_count_time:\n  symbols: true # è©²å½“æ–‡ç« ã®å­—æ•°çµ±è¨ˆé‡ã‚’è¡¨ç¤ºã™ã‚‹\n  time: true # è©²å½“æ–‡ç« ã‚’èª­ã‚€ã«ã¯ã‹ã‹ã‚‹æ™‚é–“ã‚’è¡¨ç¤ºã™ã‚‹\n  total_symbols: true # ã™ã¹ã¦ã®æ–‡ç« ã®å­—æ•°çµ±è¨ˆé‡ã‚’è¡¨ç¤ºã™ã‚‹\n  total_time: true # ã™ã¹ã¦æ–‡ç« ã‚’èª­ã‚€ã«ã¯ã‹ã‹ã‚‹æ™‚é–“ã‚’è¡¨ç¤ºã™ã‚‹\n```\n- next_config.ymlã®ä¿®æ­£\n```\nsymbols_count_time:\n  separated_meta: true  # æ”¹è¡Œã®è¡¨ç¤º\n  item_text_post: true  # æ–‡ç« å†…ã®è¡¨ç¤º\n  item_text_total: false # ãƒ–ãƒ­ã‚°ã®ãƒœãƒˆãƒ ã®è¡¨ç¤º\n```\n\n\n","tags":["hexo","æ§‹ç¯‰","ã‚¨ãƒ©ãƒ¼","html"],"categories":["ã‚µã‚¤ãƒˆæ§‹ç¯‰"]}]